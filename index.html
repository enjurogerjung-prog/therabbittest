<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0d0a07">
    <title>The Rabbit Test</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&family=Space+Mono:wght@400;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ═══════════════════════════════════════════════════════════
               THE RABBIT TEST — COLOR BIBLE (MINIMAL)
               ═══════════════════════════════════════════════════════════ */
            
            /* ─── BACKGROUNDS ─── */
            --bg-primary: #080808;
            --bg-secondary: #101010;
            --bg-elevated: #181818;
            --bg-card: #121212;
            
            /* ─── TEXT HIERARCHY ─── */
            --text-bright: #ffffff;
            --text-primary: #d0d0d0;
            --text-secondary: #909090;
            --text-dim: #606060;
            --text-ghost: #404040;
            
            /* ═══════════════════════════════════════════════════════════
               THE NEW COLOR SYSTEM — 5 STORY COLORS
               ═══════════════════════════════════════════════════════════ */
            
            /* FACILITY WHITE - The Villain (evil, erasure, compliance) */
            --facility: #ffffff;
            --facility-glow: rgba(255, 255, 255, 0.15);
            --facility-soft: rgba(255, 255, 255, 0.08);
            
            /* VINCENT - Steel Blue (cold, fading, caught between worlds) */
            --vincent: #8fa4b8;
            --vincent-bright: #a8c0d4;
            --vincent-glow: rgba(143, 164, 184, 0.25);
            --vincent-subtle: rgba(143, 164, 184, 0.08);
            
            /* CATHERINE/RABBIT - Warm Coral (love, humanity, defiance) */
            --rabbit: #ff8a80;
            --rabbit-glow: rgba(255, 138, 128, 0.2);
            --rabbit-subtle: rgba(255, 138, 128, 0.08);
            --coral: var(--rabbit);
            --coral-glow: var(--rabbit-glow);
            
            /* OWEN - Warm Gold (hope, innocence, worth saving) */
            --owen: #e8b84a;
            --owen-glow: rgba(232, 184, 74, 0.25);
            --owen-subtle: rgba(232, 184, 74, 0.08);
            
            /* FREEDOM GREEN - Escape ending only */
            --freedom: #39ff14;
            --freedom-glow: rgba(57, 255, 20, 0.2);
            
            /* DEATH - Termination only */
            --terminated: #8b0000;
            
            /* ─── STRUCTURAL ─── */
            --border: #282828;
            --border-light: #383838;
            --redacted: #1a1a1a;
            
            /* ─── SPACING SYSTEM (8px base) ─── */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;
            
            /* ─── TOUCH TARGETS (44px minimum for iOS) ─── */
            --touch-target: 44px;
            --touch-target-lg: 52px;
            
            /* ─── SAFE AREAS ─── */
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
            --safe-left: env(safe-area-inset-left, 0px);
            --safe-right: env(safe-area-inset-right, 0px);
            
            /* ─── LEGACY ALIASES (mapped to new system) ─── */
            --amber: var(--vincent);
            --amber-glow: var(--vincent-glow);
            --amber-bright: var(--vincent-bright);
            --catherine: var(--rabbit);
            --rabbit-mid: var(--rabbit);
            --rabbit-dark: var(--rabbit);
            --rabbit-dead: var(--terminated);
            --white: var(--facility);
            --ice: var(--facility);
            --system-white: var(--facility);
            --system-cold: var(--facility);
            --green: var(--freedom);
            --green-bright: var(--freedom);
            --green-glow: var(--freedom-glow);
            --teal: var(--freedom);
            --teal-glow: var(--freedom-glow);
            --system-green: var(--freedom);
            --jokeguy: var(--text-secondary);
            --text-hero: var(--facility);
            --text-muted: var(--text-dim);
            --vincent-lie: var(--text-dim);
        }

        /* ═══════════════════════════════════════════════════════════
           CHARACTER COLOR CLASSES
           ═══════════════════════════════════════════════════════════ */
        
        /* Vincent - Steel Blue, the man fading */
        .c-vincent { 
            color: var(--vincent); 
            text-shadow: 0 0 12px var(--vincent-glow);
        }
        
        /* Catherine/Rabbit - Warm Coral, humanity and love */
        .c-rabbit { 
            color: var(--rabbit); 
            text-shadow: 0 0 10px var(--rabbit-glow);
        }
        .c-rabbit-mid { color: var(--rabbit); }
        .c-rabbit-dark { color: var(--rabbit); }
        .c-rabbit-dead { color: var(--terminated); }
        .c-catherine { 
            color: var(--rabbit); 
            text-shadow: 0 0 10px var(--rabbit-glow);
        }
        
        /* Owen - Warm Gold, hope and innocence */
        .c-owen { 
            color: var(--owen); 
            text-shadow: 0 0 12px var(--owen-glow);
        }
        
        /* Facility - Cold White, the consuming force */
        .c-facility { 
            color: var(--facility); 
            text-shadow: 0 0 15px var(--facility-glow);
        }
        .c-ice { 
            color: var(--facility); 
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.6), 0 0 40px rgba(255, 255, 255, 0.3);
        }
        .c-cold { color: var(--facility); }
        .c-system { color: var(--facility); }
        
        /* Emphasis and utility */
        .c-emphasis { 
            color: var(--text-bright); 
            font-weight: 400; 
        }
        .c-warm { 
            color: var(--owen); 
            text-shadow: 0 0 10px var(--owen-glow);
        }
        .c-terminated { 
            color: var(--terminated); 
            font-weight: bold; 
        }
        .c-crossed { 
            text-decoration: line-through; 
            opacity: 0.6;
            position: relative;
        }
        .c-jokeguy { color: var(--text-secondary); }
        .c-correction {
            color: var(--text-dim);
        }
        
        /* Vincent lie text - muted, uncertain */
        .c-vincent-lie { 
            color: var(--text-dim) !important;
            font-style: italic !important;
        }
        
        .c-crossed::before,
        .c-crossed::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            height: 1px;
            background: currentColor;
        }
        
        .c-crossed::before {
            top: 30%;
            transform: rotate(-2deg);
        }
        
        .c-crossed::after {
            top: 70%;
            transform: rotate(1deg);
        }
        .c-correction {
            color: var(--text-primary);
            font-style: italic;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        html {
            font-size: 15px;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        @media (min-width: 390px) {
            html {
                font-size: 16px;
            }
        }

        @media (min-width: 768px) {
            html {
                font-size: 17px;
            }
        }

        @media (min-width: 1200px) {
            html {
                font-size: 18px;
            }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            92% { opacity: 1; }
            93% { opacity: 0.98; }
            94% { opacity: 1; }
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            line-height: 1.75;
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
            overflow-y: scroll;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: none;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            animation: flicker 15s infinite;
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding-top: var(--safe-top);
            padding-bottom: var(--safe-bottom);
            padding-left: var(--safe-left);
            padding-right: var(--safe-right);
        }

        /* Subtle noise texture overlay - reduced for mobile battery */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.012;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
            z-index: 9999;
        }
        
        /* CRT scanline effect - very subtle on mobile */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.015) 0px,
                rgba(0, 0, 0, 0.015) 1px,
                transparent 1px,
                transparent 3px
            );
            z-index: 9998;
        }
        
        /* CRT vignette effect - softer for mobile */
        .crt-vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: radial-gradient(
                ellipse at center,
                transparent 0%,
                transparent 50%,
                rgba(0, 0, 0, 0.2) 100%
            );
            z-index: 9997;
        }

        /* Text selection color */
        ::selection {
            background: rgba(0, 212, 170, 0.3);
            color: var(--text-bright);
        }

        ::-moz-selection {
            background: rgba(0, 212, 170, 0.3);
            color: var(--text-bright);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-dim);
        }

        /* Focus states for accessibility */
        button:focus-visible,
        .checkbox-container:focus-visible,
        .break-option:focus-visible,
        li:focus-visible {
            outline: 2px solid var(--text-bright);
            outline-offset: 2px;
        }

        /* Minimal scanlines */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: repeating-linear-gradient(
                0deg,
                transparent 0px,
                transparent 2px,
                rgba(0, 0, 0, 0.03) 2px,
                rgba(0, 0, 0, 0.03) 3px
            );
            z-index: 9998;
        }

        .container {
            width: 100%;
            max-width: 680px;
            margin: 0 auto;
            padding: 0;
        }

        .page-content {
            padding: var(--space-lg) var(--space-md);
            padding-bottom: calc(var(--space-3xl) + var(--safe-bottom));
            max-width: 100%;
            margin: 0 auto;
        }

        @media (min-width: 390px) {
            .page-content {
                padding: var(--space-xl) var(--space-lg);
                padding-bottom: calc(var(--space-3xl) + var(--safe-bottom));
            }
        }

        @media (min-width: 768px) {
            .page-content {
                padding: var(--space-2xl) var(--space-xl);
                max-width: 640px;
            }
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* ============ TIMER BAR ============ */
        /* Timer CSS moved to login page section */

        .timer-spacer {
            height: 50px;
            display: none;
        }

        .timer-spacer.visible {
            display: block;
        }

        /* ============ TITLE PAGE ============ */
        .title-page {
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: var(--space-xl) var(--space-lg);
            padding-top: calc(var(--space-xl) + var(--safe-top));
            padding-bottom: calc(var(--space-lg) + var(--safe-bottom));
            position: relative;
            overflow: hidden;
        }
        
        /* Make everything on title page white except Owen's name */
        .title-page * {
            color: #ffffff !important;
        }
        
        .title-page .c-owen {
            color: var(--owen) !important;
        }

        /* Corner accents - smaller on mobile */
        .title-page::before,
        .title-page::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 40px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            opacity: 1;
        }
        
        @media (min-width: 390px) {
            .title-page::before,
            .title-page::after {
                width: 56px;
                height: 56px;
            }
        }

        .title-page::before {
            top: calc(var(--space-md) + var(--safe-top));
            left: var(--space-md);
            border-right: none;
            border-bottom: none;
        }

        .title-page::after {
            bottom: calc(var(--space-md) + var(--safe-bottom));
            right: var(--space-md);
            border-left: none;
            border-top: none;
        }

        @keyframes bootIn {
            0% { opacity: 0; transform: translateY(8px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes glowPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        /* Title block wrapper for better centering */
        .title-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .title-logo {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            font-weight: 400;
            letter-spacing: 0.4em;
            color: var(--text-dim);
            opacity: 0;
            margin-bottom: var(--space-md);
            text-transform: uppercase;
            animation: bootIn 0.6s ease 0.2s forwards;
        }

        @media (min-width: 390px) {
            .title-logo {
                font-size: 0.6rem;
                letter-spacing: 0.45em;
                margin-bottom: var(--space-lg);
            }
        }

        @keyframes titleColorShift {
            0% { color: var(--rabbit); }
            50% { color: var(--text-bright); }
            100% { color: #ffffff; }
        }

        @keyframes rabbitHint {
            0%, 70% { color: inherit; }
            85% { color: var(--rabbit); }
            100% { color: #ffffff; }
        }

        .title-rabbit {
            animation: rabbitHint 6s ease 2s forwards;
        }

        .title-main {
            font-family: 'VT323', monospace;
            font-size: 2.75rem;
            font-weight: 400;
            letter-spacing: 0.08em;
            margin-bottom: var(--space-sm);
            color: #ffffff;
            line-height: 1.1;
            opacity: 0;
            animation: bootIn 0.6s ease 0.4s forwards, titleColorShift 4s ease 1s forwards;
            text-shadow: 0 0 60px rgba(255, 255, 255, 0.2);
        }

        @media (min-width: 390px) {
            .title-main {
                font-size: 3.25rem;
                letter-spacing: 0.1em;
            }
        }

        @media (min-width: 768px) {
            .title-main {
                font-size: 3.75rem;
                letter-spacing: 0.15em;
            }
        }

        .title-sub {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 0.35em;
            color: var(--text-secondary);
            margin-bottom: 0;
            opacity: 0;
            text-transform: uppercase;
            animation: bootIn 0.6s ease 0.55s forwards;
        }

        @media (min-width: 390px) {
            .title-sub {
                font-size: 0.65rem;
                letter-spacing: 0.4em;
            }
        }

        .title-divider {
            width: 1px;
            height: 32px;
            background: linear-gradient(180deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            margin: var(--space-lg) auto;
            opacity: 0;
            animation: bootIn 0.6s ease 0.65s forwards;
        }
        
        @media (min-width: 390px) {
            .title-divider {
                height: 40px;
                margin: var(--space-xl) auto;
            }
        }

        .title-meta {
            margin-bottom: var(--space-lg);
            opacity: 0;
            animation: bootIn 0.6s ease 0.75s forwards;
        }

        @media (min-width: 390px) {
            .title-meta {
                margin-bottom: var(--space-xl);
            }
        }

        .title-form {
            font-size: 0.5rem;
            letter-spacing: 0.2em;
            color: var(--text-dim);
            margin-bottom: 4px;
            text-transform: uppercase;
            opacity: 0.7;
        }

        @media (min-width: 390px) {
            .title-form {
                font-size: 0.55rem;
                letter-spacing: 0.25em;
            }
        }

        .title-department {
            font-size: 0.45rem;
            color: var(--text-dim);
            opacity: 0.4;
            letter-spacing: 0.15em;
            text-transform: uppercase;
        }

        @media (min-width: 390px) {
            .title-department {
                font-size: 0.5rem;
                letter-spacing: 0.2em;
            }
        }

        .title-timestamp {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            color: var(--text-dim);
            opacity: 0.5;
            margin-top: var(--space-md);
            letter-spacing: 0.1em;
        }

        .employee-id {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            color: var(--text-dim);
            opacity: 0.4;
            margin-top: var(--space-sm);
            letter-spacing: 0.1em;
        }

        .redacted-name {
            color: var(--text-dim);
            letter-spacing: 1px;
        }

        .revealed-name {
            color: var(--owen);
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 48px 24px;
            text-align: center;
        }

        .login-header {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            letter-spacing: 4px;
            color: var(--white);
            margin-bottom: 48px;
        }

        .login-form-container {
            width: 100%;
            max-width: 320px;
            margin-bottom: 32px;
        }

        .login-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 2px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            text-align: left;
        }

        .login-name-input {
            width: 100%;
            padding: 14px 16px;
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            letter-spacing: 2px;
            background: rgba(0, 212, 170, 0.05);
            border: 1px solid var(--teal);
            color: var(--white);
            text-transform: uppercase;
            outline: none;
            transition: all 0.3s ease;
        }

        .login-name-input::placeholder {
            color: var(--text-dim);
            opacity: 0.5;
        }

        .login-name-input:focus {
            border-color: var(--white);
            background: rgba(0, 212, 170, 0.08);
        }

        .login-hint {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 1px;
            color: var(--text-dim);
            margin-top: 8px;
            text-align: left;
            opacity: 0.6;
        }

        .login-proceed-btn {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 3px;
            color: var(--text-dim);
            padding: 14px 32px;
            border: 1px solid var(--border-light);
            cursor: not-allowed;
            transition: all 0.2s ease;
            opacity: 0.4;
            position: relative;
            overflow: hidden;
        }

        .login-proceed-btn.enabled {
            color: var(--white);
            border-color: var(--teal);
            cursor: pointer;
            opacity: 1;
        }
        
        .login-proceed-btn.enabled::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 170, 0.15), transparent);
            transition: left 0.4s ease;
        }

        .login-proceed-btn.enabled:hover {
            background: rgba(0, 212, 170, 0.1);
            border-color: var(--white);
            box-shadow: 0 0 15px rgba(0, 212, 170, 0.2);
        }
        
        .login-proceed-btn.enabled:hover::before {
            left: 100%;
        }
        
        .login-proceed-btn.enabled:active {
            transform: scale(0.98);
        }

        .login-footer {
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            letter-spacing: 2px;
            color: var(--text-dim);
            margin-top: 48px;
            opacity: 0.4;
        }

        /* Updated Timer UI */
        .timer {
            display: none;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px;
            background: var(--bg-dark);
            border-bottom: 1px solid var(--border-light);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
        }

        .timer.visible {
            display: flex;
        }

        .timer-left {
            flex: 1;
            text-align: left;
        }

        .timer-center {
            flex: 1;
            text-align: center;
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .tracking-disabled-text {
            transition: opacity 0.3s ease;
        }

        .tracking-disabled-text.warning {
            color: var(--coral);
        }

        .timer-right {
            flex: 1;
            text-align: right;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
        }

        .player-name-display {
            font-family: 'VT323', monospace;
            font-size: 0.85rem;
            letter-spacing: 1px;
            color: var(--text-bright);
        }

        .score-display {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 1px;
            color: var(--text-secondary);
        }

        .report-btn {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            background: transparent;
            border: 1px solid var(--text-dim);
            color: var(--text-dim);
            padding: 4px 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .report-btn:hover {
            border-color: var(--amber);
            color: var(--amber);
        }

        @media (min-width: 480px) {
            .timer {
                padding: 12px 24px;
            }
            
            .player-name-display {
                font-size: 0.95rem;
            }
            
            .timer-center {
                font-size: 1rem;
            }
            
            .score-display {
                font-size: 0.6rem;
            }
        }

        /* Section 3 redacted content */
        .redact-s3 {
            color: var(--text-dim);
            letter-spacing: 0;
            user-select: none;
        }

        .redact-s3.revealed {
            color: inherit;
            letter-spacing: inherit;
            user-select: auto;
        }

        /* Rabbit name redacted - keeps parent color */
        .redact-rabbit {
            letter-spacing: 0;
            user-select: none;
        }

        .redact-rabbit.revealed {
            letter-spacing: inherit;
            user-select: auto;
        }

        /* Rabbit name reveal container - for Section 2 alternating effect */
        .rabbit-container {
            position: relative;
            display: inline;
            font-family: 'Space Mono', monospace;
        }

        .rabbit-container .rabbit-name {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            animation: rabbitRevealName 3s ease-in-out infinite;
            white-space: nowrap;
            pointer-events: none;
            line-height: inherit;
        }

        .rabbit-container .rabbit-reveal-redact {
            animation: rabbitRevealRedact 3s ease-in-out infinite;
            visibility: visible;
            display: inline;
        }

        @keyframes rabbitRevealName {
            0%, 40% { 
                opacity: 0;
            }
            50%, 90% { 
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        @keyframes rabbitRevealRedact {
            0%, 40% { 
                opacity: 1;
            }
            50%, 90% { 
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        /* On Owen's view (2nd playthrough), stop the animation and show revealed */
        body.owen-view .rabbit-container .rabbit-name {
            opacity: 1;
            animation: none;
            position: relative;
            top: auto;
            transform: none;
        }

        body.owen-view .rabbit-container .rabbit-reveal-redact {
            display: none;
            animation: none;
        }
        
        /* Owen name reveal container - for Section 6 alternating effect */
        .owen-container {
            position: relative;
            display: inline-block;
            font-family: 'Space Mono', monospace;
        }

        .owen-container .owen-name {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            animation: owenRevealName 3s ease-in-out infinite;
            white-space: nowrap;
        }

        .owen-container .owen-reveal-redact {
            animation: owenRevealRedact 3s ease-in-out infinite;
            visibility: visible;
        }

        @keyframes owenRevealName {
            0%, 40% { 
                opacity: 0;
            }
            50%, 90% { 
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        @keyframes owenRevealRedact {
            0%, 40% { 
                opacity: 1;
            }
            50%, 90% { 
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        /* On Owen's view (2nd playthrough), stop Owen animation and show revealed */
        body.owen-view .owen-container .owen-name {
            opacity: 1;
            animation: none;
        }

        body.owen-view .owen-container .owen-reveal-redact {
            opacity: 0;
            animation: none;
        }

        /* Redacted "waiting" text - cycles through character colors */
        .redacted-waiting {
            animation: colorCycle 4s ease-in-out infinite;
        }

        @keyframes colorCycle {
            0%, 100% { color: var(--text-dim); }
            15% { color: var(--vincent); }
            30% { color: var(--catherine); }
            45% { color: var(--rabbit); }
            60% { color: var(--terminated); }
            75% { color: var(--owen); }
            90% { color: var(--ice); }
        }

        /* Owen's view - brighter amber (second playthrough) */
        body.owen-view .amber-text {
            color: var(--owen);
            border-left-color: var(--owen);
        }

        body.owen-view .amber-text .hidden-message {
            color: var(--owen);
        }

        body.owen-view .amber-warning-header,
        body.owen-view .amber-warning-text,
        body.owen-view .amber-warning-directive {
            color: var(--owen);
        }

        body.owen-view .amber-end-text {
            color: var(--owen);
        }

        body.owen-view .admin-header {
            color: var(--owen);
        }

        body.owen-view .filler-text {
            color: var(--owen);
        }

        .title-begin {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: var(--touch-target-lg);
            padding: var(--space-sm) var(--space-xl);
            border: 1px solid rgba(255, 255, 255, 0.35);
            background: rgba(255, 255, 255, 0.02);
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 0.3em;
            color: var(--text-bright);
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            opacity: 0;
            animation: bootIn 0.6s ease 0.9s forwards;
            -webkit-tap-highlight-color: transparent;
        }
        
        @media (min-width: 390px) {
            .title-begin {
                padding: var(--space-md) var(--space-2xl);
                font-size: 0.6rem;
                letter-spacing: 0.35em;
            }
        }
        
        .title-begin::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .title-begin:hover {
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .title-begin:hover::before {
            left: 100%;
        }
        
        .title-begin:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.8);
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .blink-slow {
            animation: blink 2s ease-in-out infinite;
        }

        .title-warning {
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            letter-spacing: 0.2em;
            color: var(--text-dim);
            margin-top: var(--space-lg);
            opacity: 0;
            text-transform: uppercase;
            animation: bootIn 0.6s ease 1s forwards;
        }
        
        .title-warning-dot {
            display: inline-block;
            width: 4px;
            height: 4px;
            background: var(--rabbit);
            border-radius: 50%;
            margin-right: 6px;
            vertical-align: middle;
            animation: blink 1.5s ease-in-out infinite;
        }
        
        @media (min-width: 390px) {
            .title-warning {
                font-size: 0.5rem;
                letter-spacing: 0.25em;
                margin-top: var(--space-xl);
            }
        }

        /* ============ INSTRUCTIONS ============ */
        .instructions-page {
            padding-bottom: var(--space-2xl);
        }

        .instructions-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 0.25em;
            margin-bottom: var(--space-lg);
            color: var(--text-secondary);
            text-align: center;
            text-transform: uppercase;
        }

        .instructions-subheader {
            display: none;
        }
        
        @media (min-width: 390px) {
            .instructions-header {
                font-size: 0.65rem;
                letter-spacing: 0.3em;
                margin-bottom: var(--space-xl);
            }
        }

        /* Icon styles - Premium design */
        .instruction-icon {
            width: 52px;
            height: 52px;
            margin: 0 auto var(--space-md);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @media (min-width: 390px) {
            .instruction-icon {
                width: 56px;
                height: 56px;
            }
        }
        
        .instruction-icon svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.1));
        }
        
        .instruction-icon-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.06) 0%, transparent 70%);
            animation: iconPulse 4s ease-in-out infinite;
        }
        
        @keyframes iconPulse {
            0%, 100% { transform: scale(1); opacity: 0.4; }
            50% { transform: scale(1.08); opacity: 0.7; }
        }
        
        /* Icon 1 - Checklist/Answer */
        .icon-answer svg {
            stroke: var(--teal);
        }
        
        /* Icon 2 - Scroll/Arrow with amber accent */
        .icon-scroll-new {
            animation: scrollFloat 3s ease-in-out infinite;
        }
        
        .icon-scroll-new svg {
            stroke: var(--amber);
            filter: drop-shadow(0 0 8px rgba(255, 200, 0, 0.25));
        }
        
        @keyframes scrollFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        /* Icon 3 - Lock/Final */
        .icon-final svg {
            stroke: var(--coral);
            filter: drop-shadow(0 0 6px rgba(255, 138, 128, 0.15));
        }
        
        /* Key rule icon - Eye with warning */
        .key-rule-icon-new {
            width: 56px;
            height: 56px;
            margin: 0 auto var(--space-md);
            position: relative;
        }
        
        @media (min-width: 390px) {
            .key-rule-icon-new {
                width: 64px;
                height: 64px;
            }
        }
        
        .key-rule-icon-new svg {
            width: 100%;
            height: 100%;
            stroke: var(--amber);
            filter: drop-shadow(0 0 12px rgba(255, 200, 0, 0.35));
        }
        
        .key-rule-icon-new .eye-slash {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 75%;
            height: 2px;
            background: var(--coral);
            transform: translate(-50%, -50%) rotate(-45deg);
            box-shadow: 0 0 8px rgba(255, 138, 128, 0.5);
            border-radius: 1px;
        }

        .icon-eye {
            display: none;
        }

        .icon-scroll {
            display: none;
        }

        @keyframes scrollBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }

        /* Instruction cards */
        .instruction-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: var(--space-lg) var(--space-md);
            margin-bottom: var(--space-md);
            text-align: center;
            border-radius: 2px;
        }
        
        @media (min-width: 390px) {
            .instruction-card {
                padding: var(--space-xl) var(--space-lg);
            }
        }

        .instruction-card-number {
            font-family: 'Space Mono', monospace;
            font-size: 0.5625rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            margin-bottom: var(--space-xs);
            text-transform: uppercase;
        }

        .instruction-card-title {
            font-family: 'VT323', monospace;
            font-size: 1.125rem;
            letter-spacing: 0.1em;
            color: var(--text-bright);
            margin-bottom: var(--space-sm);
        }
        
        @media (min-width: 390px) {
            .instruction-card-title {
                font-size: 1.1875rem;
            }
        }

        .instruction-card-text {
            font-size: 0.8125rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        
        @media (min-width: 390px) {
            .instruction-card-text {
                font-size: 0.875rem;
                line-height: 1.75;
            }
        }

        /* Scenario introduction box */
        /* ============ DRILL SCENARIO - CINEMATIC HERO ============ */
        .scenario-intro {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 0;
            margin: 0 0 var(--space-2xl);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 138, 128, 0.05);
        }
        
        .scenario-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 0.3em;
            color: var(--text-secondary);
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid var(--border);
            text-align: center;
        }
        
        .scenario-hero {
            padding: var(--space-xl) var(--space-lg) var(--space-xl);
            text-align: center;
            position: relative;
        }
        
        .scenario-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 1px;
            height: 32px;
            background: linear-gradient(to bottom, var(--border), transparent);
        }
        
        .scenario-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 0.15em;
            color: var(--rabbit);
            margin-bottom: var(--space-lg);
            padding: 5px 10px;
            border: 1px solid rgba(255, 138, 128, 0.4);
            background: rgba(255, 138, 128, 0.08);
            animation: statusGlow 2s ease-in-out infinite;
        }
        
        @keyframes statusGlow {
            0%, 100% {
                box-shadow: 0 0 8px rgba(255, 138, 128, 0.15);
            }
            50% {
                box-shadow: 0 0 15px rgba(255, 138, 128, 0.3);
            }
        }
        
        .scenario-status-dot {
            width: 5px;
            height: 5px;
            background: var(--rabbit);
            border-radius: 50%;
            animation: statusBlink 1.5s ease-in-out infinite;
        }
        
        @keyframes statusBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .scenario-headline {
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            letter-spacing: 0.08em;
            color: #ffffff;
            line-height: 1.4;
            margin-bottom: var(--space-sm);
        }
        
        .scenario-headline-main {
            display: block;
            font-size: 1.7rem;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
        }
        
        .scenario-headline-sub {
            display: block;
            font-size: 0.95rem;
            color: var(--text-primary);
            letter-spacing: 0.12em;
        }
        
        .scenario-divider {
            width: 40px;
            height: 1px;
            background: var(--text-dim);
            margin: var(--space-lg) auto var(--space-xl);
        }
        
        .scenario-body {
            font-size: 0.8rem;
            line-height: 2.1;
            color: var(--text-primary);
            text-align: left;
            padding: 0 var(--space-md);
            margin: 0 0 var(--space-xl);
        }
        
        .scenario-objective {
            text-align: center;
        }
        
        .scenario-objective-action {
            display: inline-block;
            font-family: 'Space Mono', monospace;
            font-size: 0.65rem;
            letter-spacing: 0.12em;
            color: var(--rabbit);
            text-transform: uppercase;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid rgba(255, 138, 128, 0.4);
            background: rgba(255, 138, 128, 0.05);
            animation: objectiveGlow 2s ease-in-out infinite;
        }
        
        @keyframes objectiveGlow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(255, 138, 128, 0.1);
                border-color: rgba(255, 138, 128, 0.4);
            }
            50% {
                box-shadow: 0 0 20px rgba(255, 138, 128, 0.25);
                border-color: rgba(255, 138, 128, 0.7);
            }
        }
        
        .scenario-footer {
            padding: var(--space-sm) 0;
            border-top: 1px solid var(--border);
            overflow: hidden;
            position: relative;
        }
        
        .scenario-footer-scroll {
            display: flex;
            gap: var(--space-xl);
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.12em;
            color: var(--text-secondary);
            white-space: nowrap;
            animation: footerScroll 20s linear infinite;
        }
        
        @keyframes footerScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        .scenario-footer-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .scenario-footer-dot {
            width: 4px;
            height: 4px;
            background: var(--rabbit);
            border-radius: 50%;
            animation: statusBlink 1.5s ease-in-out infinite;
        }
        
        @media (min-width: 390px) {
            .scenario-intro {
                margin: 0 0 var(--space-2xl);
            }
            .scenario-label {
                font-size: 0.6rem;
                padding: var(--space-md) var(--space-xl);
            }
            .scenario-hero {
                padding: var(--space-2xl) var(--space-xl) var(--space-2xl);
            }
            .scenario-headline-main {
                font-size: 2.1rem;
            }
            .scenario-headline-sub {
                font-size: 1.05rem;
            }
            .scenario-body {
                font-size: 0.85rem;
                padding: 0 var(--space-lg);
                line-height: 2.2;
            }
            .scenario-divider {
                margin: var(--space-xl) auto var(--space-2xl);
            }
            .scenario-objective-action {
                font-size: 0.7rem;
                padding: var(--space-sm) var(--space-lg);
            }
            .scenario-footer-scroll {
                font-size: 0.55rem;
            }
        }

        /* ============ KEY RULE - MAIN CALLOUT ============ */
        /* ============ KEY RULE - MAIN CALLOUT ============ */
        .key-rule {
            background: transparent;
            border: none;
            border-left: 3px solid var(--vincent);
            padding: var(--space-md) var(--space-lg);
            margin: 0 0 var(--space-lg);
            text-align: left;
        }
        
        @media (min-width: 390px) {
            .key-rule {
                padding: var(--space-lg) var(--space-xl);
                margin: 0 0 var(--space-xl);
            }
        }

        .key-rule-icon {
            display: none;
        }
        
        .key-rule-icon svg {
            display: none;
        }

        .key-rule-text {
            font-family: 'VT323', monospace;
            font-size: 1.3rem;
            letter-spacing: 0.05em;
            color: var(--text-bright);
            line-height: 1.4;
        }
        
        .key-rule-text span {
            color: var(--vincent);
            text-shadow: 0 0 15px var(--vincent-glow);
        }
        
        @media (min-width: 390px) {
            .key-rule-text {
                font-size: 1.5rem;
            }
        }

        .key-rule-sub {
            font-size: 0.75rem;
            color: var(--text-primary);
            margin-top: var(--space-sm);
            line-height: 1.8;
        }
        
        @media (min-width: 390px) {
            .key-rule-sub {
                font-size: 0.8rem;
            }
        }

        /* ============ PROTOCOL SECTION ============ */
        .instruction-rules {
            margin: var(--space-lg) 0 var(--space-xl);
        }
        
        .instruction-rules-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            color: var(--text-secondary);
            letter-spacing: 0.2em;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border);
        }
        
        @media (min-width: 390px) {
            .instruction-rules {
                margin: var(--space-xl) 0 var(--space-2xl);
            }
            .instruction-rules-header {
                font-size: 0.6rem;
                margin-bottom: var(--space-xl);
            }
        }
        
        .instruction-rule {
            display: flex;
            align-items: flex-start;
            text-align: left;
            padding: var(--space-lg) var(--space-md);
            margin: var(--space-md) 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }
        
        @media (min-width: 390px) {
            .instruction-rule {
                padding: var(--space-xl) var(--space-lg);
                margin: var(--space-lg) 0;
            }
        }
        
        .rule-number {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-right: var(--space-md);
            min-width: 28px;
            opacity: 0.8;
        }
        
        .rule-content {
            flex: 1;
        }
        
        .rule-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.6875rem;
            color: var(--text-bright);
            letter-spacing: 0.08em;
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
        }
        
        @media (min-width: 390px) {
            .rule-title {
                font-size: 0.75rem;
                letter-spacing: 0.1em;
                margin-bottom: var(--space-md);
            }
        }
        
        .rule-desc {
            font-size: 0.8rem;
            color: var(--text-primary);
            line-height: 1.9;
        }
        
        @media (min-width: 390px) {
            .rule-desc {
                font-size: 0.85rem;
                line-height: 2;
            }
        }

        /* Example amber preview */
        .example-amber {
            background: var(--bg-secondary);
            border: 1px solid rgba(143, 164, 184, 0.2);
            border-left: 2px solid var(--vincent);
            padding: var(--space-md);
            margin: var(--space-lg) 0;
            color: var(--vincent);
            font-size: 0.75rem;
            line-height: 1.7;
            text-shadow: 0 0 8px var(--vincent-glow);
            position: relative;
        }
        
        @media (min-width: 390px) {
            .example-amber {
                padding: var(--space-lg);
                font-size: 0.8125rem;
            }
        }

        .example-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            letter-spacing: 2px;
            color: var(--text-dim);
            margin-bottom: 16px;
            text-align: center;
        }

        .example-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 2px;
            margin-bottom: 12px;
            color: var(--vincent);
            background: rgba(143, 164, 184, 0.1);
            padding: 6px 12px;
            display: inline-block;
        }

        /* Final note */
        .final-note {
            text-align: center;
            padding: 20px;
            margin: 32px 0 24px 0;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .final-note-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .final-note-text strong {
            color: var(--text-primary);
        }

        /* Hidden hint from V - first letters spell LOOK RABBIT */
        .legal-notice {
            font-size: 0.7rem;
            color: var(--text-secondary);
            opacity: 0.7;
            margin: 24px 0;
            line-height: 1.9;
            text-align: left;
        }
        
        @media (min-width: 390px) {
            .legal-notice {
                font-size: 0.8rem;
                line-height: 2.1;
            }
        }

        .acrostic-letter {
            color: var(--rabbit);
            font-weight: 700;
            text-shadow: 
                0 0 8px var(--rabbit-glow), 
                0 0 16px var(--rabbit-glow), 
                0 0 24px var(--rabbit-glow);
            animation: acrosticGlow 2s ease-in-out infinite;
        }

        @keyframes acrosticGlow {
            0%, 100% { 
                text-shadow: 
                    0 0 8px var(--rabbit-glow), 
                    0 0 16px var(--rabbit-glow), 
                    0 0 24px var(--rabbit-glow);
                opacity: 1;
            }
            50% { 
                text-shadow: 
                    0 0 12px var(--rabbit), 
                    0 0 24px var(--rabbit-glow), 
                    0 0 36px var(--rabbit-glow);
                opacity: 0.85;
            }
        }

        /* Agreement box */
        .agreement-box {
            margin-top: 40px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .checkbox-container {
            display: flex;
            gap: 16px;
            align-items: flex-start;
            cursor: pointer;
            margin-bottom: 24px;
            padding: 16px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .checkbox-container:hover {
            border-color: var(--border-light);
        }

        .custom-checkbox {
            width: 20px;
            height: 20px;
            min-width: 20px;
            border: 2px solid var(--text-dim);
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 2px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .custom-checkbox.checked {
            border-color: var(--text-bright);
            background: var(--text-bright);
        }

        .custom-checkbox.checked::after {
            content: '✓';
            color: var(--bg-primary);
            font-size: 14px;
            font-weight: bold;
        }

        .checkbox-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.7;
            cursor: pointer;
        }

        .understand-btn {
            width: 100%;
            padding: 18px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            color: var(--text-dim);
            font-family: 'VT323', monospace;
            font-size: 1rem;
            letter-spacing: 3px;
            cursor: not-allowed;
            transition: all 0.3s ease;
        }

        .understand-btn.enabled {
            cursor: pointer;
            border-color: var(--text-bright);
            color: var(--white);
            background: transparent;
        }

        .understand-btn.enabled:hover {
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
        }

        .section-header {
            font-family: 'VT323', monospace;
            font-size: 0.65rem;
            color: var(--text-bright);
            text-align: center;
            letter-spacing: 1px;
            margin-bottom: 24px;
            opacity: 0.7;
            word-break: break-word;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        }

        @media (min-width: 480px) {
            .section-header {
                font-size: 0.75rem;
                letter-spacing: 2px;
                margin-bottom: 28px;
            }
        }

        /* ============ WARNING BOX ============ */
        .warning-box {
            border-left: 2px solid var(--text-secondary);
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.03);
            margin-bottom: var(--space-xl);
            border-radius: 2px;
        }
        
        @media (min-width: 390px) {
            .warning-box {
                padding: var(--space-lg);
            }
        }

        .warning-box h2 {
            font-family: 'VT323', monospace;
            font-size: 0.875rem;
            color: var(--text-bright);
            margin-bottom: var(--space-sm);
            letter-spacing: 0.15em;
        }

        .warning-box ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .warning-box li {
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
            padding-left: var(--space-md);
            position: relative;
            font-size: 0.75rem;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        @media (min-width: 390px) {
            .warning-box li {
                font-size: 0.8125rem;
            }
        }

        .warning-box li::before {
            content: "›";
            position: absolute;
            left: 0;
        }

        /* ============ TEST SECTIONS ============ */
        .test-section {
            display: none;
        }

        .test-section.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress {
            font-family: 'Space Mono', monospace;
            font-size: 0.625rem;
            color: var(--text-dim);
            text-align: center;
            margin-bottom: var(--space-xl);
            letter-spacing: 0.25em;
            text-transform: uppercase;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border);
            display: inline-block;
            margin-left: 50%;
            transform: translateX(-50%);
        }
        
        @media (min-width: 390px) {
            .progress {
                font-size: 0.6875rem;
                margin-bottom: var(--space-2xl);
            }
        }

        .section-header {
            font-family: 'VT323', monospace;
            font-size: 0.6875rem;
            color: var(--text-dim);
            text-align: center;
            letter-spacing: 0.2em;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border);
        }
        
        @media (min-width: 390px) {
            .section-header {
                font-size: 0.75rem;
                letter-spacing: 0.25em;
            }
        }

        .terminal-line {
            font-family: 'VT323', monospace;
            font-size: 0.625rem;
            color: var(--text-ghost);
            text-align: center;
            letter-spacing: 0.15em;
            margin: var(--space-xl) 0 var(--space-md) 0;
            opacity: 0.8;
        }

        /* ============ QUESTIONS ============ */
        .question-block {
            margin-bottom: var(--space-xl);
            padding-bottom: var(--space-xl);
            border-bottom: 1px solid var(--border);
        }

        @media (min-width: 390px) {
            .question-block {
                margin-bottom: var(--space-2xl);
                padding-bottom: var(--space-2xl);
            }
        }

        .question-block:last-of-type {
            border-bottom: none;
        }

        .question-number {
            font-family: 'Space Mono', monospace;
            font-size: 0.5625rem;
            color: var(--text-dim);
            letter-spacing: 0.2em;
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
        }
        
        @media (min-width: 390px) {
            .question-number {
                font-size: 0.625rem;
                margin-bottom: var(--space-md);
            }
        }

        .question-text {
            font-size: 0.875rem;
            margin-bottom: var(--space-lg);
            line-height: 1.85;
            color: var(--text-primary);
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.02);
            border-left: 2px solid var(--border);
            transition: border-color 0.3s ease;
        }

        .question-text:hover {
            border-left-color: var(--text-dim);
        }

        @media (min-width: 390px) {
            .question-text {
                font-size: 0.9375rem;
                margin-bottom: var(--space-xl);
                line-height: 1.9;
                padding: var(--space-lg);
            }
        }

        .options {
            list-style: none;
            padding: 0;
        }

        .options li {
            min-height: var(--touch-target);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            border: 1px solid var(--border);
            background: var(--bg-card);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.8125rem;
            line-height: 1.7;
            color: var(--text-secondary);
            word-wrap: break-word;
            overflow-wrap: break-word;
            border-radius: 2px;
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }

        .options li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0;
            background: var(--facility);
            transition: width 0.2s ease;
            opacity: 0.1;
        }

        @media (min-width: 390px) {
            .options li {
                padding: var(--space-md) var(--space-lg);
                font-size: 0.875rem;
                line-height: 1.75;
            }
        }

        .options li:hover {
            border-color: var(--text-dim);
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .options li:hover::before {
            width: 3px;
        }
        
        .options li:active {
            transform: scale(0.99);
            background: var(--bg-elevated);
        }

        .options li.selected {
            border-color: var(--facility);
            background: var(--facility-soft);
            color: var(--text-bright);
            box-shadow: 0 0 15px var(--facility-glow);
        }

        .options li.selected::before {
            width: 3px;
            opacity: 0.8;
        }

        .options li.locked {
            opacity: 0.35;
            pointer-events: none;
        }

        .options li.locked.selected {
            opacity: 1;
        }

        .options li.correct-answer {
            border-color: var(--facility) !important;
            background: rgba(255, 255, 255, 0.12) !important;
            color: var(--text-bright) !important;
            opacity: 1 !important;
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.3);
        }

        .options li.correct-answer::before {
            content: '✓ ';
            opacity: 0.7;
        }

        .options li.wrong-answer {
            border-color: var(--text-ghost) !important;
            background: transparent !important;
            color: var(--text-dim) !important;
            opacity: 0.4 !important;
        }

        .options li.wrong-answer.selected {
            opacity: 0.7 !important;
            border-color: var(--text-dim) !important;
            text-decoration: line-through;
            text-decoration-color: var(--text-ghost);
        }

        /* ============ LEAKED FILE SECTIONS ============ */
        @keyframes leakReveal {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Flickering animation for the breach header */
        @keyframes breachFlicker {
            0%, 100% { 
                opacity: 1;
                text-shadow: 0 0 8px var(--vincent-glow);
            }
            5% { 
                opacity: 0.1;
                text-shadow: none;
            }
            6% { 
                opacity: 1;
                text-shadow: 0 0 15px var(--vincent-glow), 0 0 30px var(--vincent-glow);
            }
            10% {
                opacity: 0.8;
            }
            15% {
                opacity: 1;
            }
            35% { 
                opacity: 0.05;
                text-shadow: none;
            }
            36% { 
                opacity: 1;
                text-shadow: 0 0 20px var(--vincent-glow);
            }
            55% {
                opacity: 1;
            }
            56% {
                opacity: 0.3;
            }
            57% {
                opacity: 1;
            }
            80% {
                opacity: 1;
                text-shadow: 0 0 8px var(--vincent-glow);
            }
            81% {
                opacity: 0.6;
                text-shadow: 0 0 25px var(--vincent-glow);
            }
            82% {
                opacity: 1;
            }
        }
        
        @keyframes breachBarFlicker {
            0%, 100% { 
                background: rgba(143, 164, 184, 0.15);
                border-bottom-color: rgba(143, 164, 184, 0.3);
            }
            5%, 35% { 
                background: rgba(143, 164, 184, 0.02);
                border-bottom-color: rgba(143, 164, 184, 0.1);
            }
            6%, 36% { 
                background: rgba(143, 164, 184, 0.25);
                border-bottom-color: rgba(143, 164, 184, 0.5);
            }
            56% {
                background: rgba(143, 164, 184, 0.08);
            }
            57%, 81% {
                background: rgba(143, 164, 184, 0.2);
            }
            82% {
                background: rgba(143, 164, 184, 0.15);
            }
        }
        
        @keyframes breachGlitch {
            0%, 100% {
                transform: translateX(0);
            }
            5% {
                transform: translateX(-2px);
            }
            6% {
                transform: translateX(3px);
            }
            35% {
                transform: translateX(1px);
            }
            36% {
                transform: translateX(-1px);
            }
            56% {
                transform: translateX(2px);
            }
            57% {
                transform: translateX(0);
            }
        }

        /* ═══════════════════════════════════════════════════════════
           CLASSIFIED LEAK SECTIONS (Vincent's hidden messages)
           A system glitch is causing classified files to bleed through
           ═══════════════════════════════════════════════════════════ */
        
        .classified-leak {
            color: var(--vincent);
            padding: var(--space-xl) var(--space-lg);
            margin: var(--space-2xl) calc(var(--space-md) * -1);
            font-size: 0.9375rem;
            line-height: 1.9;
            background: var(--bg-secondary);
            border: 1px solid rgba(143, 164, 184, 0.2);
            position: relative;
            animation: leakReveal 0.5s ease;
            word-wrap: break-word;
            overflow-wrap: break-word;
            text-shadow: 0 0 12px var(--vincent-glow);
        }
        
        @media (min-width: 390px) {
            .classified-leak {
                padding: var(--space-2xl) var(--space-xl);
                margin: var(--space-2xl) calc(var(--space-lg) * -1);
            }
        }

        /* Top warning bar - FLICKERING */
        .classified-leak::before {
            content: '▲ DATA BREACH — LEAKED FILE DETECTED';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(143, 164, 184, 0.15);
            padding: 8px 16px;
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 2px;
            color: var(--vincent);
            border-bottom: 1px solid rgba(143, 164, 184, 0.3);
            text-shadow: 0 0 8px var(--vincent-glow);
            animation: breachFlicker 4s ease-in-out infinite, breachBarFlicker 4s ease-in-out infinite, breachGlitch 4s ease-in-out infinite;
        }
        
        @media (min-width: 390px) {
            .classified-leak::before {
                font-size: 0.65rem;
                letter-spacing: 2.5px;
            }
        }

        /* Glowing left accent */
        .classified-leak::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--vincent);
            box-shadow: 0 0 10px var(--vincent-glow), 0 0 20px var(--vincent-glow);
        }

        @media (min-width: 768px) {
            .classified-leak {
                margin: 48px 0;
                padding: 48px 36px 40px 40px;
                padding-top: 56px;
                font-size: 0.92rem;
                line-height: 2.2;
            }
        }

        /* Leak header - the fake "file metadata" */
        .leak-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 1px;
            line-height: 2;
            margin-top: 20px;
            margin-bottom: 28px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(143, 164, 184, 0.15);
            color: var(--text-dim);
        }
        
        @media (min-width: 480px) {
            .leak-header {
                font-size: 0.65rem;
            }
        }
        
        .leak-header .doc-id {
            color: var(--vincent);
            opacity: 0.8;
        }
        
        .leak-header .forward-status {
            color: var(--rabbit);
            animation: forwardPulse 2s ease-in-out infinite;
        }
        
        @keyframes forwardPulse {
            0%, 100% { 
                opacity: 0.8;
                text-shadow: 0 0 5px var(--rabbit-glow);
            }
            50% { 
                opacity: 1;
                text-shadow: 0 0 12px var(--rabbit-glow);
            }
        }

        /* Legacy alias for backward compatibility */
        .amber-text {
            color: var(--vincent);
            padding: var(--space-xl) var(--space-lg);
            margin: var(--space-2xl) calc(var(--space-md) * -1);
            font-size: 0.9375rem;
            line-height: 1.9;
            background: var(--bg-secondary);
            border: 1px solid rgba(143, 164, 184, 0.2);
            position: relative;
            animation: leakReveal 0.5s ease;
            word-wrap: break-word;
            overflow-wrap: break-word;
            text-shadow: 0 0 12px var(--vincent-glow);
        }
        
        @media (min-width: 390px) {
            .amber-text {
                padding: var(--space-2xl) var(--space-xl);
                margin: var(--space-2xl) calc(var(--space-lg) * -1);
            }
        }

        .amber-text::before {
            content: '▲ DATA BREACH — LEAKED FILE DETECTED';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(143, 164, 184, 0.15);
            padding: 8px 16px;
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 2px;
            color: var(--vincent);
            border-bottom: 1px solid rgba(143, 164, 184, 0.3);
            text-shadow: 0 0 8px var(--vincent-glow);
            animation: breachFlicker 4s ease-in-out infinite, breachBarFlicker 4s ease-in-out infinite, breachGlitch 4s ease-in-out infinite;
        }
        
        @media (min-width: 390px) {
            .amber-text::before {
                font-size: 0.65rem;
                letter-spacing: 2.5px;
            }
        }

        .amber-text::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--vincent);
            box-shadow: 0 0 10px var(--vincent-glow), 0 0 20px var(--vincent-glow);
        }

        @media (min-width: 768px) {
            .amber-text {
                margin: 48px 0;
                padding: 48px 36px 40px 40px;
                padding-top: 56px;
                font-size: 0.92rem;
                line-height: 2.2;
            }
        }

        .admin-header {
            font-family: 'VT323', monospace;
            font-size: 0.7rem;
            letter-spacing: 2px;
            margin-bottom: 16px;
            opacity: 0.35;
            color: var(--vincent);
        }

        /* New leak header style */
        .amber-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 1px;
            line-height: 2;
            margin-top: 20px;
            margin-bottom: 28px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(143, 164, 184, 0.15);
            color: var(--text-dim);
        }
        
        @media (min-width: 480px) {
            .amber-header {
                font-size: 0.65rem;
            }
        }
        
        .amber-header .doc-id {
            color: var(--vincent);
            opacity: 0.8;
        }
        
        .amber-header .forward-tracking-disabled,
        .forward-tracking-disabled {
            color: var(--rabbit);
            opacity: 1;
            animation: forwardPulse 2s ease-in-out infinite;
        }

        .filler-text {
            font-size: 0.7rem;
            opacity: 0.25;
            line-height: 1.7;
            color: var(--amber);
            margin-bottom: 8px;
        }
        
        /* SCP-style formatting elements */
        .scp-redacted {
            background: #000;
            color: #000;
            padding: 0 4px;
            border-radius: 2px;
            user-select: none;
            cursor: default;
        }
        
        .scp-expunged {
            color: var(--text-dim);
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .scp-label {
            font-weight: bold;
            color: var(--text-bright);
        }
        
        .scp-addendum {
            border-left: 2px solid var(--text-ghost);
            padding-left: 15px;
            margin: 20px 0;
            font-size: 0.9em;
        }
        
        .scp-note {
            font-style: italic;
            color: var(--text-dim);
            border: 1px dashed var(--text-ghost);
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.85em;
        }
        
        .scp-note::before {
            content: "Note: ";
            font-weight: bold;
            font-style: normal;
        }
        
        .scp-warning-box {
            border: 1px solid var(--coral);
            background: rgba(255, 138, 128, 0.05);
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .scp-warning-box .warning-title {
            color: var(--coral);
            font-weight: bold;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }
        
        /* New amber header style - more prominent */
        .amber-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 1px;
            line-height: 1.9;
            margin-bottom: 24px;
            opacity: 0.5;
            color: var(--amber);
        }
        
        @media (min-width: 480px) {
            .amber-header {
                font-size: 0.75rem;
            }
        }
        
        .amber-header .doc-id {
            opacity: 0.6;
            font-size: 0.65rem;
        }
        
        .amber-header .forward-tracking-disabled,
        .forward-tracking-disabled {
            color: var(--coral);
            opacity: 1;
            animation: forwardTrackingPulse 2s ease-in-out infinite;
        }
        
        @keyframes forwardTrackingPulse {
            0%, 100% { 
                opacity: 0.9;
                text-shadow: 0 0 8px rgba(255, 138, 128, 0.5);
            }
            50% { 
                opacity: 1;
                text-shadow: 0 0 15px rgba(255, 138, 128, 0.8), 0 0 25px rgba(255, 138, 128, 0.4);
            }
        }
        
        /* Redacted year - shows as blocks */
        .year-redacted {
            background: var(--text-ghost);
            color: var(--text-ghost);
            padding: 0 2px;
            border-radius: 1px;
            user-select: none;
            letter-spacing: -1px;
        }
        
        /* Slightly different style for amber sections */
        .amber-text .year-redacted,
        .example-amber .year-redacted {
            background: rgba(255, 204, 0, 0.3);
            color: rgba(255, 204, 0, 0.3);
        }
        
        /* For the title page timestamp */
        .title-timestamp .year-redacted {
            background: var(--text-dim);
            color: var(--text-dim);
        }
        
        /* ============ TERMINATION ANNOUNCEMENT BROADCAST ============ */
        .termination-broadcast {
            position: relative;
            margin: 60px -20px;
            padding: 0;
            background: var(--bg-primary);
            border-top: 2px solid var(--white);
            border-bottom: 2px solid var(--white);
            overflow: hidden;
        }
        
        @media (min-width: 480px) {
            .termination-broadcast {
                margin: 80px -40px;
            }
        }
        
        .termination-broadcast::before {
            content: '◉ FACILITY-WIDE BROADCAST ◉';
            display: block;
            text-align: center;
            font-family: 'VT323', monospace;
            font-size: 0.65rem;
            letter-spacing: 4px;
            color: var(--white);
            background: var(--bg-primary);
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .termination-content {
            padding: 40px 20px;
            text-align: center;
            animation: broadcastPulse 3s ease-in-out infinite;
        }
        
        @keyframes broadcastPulse {
            0%, 100% { 
                background: rgba(255, 255, 255, 0.02);
            }
            50% { 
                background: rgba(255, 255, 255, 0.05);
            }
        }
        
        .termination-label {
            font-family: 'VT323', monospace;
            font-size: 0.7rem;
            letter-spacing: 3px;
            color: var(--text-dim);
            margin-bottom: 16px;
        }
        
        .termination-name {
            font-family: 'VT323', monospace;
            font-size: 1.8rem;
            letter-spacing: 6px;
            color: var(--white);
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            margin-bottom: 12px;
            text-transform: uppercase;
        }
        
        @media (min-width: 480px) {
            .termination-name {
                font-size: 2.2rem;
                letter-spacing: 8px;
            }
        }
        
        .termination-status {
            font-family: 'VT323', monospace;
            font-size: 1.4rem;
            letter-spacing: 8px;
            color: var(--terminated);
            text-shadow: 0 0 20px rgba(139, 0, 0, 0.8);
            margin-bottom: 20px;
            animation: terminatedFlash 2s ease-in-out infinite;
        }
        
        @keyframes terminatedFlash {
            0%, 100% { 
                opacity: 1;
            }
            50% { 
                opacity: 0.7;
            }
        }
        
        .termination-details {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 2px;
            color: var(--text-secondary);
            line-height: 2;
        }
        
        .termination-details span {
            display: inline-block;
            padding: 0 12px;
            border-left: 1px solid var(--text-ghost);
        }
        
        .termination-details span:first-child {
            border-left: none;
        }
        
        .termination-broadcast::after {
            content: 'THIS MESSAGE WILL REPEAT';
            display: block;
            text-align: center;
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 3px;
            color: var(--text-ghost);
            background: var(--bg-primary);
            padding: 8px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Second and third broadcasts - progressively more intense */
        .termination-broadcast.broadcast-2 {
            border-color: var(--coral);
        }
        
        .termination-broadcast.broadcast-2::before {
            content: '◉ FACILITY-WIDE BROADCAST — REPEAT ◉';
            color: var(--coral);
        }
        
        .termination-broadcast.broadcast-2 .termination-name {
            color: var(--coral);
            text-shadow: 0 0 30px rgba(255, 138, 128, 0.5);
        }
        
        .termination-broadcast.broadcast-3 {
            border-color: var(--terminated);
        }
        
        .termination-broadcast.broadcast-3::before {
            content: '◉◉◉ FACILITY-WIDE BROADCAST — FINAL ◉◉◉';
            color: var(--terminated);
        }
        
        .termination-broadcast.broadcast-3 .termination-name {
            color: var(--terminated);
            text-shadow: 0 0 30px rgba(139, 0, 0, 0.8);
            animation: finalBroadcast 1s ease-in-out infinite;
        }
        
        @keyframes finalBroadcast {
            0%, 100% { 
                transform: scale(1);
            }
            50% { 
                transform: scale(1.02);
            }
        }
        
        .termination-broadcast.broadcast-3::after {
            content: '';
            display: none;
        }

        .hidden-message {
            margin-top: 28px;
            line-height: 2.2;
            color: var(--amber);
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            text-shadow: 0 0 15px rgba(255, 200, 0, 0.25);
        }

        .story-break {
            text-align: center;
            margin: 50px 0;
            color: var(--text-dim);
        }

        .break-line {
            letter-spacing: 2px;
            opacity: 0.7;
        }

        @media (min-width: 768px) {
            .hidden-message {
                line-height: 2.2;
            }
        }

        .hidden-message em {
            opacity: 0.9;
            font-style: italic;
        }

        .hidden-message strong {
            color: var(--text-bright);
            font-weight: 400;
        }

        .cutoff {
            display: block;
            margin-top: 28px;
            opacity: 0.7;
            color: var(--amber);
            font-style: italic;
        }

        /* White fade effect for white room story - oscillates between original colors and white */
        #whiteRoomStory.fading-to-white,
        #whiteRoomStory.fading-to-white *,
        #whiteRoomStory.fading-to-white .c-rabbit,
        #whiteRoomStory.fading-to-white .c-rabbit-mid,
        #whiteRoomStory.fading-to-white .c-rabbit-dark,
        #whiteRoomStory.fading-to-white .c-owen,
        #whiteRoomStory.fading-to-white .c-vincent,
        #whiteRoomStory.fading-to-white .c-catherine,
        #whiteRoomStory.fading-to-white .c-ice,
        #whiteRoomStory.fading-to-white .c-cold,
        #whiteRoomStory.fading-to-white .c-emphasis {
            animation: oscillateToWhite 16s ease-in-out infinite;
        }
        
        @keyframes oscillateToWhite {
            0% {
                color: inherit;
            }
            50% {
                color: #ffffff;
            }
            100% {
                color: inherit;
            }
        }

        .lyrics {
            display: block;
            font-family: 'Space Mono', monospace;
            font-size: 1.1rem;
            font-style: italic;
            color: var(--coral);
            margin: 32px 0;
            padding: 20px 0;
            letter-spacing: 1px;
            text-align: center;
            border-top: 1px solid rgba(255, 138, 128, 0.2);
            border-bottom: 1px solid rgba(255, 138, 128, 0.2);
            animation: lyricGlow 4s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(255, 138, 128, 0.3);
        }

        @keyframes lyricGlow {
            0%, 100% { 
                text-shadow: 0 0 20px rgba(255, 180, 162, 0.3);
                opacity: 0.9;
            }
            50% { 
                text-shadow: 0 0 30px rgba(255, 180, 162, 0.5), 0 0 50px rgba(255, 180, 162, 0.2);
                opacity: 1;
            }
        }

        /* ============ GREEN TEXT ============ */
        @keyframes greenPulse {
            0%, 100% { border-left-color: var(--green); }
            50% { border-left-color: var(--green-bright); }
        }

        .green-text {
            color: var(--green);
            padding: 32px 16px 28px 20px;
            margin: 32px 0;
            font-size: 0.85rem;
            line-height: 2;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-left: 3px solid var(--green);
            position: relative;
            animation: amberReveal 0.6s ease, greenPulse 4s ease infinite;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .green-text::after {
            content: 'SYSTEM';
            position: absolute;
            top: -10px;
            left: 16px;
            background: var(--bg-primary);
            padding: 2px 8px;
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            letter-spacing: 2px;
            color: var(--green);
        }

        @media (min-width: 480px) {
            .green-text {
                padding: 40px 24px 36px 28px;
                margin: 40px 0;
                font-size: 0.9rem;
            }
            
            .green-text::after {
                left: 20px;
                font-size: 0.5rem;
                letter-spacing: 3px;
            }
        }

        @media (min-width: 768px) {
            .green-text {
                padding: 48px 36px 40px 40px;
                margin: 48px 0;
                font-size: 0.92rem;
                line-height: 2.2;
            }
            
            .green-text::after {
                left: 24px;
                letter-spacing: 4px;
            }
        }

        .green-text strong {
            color: var(--text-hero);
            font-weight: 400;
        }

        .green-text em {
            color: var(--green-bright);
            font-style: normal;
        }

        /* ============ GLITCH EFFECTS FOR GREEN TEXT ============ */
        @keyframes glitchFlicker {
            0%, 100% { opacity: 1; }
            92% { opacity: 1; }
            93% { opacity: 0.1; }
            94% { opacity: 1; }
            95% { opacity: 0.3; }
            96% { opacity: 1; }
        }

        @keyframes scoreGlitch {
            0%, 100% { transform: translateY(0); }
            10% { transform: translateY(-2px); }
            20% { transform: translateY(3px); }
            30% { transform: translateY(-1px); }
            40% { transform: translateY(2px); }
            50% { transform: translateY(0); }
        }

        @keyframes textCorrupt {
            0%, 100% { opacity: 1; color: var(--green); }
            50% { opacity: 0.7; color: var(--coral); }
        }

        @keyframes letterHighlight {
            0%, 100% { color: inherit; text-shadow: none; }
            50% { color: var(--coral); text-shadow: 0 0 10px var(--coral); }
        }

        @keyframes bgFlash {
            0%, 100% { background-color: var(--bg-primary); }
            50% { background-color: #1a0a0a; }
        }

        /* Creepy red flicker for "read" text in final section - very slow, barely noticeable */
        @keyframes deathFlicker {
            0%, 94%, 100% { color: inherit; opacity: 1; }
            95% { color: var(--rabbit-dead); opacity: 0.95; }
            96% { color: inherit; opacity: 1; }
        }

        @keyframes subtleDeathFlicker {
            0%, 92%, 100% { color: inherit; opacity: 1; }
            93% { color: var(--rabbit-dead); opacity: 0.9; }
            94% { color: inherit; opacity: 1; }
        }

        .death-flicker {
            animation: subtleDeathFlicker 25s ease-in-out infinite;
            animation-delay: var(--flicker-delay, 0s);
        }

        .death-flicker-fast {
            animation: deathFlicker 0.3s ease-in-out;
        }

        /* Final section - minimal effects, just slow "you" turning red */
        #test6 .progress {
            /* No animation */
        }

        #test6 .section-header {
            /* No animation */
        }

        #test6 .green-text {
            /* No distortion effects */
        }

        /* No static overlay */
        #test6::after {
            display: none;
        }

        /* No hue shift */
        #test6.active {
            /* No animation */
        }

        /* Slow "you" color flicker - cycles to red and Owen's gold */
        @keyframes youColorFlicker {
            0%, 85%, 100% { color: inherit; }
            87% { color: var(--rabbit-dead); }
            89% { color: inherit; }
            91% { color: inherit; }
            93% { color: var(--owen); }
            95% { color: inherit; }
        }

        @keyframes youSlowRed {
            0%, 90%, 100% { color: var(--green); }
            92% { color: var(--coral); }
            98% { color: var(--coral); }
        }

        .you-flicker {
            animation: youColorFlicker 35s ease-in-out infinite;
        }

        .you-dread {
            animation: youSlowRed 45s ease-in-out infinite;
        }

        .you-dread-delayed {
            animation: youSlowRed 45s ease-in-out infinite;
            animation-delay: 22s;
        }

        .you-fade-white {
            animation: youFadeWhite 8s ease-in-out forwards;
        }

        @keyframes youFadeWhite {
            0%, 30% { color: inherit; }
            100% { color: #ffffff; }
        }

        .you-glow-strong {
            color: #ffffff;
            text-shadow: 
                0 0 10px #ffffff,
                0 0 20px #ffffff,
                0 0 40px #ffffff,
                0 0 60px rgba(255, 255, 255, 0.8),
                0 0 80px rgba(255, 255, 255, 0.6);
            animation: youGlowPulse 2s ease-in-out infinite;
        }

        @keyframes youGlowPulse {
            0%, 100% { 
                text-shadow: 
                    0 0 10px #ffffff,
                    0 0 20px #ffffff,
                    0 0 40px #ffffff,
                    0 0 60px rgba(255, 255, 255, 0.8),
                    0 0 80px rgba(255, 255, 255, 0.6);
            }
            50% { 
                text-shadow: 
                    0 0 15px #ffffff,
                    0 0 30px #ffffff,
                    0 0 60px #ffffff,
                    0 0 90px rgba(255, 255, 255, 0.9),
                    0 0 120px rgba(255, 255, 255, 0.7);
            }
        }

        .glitch-active {
            /* Disabled */
        }

        /* ============ RESULT ANNOUNCEMENTS ============ */
        .result-announcement {
            text-align: center;
            padding: 24px 16px;
            margin: 20px 0;
            border: 2px solid;
            position: relative;
        }

        @media (min-width: 390px) {
            .result-announcement {
                padding: 32px 20px;
            }
        }

        .result-label {
            font-family: 'VT323', monospace;
            font-size: 0.8rem;
            letter-spacing: 4px;
            margin-bottom: 12px;
            opacity: 0.7;
        }

        @media (min-width: 390px) {
            .result-label {
                font-size: 0.9rem;
                letter-spacing: 6px;
                margin-bottom: 16px;
            }
        }

        .result-text {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            letter-spacing: 1px;
            line-height: 1.6;
        }

        @media (min-width: 390px) {
            .result-text {
                font-size: 1.4rem;
                letter-spacing: 2px;
            }
        }

        .result-failed {
            border-color: var(--coral);
            background: rgba(255, 107, 107, 0.08);
            animation: resultFailedPulse 2s ease-in-out infinite;
        }

        .result-failed .result-label {
            color: var(--coral);
        }

        .result-failed .result-text {
            color: var(--text-bright);
        }

        .result-word-failed {
            color: var(--coral);
            font-size: 1.3rem;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.8), 0 0 40px rgba(255, 107, 107, 0.5);
        }

        @media (min-width: 390px) {
            .result-word-failed {
                font-size: 1.6rem;
            }
        }

        @keyframes resultFailedPulse {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(255, 107, 107, 0.3), inset 0 0 30px rgba(255, 107, 107, 0.05);
            }
            50% { 
                box-shadow: 0 0 40px rgba(255, 107, 107, 0.5), inset 0 0 50px rgba(255, 107, 107, 0.1);
            }
        }

        .result-passed {
            border-color: var(--green);
            background: rgba(57, 255, 20, 0.08);
            animation: resultPassedPulse 2s ease-in-out infinite;
        }

        .result-passed .result-label {
            color: var(--green);
        }

        .result-passed .result-text {
            color: var(--text-bright);
        }

        .result-word-passed {
            color: var(--green);
            font-size: 1.3rem;
            text-shadow: 0 0 20px rgba(57, 255, 20, 0.8), 0 0 40px rgba(57, 255, 20, 0.5);
        }

        @media (min-width: 390px) {
            .result-word-passed {
                font-size: 1.6rem;
            }
        }

        @keyframes resultPassedPulse {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(57, 255, 20, 0.3), inset 0 0 30px rgba(57, 255, 20, 0.05);
            }
            50% { 
                box-shadow: 0 0 40px rgba(57, 255, 20, 0.5), inset 0 0 50px rgba(57, 255, 20, 0.1);
            }
        }

        .score-glitching {
            /* Disabled */
        }

        .text-corrupting {
            /* Disabled */
        }

        .glitch-letter {
            display: inline;
            animation: letterHighlight 0.4s ease;
        }

        .screen-flash {
            animation: bgFlash 0.15s ease;
        }

        .compliance-dropping .score-display {
            color: var(--coral) !important;
            animation: scoreGlitch 0.2s ease infinite;
        }

        /* ============ AMBER WARNING BANNERS ============ */
        .amber-warning {
            text-align: left;
            padding: 20px 24px;
            margin: 32px 0 20px 0;
            border: 1px solid var(--amber);
            border-left: 3px solid var(--amber);
            background: linear-gradient(135deg, rgba(255, 204, 0, 0.04) 0%, rgba(255, 204, 0, 0.01) 100%);
            font-family: 'Space Mono', monospace;
        }

        @media (min-width: 480px) {
            .amber-warning {
                padding: 24px 28px;
                margin: 40px 0 24px 0;
            }
        }
        
        .amber-warning-top-border {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 0;
            color: var(--amber);
            opacity: 0.5;
            margin-bottom: 12px;
        }
        
        .amber-warning-classification {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .amber-warning-classification-item {
            font-family: 'Space Mono', monospace;
            font-size: 0.65rem;
            letter-spacing: 1px;
            color: var(--amber);
        }
        
        .amber-warning-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 1px;
            color: var(--amber);
            opacity: 0.7;
            margin: 12px 0;
            line-height: 1.8;
        }
        
        .amber-warning-bottom-border {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 0;
            color: var(--amber);
            opacity: 0.5;
            margin: 12px 0 8px 0;
        }
        
        .amber-warning-footer {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 1px;
            color: var(--amber);
            opacity: 0.6;
        }
        
        .amber-warning-sub-message {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            color: var(--amber);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 204, 0, 0.2);
            text-align: center;
            letter-spacing: 1px;
        }

        /* Large amber warning - more prominent for skippers */
        .amber-warning-large {
            text-align: center;
            padding: 32px 24px;
            margin: 48px 0 28px 0;
            border: 2px solid var(--amber);
            background: var(--amber-glow);
            animation: warningPulse 2s ease infinite;
            box-shadow: 0 0 40px var(--amber-glow);
        }

        @media (min-width: 480px) {
            .amber-warning-large {
                padding: 40px 32px;
                margin: 56px 0 32px 0;
            }
        }

        .amber-warning-large .amber-warning-header {
            font-size: 0.7rem;
            letter-spacing: 4px;
            margin-bottom: 20px;
        }

        @media (min-width: 480px) {
            .amber-warning-large .amber-warning-header {
                font-size: 0.75rem;
                letter-spacing: 5px;
            }
        }

        .amber-warning-large .amber-warning-directive {
            font-size: 0.65rem;
            letter-spacing: 3px;
            margin-bottom: 16px;
        }

        @media (min-width: 480px) {
            .amber-warning-large .amber-warning-directive {
                font-size: 0.7rem;
                letter-spacing: 4px;
            }
        }

        .amber-warning-large .amber-warning-text {
            font-size: 0.6rem;
            letter-spacing: 4px;
            line-height: 2;
        }

        @media (min-width: 480px) {
            .amber-warning-large .amber-warning-text {
                font-size: 0.65rem;
                letter-spacing: 5px;
            }
        }

        .amber-warning-large .amber-warning-sub {
            font-size: 0.8rem;
            margin-top: 16px;
        }

        /* Amber content end marker */
        .amber-end {
            text-align: center;
            padding: 24px 16px;
            margin: 28px 0 48px 0;
            border: none;
            border-top: 1px solid var(--amber);
            background: transparent;
            opacity: 0.6;
        }

        .amber-end-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 3px;
            color: var(--amber);
            text-transform: uppercase;
            line-height: 2.2;
            opacity: 0.7;
        }

        @media (min-width: 480px) {
            .amber-end-text {
                font-size: 0.55rem;
                letter-spacing: 4px;
            }
        }

        @keyframes warningPulse {
            0%, 100% { opacity: 0.85; }
            50% { opacity: 1; }
        }

        .amber-warning-header {
            font-family: 'VT323', monospace;
            font-size: 0.65rem;
            letter-spacing: 3px;
            color: var(--amber);
            margin-bottom: 16px;
            opacity: 0.85;
        }

        @media (min-width: 480px) {
            .amber-warning-header {
                font-size: 0.7rem;
                letter-spacing: 4px;
            }
        }

        .amber-warning-directive {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 2px;
            color: var(--amber);
            text-transform: uppercase;
            line-height: 2.2;
            margin-bottom: 12px;
        }

        @media (min-width: 480px) {
            .amber-warning-directive {
                font-size: 0.65rem;
                letter-spacing: 3px;
            }
        }

        .amber-warning-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 3px;
            color: var(--amber);
            text-transform: uppercase;
            line-height: 2;
        }

        @media (min-width: 480px) {
            .amber-warning-text {
                font-size: 0.6rem;
                letter-spacing: 4px;
            }
        }

        .amber-warning-sub {
            font-family: 'Space Mono', monospace;
            font-style: italic;
            font-size: 0.75rem;
            color: var(--amber);
            margin-top: 12px;
            opacity: 0.8;
        }

        /* ============ TERMINATED / KILLED STYLING ============ */
        .c-terminated {
            color: #8b0000;
            font-weight: bold;
        }

        .termination-announcement {
            animation: terminationPulse 2s ease-in-out infinite;
        }

        @keyframes terminationPulse {
            0%, 100% { 
                opacity: 1; 
                text-shadow: none;
            }
            50% { 
                opacity: 0.6; 
                text-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
            }
        }

        /* System broadcast - a break in the wall */
        .system-broadcast {
            display: block;
            margin: 24px 0;
            padding: 16px 20px;
            background: linear-gradient(90deg, rgba(0, 212, 170, 0.05) 0%, rgba(0, 212, 170, 0.1) 50%, rgba(0, 212, 170, 0.05) 100%);
            border-left: 3px solid var(--system-green);
            border-right: 3px solid var(--system-green);
            font-family: 'VT323', monospace;
            font-size: 0.95rem;
            letter-spacing: 2px;
            color: var(--system-green);
            text-align: center;
            position: relative;
        }

        .system-broadcast::before {
            content: '▶ FACILITY BROADCAST';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-elevated);
            padding: 2px 12px;
            font-size: 0.5rem;
            letter-spacing: 3px;
            color: var(--text-dim);
        }

        .system-broadcast .employee-name {
            color: var(--catherine);
        }

        .system-broadcast .status-terminated {
            color: #8b0000;
            font-weight: bold;
        }

        @media (min-width: 480px) {
            .amber-warning-text {
                font-size: 0.6rem;
                letter-spacing: 4px;
            }
        }

        .amber-warning-sub {
            font-size: 0.65rem;
            color: var(--text-secondary);
            margin-top: 10px;
            font-style: italic;
        }

        @media (min-width: 480px) {
            .amber-warning-sub {
                font-size: 0.7rem;
                margin-top: 12px;
            }
        }

        /* ============ SUBMIT BUTTON ============ */
        .submit-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: var(--touch-target-lg);
            padding: var(--space-md) var(--space-lg);
            margin-top: var(--space-xl);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--text-secondary);
            color: var(--text-bright);
            font-family: 'Space Mono', monospace;
            font-size: 0.6875rem;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.15s ease;
            position: relative;
            overflow: hidden;
            border-radius: 2px;
            -webkit-tap-highlight-color: transparent;
            animation: btnBreathe 3s ease-in-out infinite;
        }

        @keyframes btnBreathe {
            0%, 100% { 
                box-shadow: 0 0 8px rgba(255, 255, 255, 0.1), inset 0 0 8px rgba(255, 255, 255, 0.03);
            }
            50% { 
                box-shadow: 0 0 16px rgba(255, 255, 255, 0.2), inset 0 0 12px rgba(255, 255, 255, 0.05);
            }
        }
        
        @media (min-width: 390px) {
            .submit-btn {
                font-size: 0.75rem;
                margin-top: var(--space-2xl);
            }
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.08), transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover, .submit-btn:active {
            border-color: var(--text-bright);
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-bright);
            animation: none;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.25);
        }
        
        .submit-btn:hover::before {
            left: 100%;
        }
        
        .submit-btn:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.1);
        }
        /* ============ FORWARD CHOICE ============ */
        .forward-choice-container {
            margin: var(--space-2xl) 0;
            padding: var(--space-xl) var(--space-md);
            border: 1px solid rgba(255, 200, 0, 0.3);
            background: rgba(255, 200, 0, 0.03);
            border-radius: 2px;
        }
        
        @media (min-width: 390px) {
            .forward-choice-container {
                padding: var(--space-xl) var(--space-lg);
            }
        }

        .forward-choice-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.5625rem;
            letter-spacing: 0.2em;
            color: var(--amber);
            text-align: center;
            margin-bottom: var(--space-xl);
            text-transform: uppercase;
        }
        
        @media (min-width: 390px) {
            .forward-choice-header {
                font-size: 0.625rem;
            }
        }

        .forward-choice-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        @media (min-width: 480px) {
            .forward-choice-buttons {
                flex-direction: row;
                gap: var(--space-lg);
            }
        }

        .forward-btn {
            flex: 1;
            min-height: var(--touch-target-lg);
            padding: var(--space-md) var(--space-lg);
            font-family: 'Space Mono', monospace;
            font-size: 0.6875rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
            border-radius: 2px;
            -webkit-tap-highlight-color: transparent;
            line-height: 1.6;
        }

        .forward-yes {
            background: transparent;
            border: 2px solid var(--amber);
            color: var(--amber);
        }

        .forward-yes:hover {
            background: rgba(240, 165, 0, 0.1);
            box-shadow: 0 0 20px rgba(240, 165, 0, 0.2);
        }

        .forward-owen {
            background: transparent;
            border: 2px solid var(--coral);
            color: var(--coral);
        }

        .forward-owen:hover {
            background: rgba(255, 107, 107, 0.1);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.2);
        }

        .forward-no {
            background: transparent;
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
        }

        .forward-no:hover {
            border-color: var(--text-dim);
            color: var(--text-primary);
        }

        /* ============ EASTER EGG GAMES ============ */
        .game-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
            text-align: center;
            touch-action: manipulation;
        }

        .game-page-compact {
            min-height: 100vh;
            max-height: 100vh;
            height: 100vh;
            overflow: hidden;
            justify-content: space-evenly;
            padding: var(--space-sm) var(--space-md);
        }

        .game-header {
            font-family: 'VT323', monospace;
            font-size: 0.65rem;
            color: var(--text-ghost);
            letter-spacing: 0.15em;
        }

        .game-title {
            font-family: 'VT323', monospace;
            font-size: 2rem;
            color: var(--green);
            letter-spacing: 0.1em;
            text-shadow: 0 0 20px rgba(57, 255, 20, 0.5);
        }

        #sudokuGamePage .game-title {
            color: var(--owen);
            text-shadow: 0 0 20px rgba(244, 209, 155, 0.5);
        }

        .game-subtitle {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            color: var(--text-dim);
            letter-spacing: 0.2em;
        }

        .snake-container {
            background: var(--bg-secondary);
            border: 1px solid var(--green);
            padding: 2px;
            touch-action: manipulation;
        }

        #snakeCanvas {
            display: block;
            background: #0a0a0a;
            touch-action: manipulation;
        }

        .game-score-row {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
            letter-spacing: 0.1em;
            display: flex;
            justify-content: center;
            gap: var(--space-lg);
        }

        .game-controls {
            margin: var(--space-xs) 0;
            touch-action: manipulation;
        }

        .game-controls-row {
            display: flex;
            justify-content: center;
            gap: var(--space-xs);
            margin: 2px 0;
        }

        .game-btn {
            width: 52px;
            height: 52px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .game-btn:active {
            background: var(--bg-elevated);
            border-color: var(--green);
            color: var(--green);
        }

        .game-instruction {
            font-size: 0.65rem;
            color: var(--text-ghost);
        }

        .game-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            align-items: center;
        }

        .game-restart-btn {
            font-family: 'Space Mono', monospace;
            font-size: 0.65rem;
            letter-spacing: 0.1em;
            padding: var(--space-sm) var(--space-lg);
            background: transparent;
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            animation: btnBreathe 3s ease-in-out infinite;
        }

        .game-restart-btn:hover, .game-restart-btn:active {
            border-color: var(--text-bright);
            color: var(--text-bright);
            animation: none;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
        }

        .game-menu-btn {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 0.1em;
            padding: var(--space-xs) var(--space-md);
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .game-menu-btn:hover, .game-menu-btn:active {
            border-color: var(--text-secondary);
            color: var(--text-secondary);
        }

        /* Sudoku styles */
        .sudoku-container {
            margin: var(--space-sm) 0;
        }

        .sudoku-grid {
            display: grid;
            grid-template-columns: repeat(9, 30px);
            grid-template-rows: repeat(9, 30px);
            gap: 1px;
            background: var(--border);
            border: 2px solid var(--owen);
            padding: 1px;
        }

        .sudoku-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .sudoku-cell.given {
            color: var(--text-primary);
            cursor: default;
        }

        .sudoku-cell.editable {
            color: var(--owen);
        }

        .sudoku-cell.editable:active {
            background: rgba(244, 209, 155, 0.2);
        }

        .sudoku-cell.error {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }

        .sudoku-cell.correct {
            color: var(--green);
        }

        /* 3x3 box borders */
        .sudoku-cell:nth-child(3n) { border-right: 2px solid var(--owen); }
        .sudoku-cell:nth-child(9n) { border-right: none; }
        .sudoku-cell:nth-child(n+19):nth-child(-n+27),
        .sudoku-cell:nth-child(n+46):nth-child(-n+54) { border-bottom: 2px solid var(--owen); }

        /* Sudoku popup */
        .sudoku-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .sudoku-popup.active {
            display: flex;
        }

        .sudoku-popup-content {
            background: var(--bg-primary);
            border: 1px solid var(--owen);
            padding: var(--space-lg);
            text-align: center;
        }

        .sudoku-popup-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: var(--space-md);
        }

        .sudoku-popup-btn {
            width: 60px;
            height: 60px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            font-family: 'VT323', monospace;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .sudoku-popup-btn:active {
            background: var(--owen);
            border-color: var(--owen);
            color: #000;
        }

        .sudoku-popup-clear, .sudoku-popup-cancel {
            display: block;
            width: 100%;
            padding: var(--space-sm);
            margin-top: var(--space-xs);
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .sudoku-popup-clear {
            background: transparent;
            border: 1px solid var(--owen);
            color: var(--owen);
        }

        .sudoku-popup-cancel {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
        }

        /* ============ MUSIC PLAYER STYLES (Catherine/Rabbit) ============ */
        .music-player-page .game-subtitle {
            color: var(--rabbit);
        }
        
        .music-player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            margin: var(--space-sm) 0;
            width: 100%;
            max-width: 320px;
        }
        
        /* Now Playing Display */
        .music-now-playing {
            width: 100%;
            background: rgba(255, 138, 128, 0.05);
            border: 1px solid rgba(255, 138, 128, 0.2);
            padding: var(--space-md);
            text-align: center;
        }
        
        .music-now-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            margin-bottom: var(--space-xs);
        }
        
        .music-visualizer {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 4px;
            height: 32px;
            padding: var(--space-sm) 0;
        }
        
        .viz-bar {
            width: 6px;
            height: 4px;
            background: var(--rabbit);
            opacity: 0.3;
            transition: height 0.1s ease;
        }
        
        .music-visualizer.playing .viz-bar {
            animation: vizPulse 0.4s ease-in-out infinite;
            opacity: 0.9;
        }
        
        .viz-bar:nth-child(1) { animation-delay: 0s; }
        .viz-bar:nth-child(2) { animation-delay: 0.1s; }
        .viz-bar:nth-child(3) { animation-delay: 0.05s; }
        .viz-bar:nth-child(4) { animation-delay: 0.15s; }
        .viz-bar:nth-child(5) { animation-delay: 0.08s; }
        .viz-bar:nth-child(6) { animation-delay: 0.12s; }
        .viz-bar:nth-child(7) { animation-delay: 0.03s; }
        .viz-bar:nth-child(8) { animation-delay: 0.18s; }
        
        @keyframes vizPulse {
            0%, 100% { height: 4px; }
            50% { height: 28px; }
        }
        
        .music-current-track {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--rabbit);
            letter-spacing: 0.05em;
            margin-top: var(--space-xs);
        }
        
        /* Playlist */
        .music-playlist {
            width: 100%;
            border: 1px solid var(--border);
        }
        
        .playlist-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            padding: var(--space-sm) var(--space-md);
            border-bottom: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.02);
        }
        
        .playlist-track {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }
        
        .playlist-track:last-child {
            border-bottom: none;
        }
        
        .playlist-track:hover, .playlist-track:active {
            background: rgba(255, 138, 128, 0.08);
        }
        
        .playlist-track.active {
            background: rgba(255, 138, 128, 0.12);
            border-left: 2px solid var(--rabbit);
        }
        
        .playlist-track.playing {
            background: rgba(255, 138, 128, 0.15);
        }
        
        .track-number {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-ghost);
            min-width: 20px;
        }
        
        .playlist-track.active .track-number {
            color: var(--rabbit);
        }
        
        .track-info {
            flex: 1;
            min-width: 0;
        }
        
        .track-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            color: var(--text-primary);
            letter-spacing: 0.05em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .playlist-track.active .track-title {
            color: var(--rabbit);
        }
        
        .track-artist {
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            color: var(--text-ghost);
            letter-spacing: 0.05em;
            margin-top: 2px;
        }
        
        .track-status {
            font-size: 0.7rem;
            color: var(--text-ghost);
            min-width: 16px;
            text-align: center;
        }
        
        .playlist-track.active .track-status {
            color: var(--rabbit);
        }
        
        .playlist-track.playing .track-status {
            animation: blink 1s ease-in-out infinite;
        }
        
        /* Controls */
        .music-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            margin-top: var(--space-sm);
        }
        
        .music-control-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }
        
        .music-control-btn:hover, .music-control-btn:active {
            border-color: var(--rabbit);
            color: var(--rabbit);
        }
        
        .music-play-btn {
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 138, 128, 0.1);
            border: 2px solid var(--rabbit);
            color: var(--rabbit);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }
        
        .music-play-btn:hover, .music-play-btn:active {
            background: rgba(255, 138, 128, 0.25);
            box-shadow: 0 0 20px rgba(255, 138, 128, 0.3);
        }
        
        .music-play-btn.playing {
            background: var(--rabbit);
            color: var(--bg-primary);
        }
        
        .music-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.45rem;
            letter-spacing: 0.15em;
            color: var(--text-ghost);
            text-align: center;
            margin-top: var(--space-xs);
        }

        /* Restored sudoku cell styles */
        .sudoku-cell {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .sudoku-cell.given {
            color: var(--text-primary);
            cursor: default;
        }

        .sudoku-cell.editable {
            color: var(--coral);
        }

        .sudoku-cell.selected {
            background: rgba(255, 107, 107, 0.2);
            box-shadow: inset 0 0 0 2px var(--coral);
        }

        .sudoku-cell.error {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }

        /* ============ DRAMATIC FINAL CHOICE SEQUENCE ============ */
        .final-sequence-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-lg);
            padding-top: calc(var(--space-lg) + var(--safe-top));
            padding-bottom: calc(var(--space-lg) + var(--safe-bottom));
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .final-sequence-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Corner accents like title page */
        .final-sequence-overlay::before,
        .final-sequence-overlay::after {
            content: '';
            position: fixed;
            width: 40px;
            height: 40px;
            border: 1px solid var(--border);
            opacity: 0.3;
            pointer-events: none;
        }
        
        @media (min-width: 390px) {
            .final-sequence-overlay::before,
            .final-sequence-overlay::after {
                width: 56px;
                height: 56px;
            }
        }
        
        .final-sequence-overlay::before {
            top: calc(var(--space-md) + var(--safe-top));
            left: var(--space-md);
            border-right: none;
            border-bottom: none;
        }
        
        .final-sequence-overlay::after {
            bottom: calc(var(--space-md) + var(--safe-bottom));
            right: var(--space-md);
            border-left: none;
            border-top: none;
        }
        
        .final-sequence-header {
            text-align: center;
            flex-shrink: 0;
            padding-top: var(--space-md);
        }
        
        .final-sequence-sector {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.3em;
            color: var(--text-ghost);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        
        .final-sequence-protocol {
            font-family: 'VT323', monospace;
            font-size: 0.6875rem;
            letter-spacing: 0.15em;
            color: var(--text-dim);
        }
        
        .final-sequence-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 340px;
            padding: var(--space-lg) 0;
        }
        
        .final-sequence-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.15em;
            color: var(--teal);
            text-transform: uppercase;
            margin-bottom: var(--space-lg);
            text-align: center;
            min-height: 1.2em;
        }
        
        .final-sequence-typing {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .final-sequence-typing.visible {
            opacity: 1;
        }
        
        .typing-name {
            font-family: 'Space Mono', monospace;
            font-size: 0.625rem;
            color: var(--amber);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        
        .typing-dots {
            display: flex;
            gap: 3px;
        }
        
        .typing-dot {
            width: 4px;
            height: 4px;
            background: var(--amber);
            border-radius: 50%;
            animation: typingPulse 1.2s ease-in-out infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingPulse {
            0%, 60%, 100% { opacity: 0.3; transform: scale(0.8); }
            30% { opacity: 1; transform: scale(1); }
        }
        
        /* Letter content */
        .final-sequence-letter {
            text-align: center;
            margin-bottom: var(--space-md);
            opacity: 0;
            transition: opacity 0.5s ease;
            width: 100%;
        }
        
        .final-sequence-letter.visible {
            opacity: 1;
        }
        
        .final-block-container {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }
        
        .final-block {
            position: relative;
            min-height: 70px;
            border: 1px solid var(--border);
            background: rgba(255, 200, 0, 0.02);
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        
        .final-block:hover:not(.revealed) {
            border-color: var(--amber);
            background: rgba(255, 200, 0, 0.05);
        }
        
        .final-block:active:not(.revealed) {
            transform: scale(0.98);
        }
        
        .final-block.revealed {
            border-color: rgba(255, 200, 0, 0.3);
            background: rgba(255, 200, 0, 0.03);
            cursor: default;
        }
        
        .final-block-locked {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            transition: opacity 0.3s ease;
        }
        
        .final-block.revealed .final-block-locked {
            opacity: 0;
            pointer-events: none;
        }
        
        .final-block-icon {
            font-size: 1.25rem;
            color: var(--text-dim);
            opacity: 0.5;
        }
        
        .final-block-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            text-transform: uppercase;
        }
        
        .final-block-content {
            padding: var(--space-md);
            opacity: 0;
            transform: translateY(5px);
            transition: all 0.4s ease;
        }
        
        .final-block.revealed .final-block-content {
            opacity: 1;
            transform: translateY(0);
        }
        
        .final-block-emphasis .final-letter-line {
            font-style: italic;
            color: var(--amber);
        }
        
        /* Decrypt Animation */
        .final-block.decrypting {
            pointer-events: none;
            border-color: var(--vincent);
            box-shadow: 0 0 15px rgba(77, 148, 255, 0.3);
        }
        
        .decrypt-terminal {
            padding: 8px;
            text-align: left;
        }
        
        .decrypt-line {
            font-family: 'VT323', monospace;
            font-size: 0.7rem;
            color: var(--vincent);
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            opacity: 0.8;
        }
        
        .decrypt-progress-container {
            width: 100%;
            height: 6px;
            background: rgba(77, 148, 255, 0.15);
            border: 1px solid rgba(77, 148, 255, 0.3);
            margin: 8px 0 4px 0;
            overflow: hidden;
        }
        
        .decrypt-progress-bar {
            height: 100%;
            width: 0%;
            background: var(--vincent);
            box-shadow: 0 0 8px var(--vincent);
            transition: width 0.08s linear;
        }
        
        .decrypt-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            color: var(--vincent);
            letter-spacing: 1px;
            text-align: center;
        }
        
        .final-letter-line {
            font-family: 'Space Mono', monospace;
            font-size: 0.6875rem;
            line-height: 1.7;
            color: var(--amber);
            margin-bottom: var(--space-xs);
        }
        
        .final-letter-line:last-child {
            margin-bottom: 0;
        }
        
        @media (min-width: 390px) {
            .final-letter-line {
                font-size: 0.75rem;
            }
        }
        
        .final-sequence-instruction {
            margin-bottom: var(--space-md);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .final-sequence-instruction.visible {
            opacity: 1;
        }
        
        .final-sequence-instruction.hidden {
            opacity: 0;
        }
        
        .instruction-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.15em;
            color: var(--text-ghost);
            text-transform: uppercase;
        }
        
        .final-letter-typing-container {
            display: flex;
            justify-content: center;
            align-items: baseline;
            margin: var(--space-lg) 0 var(--space-sm);
            min-height: 2.5rem;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .final-letter-typing-container.visible {
            opacity: 1;
        }
        
        .final-letter-plea {
            font-family: 'VT323', monospace;
            font-size: 2rem;
            color: #ffffff;
            font-style: italic;
            text-shadow: 
                0 0 10px rgba(255, 255, 255, 0.9),
                0 0 20px rgba(255, 255, 255, 0.7),
                0 0 40px rgba(255, 255, 255, 0.5),
                0 0 60px rgba(255, 255, 255, 0.3);
            animation: pleaGlow 2s ease-in-out infinite;
        }
        
        @keyframes pleaGlow {
            0%, 100% {
                text-shadow: 
                    0 0 10px rgba(255, 255, 255, 0.9),
                    0 0 20px rgba(255, 255, 255, 0.7),
                    0 0 40px rgba(255, 255, 255, 0.5),
                    0 0 60px rgba(255, 255, 255, 0.3);
            }
            50% {
                text-shadow: 
                    0 0 15px rgba(255, 255, 255, 1),
                    0 0 30px rgba(255, 255, 255, 0.8),
                    0 0 50px rgba(255, 255, 255, 0.6),
                    0 0 80px rgba(255, 255, 255, 0.4);
            }
        }
        
        @media (min-width: 390px) {
            .final-letter-plea {
                font-size: 2.25rem;
            }
        }
        
        .typing-cursor {
            font-family: 'VT323', monospace;
            font-size: 2rem;
            color: #ffffff;
            animation: cursorBlink 0.6s ease-in-out infinite;
            margin-left: 2px;
            opacity: 0;
        }
        
        .typing-cursor.visible {
            opacity: 1;
        }
        
        .typing-cursor.hidden {
            opacity: 0;
            animation: none;
        }
        
        @keyframes cursorBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .final-letter-signature {
            font-family: 'Space Mono', monospace;
            font-size: 0.625rem;
            color: var(--text-dim);
            font-style: italic;
            letter-spacing: 0.1em;
            opacity: 0;
            transition: opacity 0.4s ease;
            margin-top: var(--space-sm);
        }
        
        .final-letter-signature.visible {
            opacity: 0.6;
        }
        
        .final-sequence-timer-container {
            text-align: center;
            margin-bottom: var(--space-md);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .final-sequence-timer-container.visible {
            opacity: 1;
        }
        
        .final-sequence-timer-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.4375rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        
        .final-sequence-timer {
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            color: var(--text-dim);
            letter-spacing: 0.1em;
        }
        
        .final-sequence-timer.urgent {
            color: var(--coral);
            animation: timerPulse 0.5s ease-in-out infinite;
        }
        
        @keyframes timerPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .final-sequence-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            width: 100%;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.5s ease;
        }
        
        .final-sequence-buttons.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .final-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 64px;
            padding: var(--space-sm) var(--space-md);
            font-family: 'Space Mono', monospace;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            -webkit-tap-highlight-color: transparent;
            position: relative;
            overflow: hidden;
        }
        
        .final-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.5s ease;
        }
        
        .final-btn:hover::before {
            left: 100%;
        }
        
        .final-btn:active {
            transform: scale(0.98);
        }
        
        .final-btn-label {
            font-size: 0.4375rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 2px;
            opacity: 0.5;
        }
        
        .final-btn-main {
            font-size: 0.6875rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 2px;
        }
        
        .final-btn-sub {
            font-size: 0.4375rem;
            letter-spacing: 0.1em;
            opacity: 0.4;
        }
        
        .final-btn-forward {
            background: var(--owen-subtle);
            border: 2px solid var(--owen);
            color: var(--owen);
            text-shadow: 0 0 12px var(--owen-glow);
        }
        
        .final-btn-forward:hover {
            background: rgba(232, 184, 74, 0.15);
            box-shadow: 0 0 30px var(--owen-glow);
        }
        
        .final-btn-forward .final-btn-label {
            color: var(--text-dim);
        }
        
        .final-btn-submit {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
        }
        
        .final-btn-submit:hover {
            border-color: var(--border-light);
            color: var(--text-secondary);
        }
        
        .final-btn-submit .final-btn-label {
            color: var(--text-ghost);
        }
        
        .final-sequence-footer {
            text-align: center;
            flex-shrink: 0;
            padding-bottom: var(--space-sm);
        }
        
        .final-sequence-trace {
            font-family: 'Space Mono', monospace;
            font-size: 0.4375rem;
            letter-spacing: 0.1em;
            color: var(--text-ghost);
            text-transform: uppercase;
        }
        
        .final-sequence-trace-status {
            color: var(--teal);
        }
        
        .final-sequence-expired {
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .final-sequence-expired.visible {
            opacity: 1;
        }
        
        .expired-message {
            font-family: 'VT323', monospace;
            font-size: 1.125rem;
            color: var(--coral);
            letter-spacing: 0.15em;
            margin-bottom: var(--space-xs);
        }
        
        .expired-sub {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            color: var(--text-dim);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        /* ============ BREAK PAGE ============ */
        .break-page {
            text-align: center;
        }

        .break-header {
            margin-bottom: 36px;
        }

        .break-icon {
            font-size: 1.5rem;
            color: var(--text-dim);
            margin-bottom: 20px;
            animation: glowPulse 2.5s infinite;
        }

        .break-header h2 {
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: var(--text-bright);
            letter-spacing: 4px;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 400;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
        }

        .break-subtitle {
            font-size: 0.65rem;
            color: var(--text-dim);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .break-notice {
            padding: 24px;
            margin: 28px 0;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .break-notice p {
            margin: 8px 0;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .break-notice strong {
            color: var(--text-bright);
            font-weight: 400;
        }

        .break-rules {
            text-align: left;
            padding: 24px;
            margin: 28px 0;
            border-left: 2px solid var(--text-secondary);
            background: rgba(255, 255, 255, 0.03);
        }

        .rule-header {
            font-family: 'VT323', monospace;
            font-size: 0.8rem;
            color: var(--text-bright);
            letter-spacing: 3px;
            margin-bottom: 16px;
        }

        .break-rules p {
            margin: 14px 0;
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-primary);
            line-height: 1.9;
        }

        .break-rules strong {
            color: var(--text-bright);
            font-weight: 400;
        }

        .break-options {
            margin: 36px 0;
        }

        .break-options-header {
            font-family: 'VT323', monospace;
            font-size: 0.85rem;
            color: var(--text-bright);
            letter-spacing: 3px;
            margin-bottom: 20px;
            text-transform: uppercase;
            text-align: center;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .break-option {
            display: flex;
            align-items: flex-start;
            text-align: left;
            padding: 20px;
            margin: 12px 0;
            border: 2px solid var(--text-dim);
            background: rgba(255, 255, 255, 0.03);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            animation: btnBreathe 3s ease-in-out infinite;
        }

        .break-option::before {
            content: '▶';
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            color: var(--text-dim);
            transition: all 0.2s ease;
        }

        .break-option:hover {
            border-color: var(--text-bright);
            background: rgba(255, 255, 255, 0.08);
            animation: none;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.15);
        }

        .break-option:hover::before {
            color: var(--text-bright);
            transform: translateY(-50%) translateX(3px);
        }

        .break-option.selected {
            border-color: var(--text-bright);
            background: rgba(255, 255, 255, 0.1);
            animation: none;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
        }

        .break-option.selected::before {
            content: '✓';
            color: var(--text-bright);
            font-size: 1.2rem;
        }

        .break-option.selected .option-letter {
            color: var(--text-bright);
        }

        .option-letter {
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            color: var(--text-bright);
            margin-right: 16px;
            min-width: 24px;
            text-shadow: 0 0 10px rgba(248, 244, 236, 0.3);
        }

        .option-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-bright);
            letter-spacing: 1px;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .option-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .break-activity {
            margin: 36px 0;
            animation: fadeIn 0.5s ease;
        }

        .quiet-instructions {
            padding: 28px;
            margin-bottom: 28px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .quiet-instructions p {
            margin: 8px 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .break-timer-display {
            margin: 36px 0;
        }

        .timer-label {
            font-size: 0.65rem;
            color: var(--text-dim);
            letter-spacing: 3px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .timer-large {
            font-family: 'VT323', monospace;
            font-size: 3.5rem;
            color: var(--text-bright);
            letter-spacing: 8px;
        }

        .break-tip {
            margin-top: 36px;
            font-size: 0.8rem;
            color: var(--text-dim);
            font-style: italic;
            line-height: 1.9;
        }

        .story-container {
            text-align: left;
            padding: 32px 28px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .story-header {
            font-family: 'VT323', monospace;
            font-size: 0.7rem;
            color: var(--text-dim);
            letter-spacing: 2px;
            margin-bottom: 12px;
            text-align: center;
        }

        .story-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-bright);
            letter-spacing: 2px;
            margin-bottom: 28px;
            text-align: center;
            text-transform: uppercase;
        }

        .story-content {
            line-height: 2.1;
            color: var(--text-primary);
        }

        .story-content p {
            margin: 20px 0;
            font-size: 0.85rem;
        }

        @media (min-width: 480px) {
            .story-content p {
                font-size: 0.9rem;
            }
        }

        @media (min-width: 768px) {
            .story-content p {
                font-size: 0.92rem;
            }
        }

        .story-moral {
            margin-top: 32px;
            padding: 20px;
            background: var(--amber-subtle);
            border-left: 2px solid var(--amber);
            color: var(--amber);
            font-size: 0.85rem;
            line-height: 2;
        }

        @media (min-width: 480px) {
            .story-moral {
                font-size: 0.9rem;
            }
        }

        @media (min-width: 768px) {
            .story-moral {
                font-size: 0.92rem;
                line-height: 2.2;
            }
        }

        .story-moral strong {
            color: var(--amber-bright);
            font-weight: 400;
        }

        .story-footer {
            margin-top: 28px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            font-size: 0.7rem;
            color: var(--text-dim);
            text-align: center;
            line-height: 1.8;
        }

        /* Blackjack Game Styles */
        .blackjack-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .blackjack-header {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-bright);
            letter-spacing: 2px;
            text-align: center;
            margin-bottom: 8px;
        }

        .blackjack-subtitle {
            font-size: 0.65rem;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 32px;
            letter-spacing: 2px;
        }

        .blackjack-table {
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            padding: 24px;
            margin-bottom: 24px;
        }

        .dealer-section, .player-section {
            margin-bottom: 32px;
        }

        .player-section {
            margin-bottom: 0;
        }

        .hand-label {
            font-size: 0.7rem;
            color: var(--text-bright);
            letter-spacing: 2px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .cards {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            min-height: 60px;
            margin-bottom: 8px;
        }

        .card {
            background: var(--bg-primary);
            border: 1px solid var(--text-secondary);
            padding: 8px 12px;
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            color: var(--text-bright);
            min-width: 40px;
            text-align: center;
        }

        .card.hidden {
            background: var(--bg-secondary);
            color: var(--text-dim);
        }

        .hand-value {
            font-size: 0.75rem;
            color: var(--text-bright);
            letter-spacing: 1px;
        }

        .blackjack-message {
            text-align: center;
            font-size: 0.85rem;
            color: #ffffff;
            margin-bottom: 20px;
            min-height: 24px;
            letter-spacing: 1px;
        }

        .blackjack-controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 24px;
        }

        .bj-btn {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid var(--text-secondary);
            color: var(--text-bright);
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            animation: btnBreathe 3s ease-in-out infinite;
        }

        .bj-btn:focus {
            outline: none;
        }

        .bj-btn:hover, .bj-btn:active {
            border-color: var(--text-bright);
            background: rgba(255, 255, 255, 0.1);
            animation: none;
            box-shadow: 0 0 15px rgba(216, 196, 168, 0.3);
        }

        .bj-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            animation: none;
        }

        .blackjack-stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            font-size: 0.7rem;
            color: var(--text-secondary);
            letter-spacing: 1px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
        }

        .blackjack-stats span {
            font-family: 'VT323', monospace;
        }

        /* Training Module */
        .training-container {
            text-align: left;
            padding: 24px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .training-header {
            font-family: 'VT323', monospace;
            font-size: 0.8rem;
            color: var(--system-green);
            letter-spacing: 2px;
            margin-bottom: 8px;
        }

        .training-title {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            color: var(--text-bright);
            letter-spacing: 3px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .training-content {
            font-size: 0.85rem;
            line-height: 2;
            color: var(--text-primary);
        }

        @media (min-width: 480px) {
            .training-content {
                font-size: 0.9rem;
            }
        }

        @media (min-width: 768px) {
            .training-content {
                font-size: 0.92rem;
                line-height: 2.2;
            }
        }

        .training-intro {
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 20px;
        }

        .training-section {
            margin-bottom: 24px;
        }

        .training-section-header {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-bright);
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        .training-list {
            margin: 12px 0 12px 20px;
            padding: 0;
        }

        .training-list li {
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        .training-content em {
            color: var(--text-bright);
            font-style: italic;
        }

        .training-footer {
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-dim);
            font-size: 0.8rem;
        }

        .training-completion {
            margin-top: 20px;
            padding: 16px;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid var(--system-green);
            text-align: center;
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--system-green);
            letter-spacing: 1px;
        }

        .break-timer-section {
            margin: 36px 0;
            padding: 24px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .break-timer-small {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--text-bright);
            letter-spacing: 2px;
            margin-bottom: 16px;
        }

        .end-break-btn {
            padding: 12px 20px;
            background: transparent;
            border: 1px solid var(--text-bright);
            color: var(--text-bright);
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: btnBreathe 3s ease-in-out infinite;
        }

        .end-break-btn:hover, .end-break-btn:active {
            border-color: var(--coral);
            color: var(--coral);
            background: rgba(255, 107, 107, 0.1);
            animation: none;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        /* Break Over Screen */
        .break-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .break-over-content {
            text-align: center;
            max-width: 500px;
        }

        .break-over-icon {
            font-size: 2rem;
            color: var(--text-bright);
            margin-bottom: 24px;
            animation: glowPulse 2s infinite;
        }

        .break-over-content h2 {
            font-family: 'Space Mono', monospace;
            font-size: 1.2rem;
            letter-spacing: 4px;
            color: var(--text-bright);
            margin-bottom: 24px;
            text-transform: uppercase;
        }

        .break-over-message {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 2;
            margin-bottom: 32px;
        }

        @media (min-width: 480px) {
            .break-over-message {
                font-size: 0.9rem;
            }
        }

        @media (min-width: 768px) {
            .break-over-message {
                font-size: 0.92rem;
                line-height: 2.2;
            }
        }

        .break-over-message strong {
            color: var(--text-bright);
            display: block;
            margin-top: 16px;
            letter-spacing: 2px;
        }

        /* Warning modal */
        .break-warning-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .warning-modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--text-secondary);
            padding: 32px;
            max-width: 420px;
            width: 100%;
            text-align: left;
        }

        .warning-modal-content.monitoring-failure {
            border-color: var(--amber);
            text-align: center;
        }

        .warning-modal-header {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            color: var(--text-bright);
            letter-spacing: 4px;
            margin-bottom: 24px;
            text-align: center;
        }

        .monitoring-failure .warning-modal-header {
            color: var(--amber);
            text-shadow: 0 0 15px rgba(255, 200, 0, 0.5);
            animation: pulse 2s ease-in-out infinite;
        }

        .monitoring-notice-main {
            font-size: 1rem !important;
            color: var(--text-bright) !important;
            margin-bottom: 24px !important;
        }

        .monitoring-status-list {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border-light);
            padding: 16px;
            margin: 20px 0;
            text-align: left;
        }

        .monitoring-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
        }

        .monitoring-item:last-child {
            border-bottom: none;
        }

        .monitoring-label {
            color: var(--text-secondary);
        }

        .monitoring-value {
            letter-spacing: 1px;
        }

        .monitoring-value.offline {
            color: var(--text-dim);
            text-shadow: none;
        }

        .monitoring-notice-sub {
            font-size: 0.8rem !important;
            color: var(--text-dim) !important;
            margin: 20px 0 !important;
        }

        .redacted-inline {
            background: var(--text-dim);
            color: var(--text-dim);
            padding: 0 4px;
            letter-spacing: -1px;
        }

        .monitoring-notice-warning {
            font-size: 0.85rem !important;
            color: var(--text-bright) !important;
            margin-top: 20px !important;
            line-height: 1.6 !important;
        }

        .warning-modal-content p {
            margin: 14px 0;
            color: var(--text-primary);
            font-size: 0.85rem;
            line-height: 1.8;
        }

        .warning-modal-content ul {
            margin: 14px 0 14px 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .warning-modal-content li {
            margin: 6px 0;
            opacity: 0.85;
        }

        .warning-modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 28px;
        }

        @media (min-width: 400px) {
            .warning-modal-buttons {
                flex-direction: row;
            }
        }

        .modal-btn {
            flex: 1;
            padding: 14px 16px;
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-cancel {
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
        }

        .modal-btn-cancel:hover {
            border-color: var(--text-secondary);
            color: var(--text-primary);
        }

        .modal-btn-confirm {
            background: transparent;
            border: 1px solid var(--text-bright);
            color: var(--text-bright);
        }

        .modal-btn-confirm:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* ============ TERMINATION OVERLAY ============ */
        .termination-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            opacity: 0;
            transition: opacity 2s ease;
        }

        .termination-text {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10001;
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            color: var(--green);
            text-align: center;
            letter-spacing: 3px;
            line-height: 1.8;
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Subject File Page - matches title page aesthetic */
        .subject-file-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            min-height: 100vh;
            padding: var(--space-xl);
            padding-top: calc(var(--space-xl) + var(--safe-top));
            padding-bottom: calc(var(--space-xl) + var(--safe-bottom));
            position: relative;
            animation: fadeInSlow 0.8s ease;
        }
        
        .subject-file-corner {
            position: absolute;
            width: 48px;
            height: 48px;
            border: 1px solid var(--border);
            opacity: 0.3;
        }
        
        @media (min-width: 390px) {
            .subject-file-corner {
                width: 64px;
                height: 64px;
            }
        }
        
        .subject-file-corner-tl {
            top: calc(var(--space-lg) + var(--safe-top));
            left: var(--space-lg);
            border-right: none;
            border-bottom: none;
        }
        
        .subject-file-corner-br {
            bottom: calc(var(--space-lg) + var(--safe-bottom));
            right: var(--space-lg);
            border-left: none;
            border-top: none;
        }
        
        .subject-file-header {
            text-align: center;
        }
        
        .subject-file-sector {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.3em;
            color: var(--text-ghost);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        
        .subject-file-protocol {
            font-family: 'VT323', monospace;
            font-size: 0.75rem;
            letter-spacing: 0.15em;
            color: var(--text-dim);
        }
        
        .subject-file-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 320px;
        }
        
        .subject-file-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.15em;
            color: var(--teal);
            text-transform: uppercase;
            margin-bottom: var(--space-xl);
            transition: color 0.3s ease;
        }
        
        .subject-file-card {
            width: 100%;
            border: 1px solid var(--border);
            background: rgba(139, 0, 0, 0.03);
            padding: var(--space-lg);
        }
        
        .subject-file-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.4375rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        
        .subject-file-name {
            font-family: 'VT323', monospace;
            font-size: 1.75rem;
            color: var(--coral);
            letter-spacing: 0.1em;
            margin-bottom: var(--space-md);
        }
        
        .subject-file-divider {
            height: 1px;
            background: var(--border);
            margin: var(--space-md) 0;
            opacity: 0.5;
        }
        
        .subject-file-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-sm);
        }
        
        .subject-file-key {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 0.1em;
            color: var(--text-dim);
            text-transform: uppercase;
        }
        
        .subject-file-value {
            font-family: 'Space Mono', monospace;
            font-size: 0.5625rem;
            letter-spacing: 0.1em;
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        
        .subject-file-danger {
            color: #8b0000;
        }
        
        .subject-file-dim {
            color: var(--text-ghost);
        }
        
        .subject-file-verdict {
            text-align: center;
            margin-top: var(--space-sm);
        }
        
        .subject-file-verdict-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.4375rem;
            letter-spacing: 0.2em;
            color: var(--text-ghost);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        
        .subject-file-verdict-value {
            font-family: 'VT323', monospace;
            font-size: 1.25rem;
            color: #8b0000;
            letter-spacing: 0.15em;
        }
        
        .subject-file-footer {
            text-align: center;
        }
        
        .subject-file-trace {
            font-family: 'Space Mono', monospace;
            font-size: 0.4375rem;
            letter-spacing: 0.1em;
            color: var(--text-ghost);
            text-transform: uppercase;
        }

        @media (min-width: 480px) {
            .subject-file-name {
                font-size: 2rem;
            }
            
            .subject-file-verdict-value {
                font-size: 1.5rem;
            }
        }

        .ending-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 48px 24px;
            text-align: center;
        }

        /* New ending page - matches title page */
        .ending-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 48px 24px;
            text-align: center;
            animation: fadeInSlow 1s ease;
        }

        @keyframes fadeInSlow {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .ending-logo {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 6px;
            color: var(--text-secondary);
            margin-bottom: 48px;
            text-transform: uppercase;
        }

        @media (min-width: 480px) {
            .ending-logo {
                font-size: 0.65rem;
                letter-spacing: 8px;
            }
        }

        .ending-main {
            font-family: 'VT323', monospace;
            font-size: 2.2rem;
            letter-spacing: 6px;
            color: #ffffff;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        @media (min-width: 480px) {
            .ending-main {
                font-size: 3rem;
                letter-spacing: 8px;
            }
        }

        @media (min-width: 768px) {
            .ending-main {
                font-size: 3.8rem;
                letter-spacing: 10px;
            }
        }

        .ending-form {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 3px;
            color: var(--text-secondary);
            margin-bottom: 40px;
        }

        @media (min-width: 480px) {
            .ending-form {
                font-size: 0.65rem;
                letter-spacing: 4px;
            }
        }

        .ending-divider-line {
            width: 48px;
            height: 1px;
            background: var(--text-ghost);
            margin: 32px 0;
        }

        .ending-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .ending-status {
            font-family: 'VT323', monospace;
            font-size: 0.85rem;
            letter-spacing: 3px;
            color: var(--text-secondary);
        }

        @media (min-width: 480px) {
            .ending-status {
                font-size: 0.95rem;
                letter-spacing: 4px;
            }
        }

        .ending-verdict-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 2px;
            color: var(--text-dim);
        }

        @media (min-width: 480px) {
            .ending-verdict-text {
                font-size: 0.55rem;
                letter-spacing: 3px;
            }
        }

        .ending-attribution-block {
            margin-top: 16px;
        }

        .ending-title-credit {
            font-family: 'VT323', monospace;
            font-size: 1.4rem;
            letter-spacing: 4px;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .ending-title-credit .rabbit-word {
            color: var(--rabbit);
        }

        @media (min-width: 480px) {
            .ending-title-credit {
                font-size: 1.8rem;
                letter-spacing: 6px;
            }
        }

        .ending-author {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 2px;
            color: var(--text-dim);
        }

        @media (min-width: 480px) {
            .ending-author {
                font-size: 0.6rem;
                letter-spacing: 3px;
            }
        }

        .ending-restart {
            margin-top: 48px;
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 3px;
            color: var(--text-ghost);
            cursor: pointer;
            padding: 12px 24px;
            border: 1px solid var(--text-ghost);
            transition: all 0.3s ease;
        }

        .ending-restart:hover {
            color: var(--text-secondary);
            border-color: var(--text-secondary);
        }

        /* Owen login button styling */
        .ending-restart.owen-login {
            margin-top: 48px;
            padding: 20px 28px;
            border: 1px solid rgba(244, 209, 155, 0.4);
            background: rgba(244, 209, 155, 0.03);
            text-align: center;
        }

        .ending-restart.owen-login:hover {
            background: rgba(244, 209, 155, 0.08);
            border-color: var(--owen);
        }

        .ending-restart.owen-login .login-prompt {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 2px;
            color: var(--text-dim);
            margin-bottom: 10px;
        }

        .ending-restart.owen-login .login-user {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
            color: var(--owen);
            margin-bottom: 2px;
        }

        .ending-restart.owen-login .login-id {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin-bottom: 14px;
        }

        .ending-restart.owen-login .login-action {
            font-family: 'VT323', monospace;
            font-size: 0.85rem;
            letter-spacing: 3px;
            color: var(--text-ghost);
            transition: color 0.3s ease;
        }

        .ending-restart.owen-login:hover .login-action {
            color: var(--owen);
        }

        /* Larger Owen login box - cut off at bottom, glowing */
        .ending-restart.owen-login-large {
            margin-top: 60px;
            padding: 24px 60px;
            border: 2px solid rgba(244, 209, 155, 0.6);
            background: rgba(244, 209, 155, 0.05);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: owenBoxGlow 2s ease-in-out infinite;
            box-shadow: 
                0 0 25px rgba(244, 209, 155, 0.25),
                0 0 50px rgba(244, 209, 155, 0.15),
                inset 0 0 30px rgba(244, 209, 155, 0.05);
            position: relative;
            min-width: 280px;
        }

        @keyframes owenBoxGlow {
            0%, 100% {
                box-shadow: 
                    0 0 25px rgba(244, 209, 155, 0.25),
                    0 0 50px rgba(244, 209, 155, 0.15),
                    inset 0 0 30px rgba(244, 209, 155, 0.05);
                border-color: rgba(244, 209, 155, 0.6);
            }
            50% {
                box-shadow: 
                    0 0 40px rgba(244, 209, 155, 0.4),
                    0 0 70px rgba(244, 209, 155, 0.25),
                    inset 0 0 40px rgba(244, 209, 155, 0.08);
                border-color: rgba(244, 209, 155, 1);
            }
        }

        .ending-restart.owen-login-large:hover {
            background: rgba(244, 209, 155, 0.12);
            border-color: var(--owen);
            box-shadow: 
                0 0 50px rgba(244, 209, 155, 0.4),
                0 0 80px rgba(244, 209, 155, 0.2);
            animation: none;
        }

        .login-prompt-large {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 2px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .login-divider {
            font-family: monospace;
            font-size: 0.7rem;
            color: var(--text-ghost);
            margin: 16px 0;
            letter-spacing: 2px;
        }

        .login-user-large {
            font-family: 'VT323', monospace;
            font-size: 1.6rem;
            letter-spacing: 3px;
            color: var(--owen);
            margin-bottom: 6px;
            text-shadow: 0 0 20px rgba(244, 209, 155, 0.3);
        }

        .login-id-large {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 1px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .login-action-large {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            letter-spacing: 4px;
            color: var(--owen);
            transition: all 0.3s ease;
            animation: authenticatePulse 2s ease-in-out infinite;
            text-shadow: 0 0 10px rgba(244, 209, 155, 0.4);
        }
        
        @keyframes authenticatePulse {
            0%, 100% {
                color: var(--owen);
                text-shadow: 0 0 10px rgba(244, 209, 155, 0.4);
            }
            50% {
                color: #fff;
                text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 25px rgba(244, 209, 155, 0.5);
            }
        }

        .ending-restart.owen-login-large:hover .login-action-large {
            color: #fff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            animation: none;
        }

        @media (min-width: 480px) {
            .ending-restart.owen-login-large {
                padding: 40px 60px;
            }
            
            .login-user-large {
                font-size: 1.8rem;
            }
            
            .login-action-large {
                font-size: 1.2rem;
            }
        }

        @media (min-width: 480px) {
            .ending-restart {
                font-size: 0.65rem;
                letter-spacing: 4px;
            }
            
            .ending-restart.owen-login .login-prompt {
                font-size: 0.55rem;
                letter-spacing: 3px;
            }
            
            .ending-restart.owen-login .login-user {
                font-size: 1.3rem;
            }
            
            .ending-restart.owen-login .login-id {
                font-size: 0.55rem;
                letter-spacing: 2px;
            }
            
            .ending-restart.owen-login .login-action {
                font-size: 0.9rem;
            }
        }

        .ending-verdict {
            font-family: 'VT323', monospace;
            font-size: 2rem;
            letter-spacing: 8px;
            color: var(--green);
            margin-bottom: 16px;
            line-height: 1.3;
        }

        /* ============ OWEN'S DEDICATED READING PAGE ============ */
        .owen-reading-page {
            min-height: 100vh;
            padding: 16px;
            max-width: 700px;
            margin: 0 auto;
            background: linear-gradient(180deg, var(--bg-primary) 0%, #0a0c0e 100%);
        }

        /* ============ OWEN BOOT SEQUENCE ============ */
        .owen-boot-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 100000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 1s ease;
        }

        .owen-boot-overlay.fading {
            opacity: 0;
        }

        .boot-terminal {
            width: 90%;
            max-width: 500px;
            max-height: 70vh;
            overflow-y: auto;
            padding: 24px;
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .boot-line {
            opacity: 0;
            animation: bootLineAppear 0.1s ease forwards;
            margin-bottom: 4px;
        }

        @keyframes bootLineAppear {
            to { opacity: 1; }
        }

        .boot-name {
            color: var(--owen);
            font-size: 1rem;
            text-shadow: 0 0 12px var(--owen-glow);
        }

        .boot-progress {
            color: var(--text-dim);
            letter-spacing: 2px;
        }

        .boot-warning {
            color: var(--rabbit);
            text-shadow: 0 0 10px var(--rabbit-glow);
        }

        .boot-glitch {
            color: var(--text-ghost);
            font-style: italic;
            font-size: 0.65rem;
            letter-spacing: 4px;
            text-transform: lowercase;
            animation: bootGlitch 0.2s ease infinite;
        }

        @keyframes bootGlitch {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        .boot-success {
            color: var(--freedom);
            text-shadow: 0 0 10px var(--freedom-glow);
        }

        /* System boot specific styles */
        .boot-system-online {
            color: var(--facility);
            text-shadow: 0 0 8px var(--facility-glow);
        }
        
        .boot-system-offline {
            color: var(--vincent);
            text-shadow: 0 0 10px var(--vincent-glow);
        }
        
        .boot-online-text {
            color: var(--facility);
            text-shadow: 0 0 8px var(--facility-glow);
        }
        
        .boot-offline-text {
            color: var(--vincent);
            text-shadow: 0 0 10px var(--vincent-glow);
        }
        
        .boot-terminal-id {
            color: var(--text-dim);
            font-size: 0.65rem;
            letter-spacing: 3px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .boot-section-header {
            color: var(--text-ghost);
            font-size: 0.6rem;
            letter-spacing: 2px;
            margin-top: 16px;
            margin-bottom: 8px;
        }
        
        .boot-name-generic {
            color: var(--text-bright);
            text-shadow: 0 0 8px var(--facility-glow);
        }
        
        .boot-vincent-name {
            color: var(--vincent);
            text-shadow: 0 0 12px var(--vincent-glow);
        }
        
        .boot-status-line {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }
        
        .boot-status-label {
            color: var(--text-dim);
        }
        
        .boot-status-value {
            color: var(--facility);
            text-shadow: 0 0 6px var(--facility-glow);
        }
        
        .boot-status-value.offline {
            color: var(--vincent);
            text-shadow: 0 0 8px var(--vincent-glow);
        }
        
        .boot-error {
            color: var(--rabbit);
            text-shadow: 0 0 8px var(--rabbit-glow);
            animation: bootErrorFlash 0.5s ease;
        }
        
        @keyframes bootErrorFlash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .boot-ready {
            color: var(--facility);
            font-size: 0.9rem;
            letter-spacing: 3px;
            margin-top: 20px;
            text-shadow: 0 0 15px var(--facility-glow);
        }

        .owen-header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(232, 184, 74, 0.15);
            margin-bottom: 40px;
        }

        .owen-header-name {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
            color: var(--owen);
            text-shadow: 0 0 20px var(--owen-glow);
        }

        .owen-header-id {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 2px;
            color: var(--text-dim);
            margin-top: 4px;
        }

        .owen-title-section {
            text-align: center;
            padding: 40px 0;
        }

        .owen-logo {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 6px;
            color: var(--text-dim);
            margin-bottom: 24px;
            opacity: 0.6;
        }

        .owen-main-title {
            font-family: 'VT323', monospace;
            font-size: 2.5rem;
            letter-spacing: 6px;
            color: #ffffff;
            line-height: 1.2;
            margin-bottom: 12px;
            text-shadow: 0 0 40px rgba(255, 255, 255, 0.1);
        }

        .owen-subtitle {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 4px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .owen-access {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            letter-spacing: 2px;
            color: var(--owen);
            text-shadow: 0 0 15px rgba(244, 209, 155, 0.4);
        }

        .owen-access-sub {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 3px;
            color: var(--green);
            margin-top: 8px;
            opacity: 0.8;
        }

        .owen-access-header {
            text-align: center;
        }

        .owen-access-bright {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            letter-spacing: 3px;
            color: #fff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.6), 0 0 40px rgba(244, 209, 155, 0.4);
        }

        .owen-access-sub-bright {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 3px;
            color: var(--green);
            margin-top: 12px;
            text-shadow: 0 0 15px rgba(0, 212, 170, 0.5);
        }

        @media (min-width: 480px) {
            .owen-access-bright {
                font-size: 1.3rem;
                letter-spacing: 4px;
            }
            
            .owen-access-sub-bright {
                font-size: 0.7rem;
            }
        }

        .owen-scroll-prompt {
            text-align: center;
            animation: scrollPulse 2s ease-in-out infinite;
        }

        .scroll-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            letter-spacing: 4px;
            color: #fff;
            margin-bottom: 12px;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .scroll-arrow {
            font-size: 1.5rem;
            color: #fff;
            animation: arrowBounce 1.5s ease-in-out infinite;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        @keyframes scrollPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        @keyframes arrowBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(8px); }
        }

        .owen-divider {
            text-align: center;
            color: var(--text-ghost);
            margin: 60px 0;
            font-family: monospace;
            letter-spacing: 2px;
            opacity: 0.3;
        }

        .owen-section {
            margin: 60px 0;
        }

        .owen-section-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            letter-spacing: 3px;
            color: var(--amber);
            margin-bottom: 24px;
            text-align: center;
            opacity: 0.7;
        }

        .owen-letter {
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            font-size: 0.9rem;
            line-height: 2.2;
            letter-spacing: 0.5px;
            color: var(--vincent);
            padding: 24px 16px;
            background: linear-gradient(135deg, var(--vincent-subtle) 0%, rgba(143, 164, 184, 0.02) 100%);
            border-left: 2px solid var(--vincent);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 0 0 60px var(--vincent-subtle);
        }

        .owen-letter .cutoff {
            display: block;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(143, 164, 184, 0.15);
        }

        /* ============ OWEN PAGE PULSATING EFFECT ============ */
        /* Apply oscillating Vincent-blue-to-Facility-white effect */
        /* Exclude: title section and credits */
        
        @keyframes owenVincentPulse {
            0%, 100% {
                color: var(--vincent);
                text-shadow: 0 0 12px var(--vincent-glow);
            }
            50% {
                color: var(--facility);
                text-shadow: 0 0 20px var(--facility-glow), 0 0 40px rgba(255, 255, 255, 0.15);
            }
        }
        
        /* Inverse pulse - starts white, goes to Vincent blue (opposite of main pulse) */
        @keyframes owenInversePulse {
            0%, 100% {
                color: var(--facility);
                text-shadow: 0 0 20px var(--facility-glow), 0 0 40px rgba(255, 255, 255, 0.15);
            }
            50% {
                color: var(--vincent);
                text-shadow: 0 0 12px var(--vincent-glow);
            }
        }
        
        /* Class for inverse pulsing text */
        .inverse-pulse {
            animation: owenInversePulse 8s ease-in-out infinite !important;
        }

        @keyframes owenBorderPulse {
            0%, 100% {
                border-color: var(--vincent);
                box-shadow: inset 0 0 60px var(--vincent-subtle);
            }
            50% {
                border-color: rgba(255, 255, 255, 0.5);
                box-shadow: inset 0 0 60px var(--facility-soft);
            }
        }

        /* Owen sections - everything pulses from Vincent blue to Facility white */
        #owenPage .owen-section,
        #owenPage .owen-section *,
        #owenPage .owen-section-header,
        #owenPage .owen-letter,
        #owenPage .owen-letter *,
        #owenPage .owen-divider,
        #owenPage .owen-interstitial,
        #owenPage .owen-interstitial *,
        #owenPage .owen-cohen-box,
        #owenPage .owen-cohen-box *,
        #owenPage .interstitial-quote,
        #owenPage .interstitial-quote *,
        #owenPage .filler-text,
        #owenPage .c-rabbit,
        #owenPage .c-catherine,
        #owenPage .c-owen,
        #owenPage .c-vincent,
        #owenPage .c-warm,
        #owenPage .c-ice,
        #owenPage .c-cold,
        #owenPage .c-emphasis,
        #owenPage .c-jokeguy,
        #owenPage .c-system,
        #owenPage .c-terminated,
        #owenPage .lyrics,
        #owenPage .cutoff,
        #owenPage .you-glow-strong,
        #owenPage .you-fade-white {
            animation: owenVincentPulse 8s ease-in-out infinite;
        }

        /* Border pulsing for containers */
        #owenPage .owen-letter {
            animation: owenVincentPulse 8s ease-in-out infinite, owenBorderPulse 8s ease-in-out infinite;
        }

        /* Dividers pulse too */
        #owenPage .owen-divider {
            animation: owenVincentPulse 8s ease-in-out infinite;
        }

        /* ============ CATHERINE SECTION - NO PULSE, STAYS CORAL ============ */
        #owenPage .catherine-section,
        #owenPage .catherine-section *,
        #owenPage .catherine-section .owen-section-header,
        #owenPage .catherine-section .owen-letter,
        #owenPage .catherine-section .catherine-letter,
        #owenPage .catherine-section .catherine-letter *,
        #owenPage .catherine-section .c-rabbit,
        #owenPage .catherine-section .cutoff,
        #owenPage .catherine-section span {
            animation: none !important;
            color: var(--rabbit) !important;
            text-shadow: 0 0 10px rgba(255, 138, 128, 0.4) !important;
        }

        #owenPage .catherine-letter {
            animation: none !important;
            border-left-color: var(--rabbit) !important;
            box-shadow: inset 0 0 60px rgba(255, 138, 128, 0.03) !important;
        }

        .owen-cohen-box {
            padding: 40px;
            background: linear-gradient(135deg, rgba(255, 180, 162, 0.04) 0%, rgba(255, 180, 162, 0.01) 100%);
            border: 1px solid rgba(255, 180, 162, 0.15);
            border-radius: 4px;
        }

        .owen-cohen-title {
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            letter-spacing: 4px;
            color: var(--rabbit);
            margin-bottom: 24px;
            text-align: center;
            text-shadow: 0 0 20px rgba(255, 180, 162, 0.3);
        }

        .owen-cohen-content {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            line-height: 2.2;
            letter-spacing: 0.5px;
            color: var(--amber);
        }

        .owen-cohen-content p {
            margin-bottom: 16px;
        }

        .owen-cohen-footer {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            letter-spacing: 2px;
            color: var(--text-dim);
            margin-top: 24px;
            text-align: center;
            opacity: 0.6;
        }

        .owen-green-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            line-height: 2.2;
            letter-spacing: 0.5px;
            color: var(--teal);
            padding: 40px;
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.04) 0%, rgba(0, 212, 170, 0.01) 100%);
            border-left: 2px solid var(--teal);
            border-radius: 0 4px 4px 0;
            text-shadow: 0 0 30px rgba(0, 212, 170, 0.1);
        }

        .censored-message {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--text-ghost);
            padding: 20px;
            margin: 20px 0;
        }

        .censored-header {
            color: var(--text-secondary);
            line-height: 1.8;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--text-ghost);
            margin-bottom: 15px;
        }

        .censored-body {
            color: var(--text-dim);
            line-height: 2;
        }

        .redacted-block {
            background: var(--redacted);
            color: var(--redacted);
            padding: 0 4px;
            border-radius: 2px;
        }

        .owen-final-moment {
            text-align: center;
            padding: 20px;
        }

        .final-moment-text {
            font-family: 'Space Mono', monospace;
            font-style: italic;
            font-size: 1rem;
            line-height: 2.2;
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .final-moment-line {
            font-family: 'Space Mono', monospace;
            font-style: italic;
            font-size: 1.1rem;
            color: var(--owen);
            opacity: 0.5;
            letter-spacing: 0.5px;
        }

        .owen-interstitial {
            text-align: center;
            padding: 40px 20px;
        }

        .interstitial-text {
            font-family: 'Space Mono', monospace;
            font-style: italic;
            font-size: 1.1rem;
            color: var(--owen);
            opacity: 0.5;
            letter-spacing: 1px;
            text-shadow: 0 0 40px rgba(244, 209, 155, 0.15);
        }

        .interstitial-quote {
            font-family: 'Space Mono', monospace;
            font-style: italic;
            font-size: 1.2rem;
            color: var(--text-secondary);
            opacity: 0.5;
            letter-spacing: 0.5px;
        }

        .owen-ending {
            text-align: center;
            padding: 60px 0;
        }

        .owen-blackjack-container {
            margin-top: 30px;
            padding: 24px;
            background: linear-gradient(135deg, rgba(240, 165, 0, 0.03) 0%, rgba(240, 165, 0, 0.01) 100%);
            border: 1px solid rgba(240, 165, 0, 0.15);
            border-radius: 4px;
        }

        /* ============ ELEVATOR DESCENT EFFECT ============ */
        .elevator-descent {
            position: relative;
        }

        .elevator-spacer {
            height: 70vh;
        }

        .elevator-spacer-large {
            height: 100vh;
        }

        .elevator-marker {
            text-align: center;
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 4px;
            color: var(--text-ghost);
            opacity: 0.5;
            padding: 20px 0;
        }

        .elevator-marker.floor-indicator {
            font-family: 'VT323', monospace;
            font-size: 1rem;
            letter-spacing: 2px;
            color: var(--green);
        }

        .white-fade-zone {
            position: relative;
            background: linear-gradient(to bottom, 
                var(--bg-primary) 0%,
                rgba(255,255,255,0.1) 30%,
                rgba(255,255,255,0.4) 60%,
                rgba(255,255,255,0.8) 85%,
                #ffffff 100%
            );
        }

        .white-room-ending {
            background: #ffffff;
            padding: 100px 20px;
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 60;
        }

        .white-room-ending .ending-attribution-block {
            text-align: center;
        }

        .white-room-ending .ending-title-credit {
            color: #000 !important;
            font-size: 1.8rem;
        }

        .white-room-ending .ending-title-credit span {
            color: #000 !important;
        }
        
        /* Rabbit slowly cycles to Catherine's color */
        .white-room-ending .ending-title-credit .rabbit-memory {
            animation: rabbitMemory 8s ease-in-out infinite;
        }
        
        @keyframes rabbitMemory {
            0%, 30% {
                color: #000;
            }
            50%, 80% {
                color: var(--rabbit);
            }
            100% {
                color: #000;
            }
        }

        .white-room-ending .ending-author {
            color: #333 !important;
        }

        /* White overlay that fades in during descent */
        .owen-white-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ffffff;
            pointer-events: none;
            opacity: 0;
            z-index: 50;
            transition: opacity 0.3s ease;
        }

        @media (min-width: 480px) {
            .owen-reading-page {
                padding: 40px;
            }

            .owen-main-title {
                font-size: 3rem;
                letter-spacing: 8px;
            }

            .owen-letter {
                font-size: 1.15rem;
                padding: 32px;
            }
            
            .white-room-ending .ending-title-credit {
                font-size: 2.2rem;
            }
        }

        @media (min-width: 480px) {
            .ending-verdict {
                font-size: 2.6rem;
                letter-spacing: 10px;
            }
        }

        .ending-subtext {
            font-family: 'VT323', monospace;
            font-size: 0.95rem;
            letter-spacing: 4px;
            color: var(--green);
            opacity: 0.6;
            margin-bottom: 64px;
        }

        .ending-message {
            font-size: 0.9rem;
            color: var(--text-dim);
            line-height: 2.2;
            margin-bottom: 80px;
            max-width: 280px;
        }

        .ending-divider {
            width: 48px;
            height: 1px;
            background: var(--border);
            margin-bottom: 40px;
        }

        .ending-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            letter-spacing: 4px;
            color: var(--amber);
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .ending-attribution {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-dim);
            opacity: 0.5;
            letter-spacing: 1px;
        }

        /* ============ REPORT BUTTON - HIGHLY VISIBLE ============ */
        .report-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--coral);
            color: var(--coral);
            font-family: 'VT323', monospace;
            font-size: 0.75rem;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            opacity: 0.7;
        }

        .report-btn:hover {
            background: var(--coral);
            color: #ffffff;
            opacity: 1;
        }

        .report-btn:active {
            transform: scale(0.98);
        }

        /* Watermark */
        .watermark {
            position: fixed;
            bottom: 16px;
            left: 20px;
            font-family: 'VT323', monospace;
            font-size: 0.65rem;
            color: var(--text-dim);
            opacity: 0.2;
            letter-spacing: 2px;
            z-index: 100;
            pointer-events: none;
        }

        @media (max-width: 400px) {
            .watermark {
                display: none;
            }
        }

        .report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.94);
            z-index: 10001;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .report-modal.active {
            display: flex;
        }

        .report-modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 32px;
            max-width: 480px;
            width: 100%;
            position: relative;
        }

        .report-modal-header {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            letter-spacing: 3px;
            color: var(--text-bright);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .report-modal-subtext {
            font-size: 0.7rem;
            color: var(--text-dim);
            margin-bottom: 28px;
            line-height: 1.8;
        }

        .report-textarea {
            width: 100%;
            min-height: 140px;
            padding: 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            resize: vertical;
            margin-bottom: 24px;
        }

        .report-textarea:focus {
            outline: none;
            border-color: var(--border-light);
        }

        .report-textarea::placeholder {
            color: var(--text-dim);
            opacity: 0.5;
        }

        .report-email-section {
            margin-bottom: 20px;
        }

        .report-email-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: block;
            letter-spacing: 1px;
        }

        .report-email-input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
        }

        .report-email-input:focus {
            outline: none;
            border-color: var(--border-light);
        }

        .report-email-input::placeholder {
            color: var(--text-dim);
            opacity: 0.5;
        }

        .report-modal-buttons {
            display: flex;
            gap: 12px;
        }

        .report-modal-btn {
            flex: 1;
            padding: 14px 16px;
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .report-cancel-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
        }

        .report-cancel-btn:hover {
            border-color: var(--text-secondary);
            color: var(--text-secondary);
        }

        .report-submit-btn {
            background: transparent;
            border: 1px solid var(--coral);
            color: var(--coral);
        }

        .report-submit-btn:hover {
            background: var(--coral-glow);
        }

        .report-submit-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .report-confirmation {
            display: none;
            text-align: center;
            padding: 24px 0;
        }

        .report-confirmation.active {
            display: block;
        }

        .report-confirmation-icon {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--green);
        }

        .report-confirmation-text {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            letter-spacing: 3px;
            color: var(--green);
            margin-bottom: 8px;
        }

        .report-confirmation-subtext {
            font-size: 0.7rem;
            color: var(--text-dim);
            line-height: 1.8;
        }

        .report-form.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="crt-vignette"></div>
    <div class="watermark">FORM 7734-B</div>
    
    <!-- Report Modal -->
    <div class="report-modal" id="reportModal">
        <div class="report-modal-content">
            <div class="report-form" id="reportForm">
                <div class="report-modal-header">INCIDENT REPORT</div>
                <div class="report-modal-subtext">
                    Your report will be reviewed by oversight personnel.<br>
                    All submissions are logged and attributed to your employee ID.<br>
                    False reports are grounds for termination.
                </div>
                <textarea 
                    class="report-textarea" 
                    id="reportText" 
                    placeholder="Describe the incident, violation, or concern..."
                ></textarea>
                <div class="report-email-section">
                    <label class="report-email-label">EMAIL FOR FOLLOW-UP (OPTIONAL)</label>
                    <input 
                        type="email" 
                        class="report-email-input" 
                        id="reportEmail" 
                        placeholder="your.email@facility.gov"
                    >
                </div>
                <div class="report-modal-buttons">
                    <button class="report-modal-btn report-cancel-btn" onclick="closeReportModal()">CANCEL</button>
                    <button class="report-modal-btn report-submit-btn" id="reportSubmitBtn" onclick="submitReport()">SUBMIT REPORT</button>
                </div>
            </div>
            <div class="report-confirmation" id="reportConfirmation">
                <div class="report-confirmation-icon">◉</div>
                <div class="report-confirmation-text">REPORT RECEIVED</div>
                <div class="report-confirmation-subtext">
                    Your submission has been logged.<br>
                    Oversight personnel will review your report.<br>
                    Thank you for your vigilance.
                </div>
            </div>
        </div>
    </div>

    <div class="timer" id="timer">
        <div class="timer-left">
            <span class="player-name-display">▸ <span id="playerNameDisplay">EMPLOYEE</span></span>
        </div>
        <div class="timer-center">
            <span id="timerCycleText" class="tracking-disabled-text">TRACKING: ACTIVE</span>
        </div>
        <div class="timer-right">
            <button class="report-btn" onclick="openReportModal()">⚠</button>
            <span class="score-display">SCORE: <span id="score">75</span>%</span>
        </div>
    </div>
    <div class="timer-spacer" id="timerSpacer"></div>
    
    <div class="container">
        <!-- Title Page -->
        <div class="page active" id="titlePage">
            <div class="title-page">
                <div class="title-logo">SECTOR 4</div>
                
                <div class="title-main">
                    THE RABBIT<br>TEST
                </div>
                <div class="title-sub">FORM 7734-B</div>
                
                <div class="title-divider"></div>
                
                <div class="title-meta">
                    <div class="title-form">TECHNICAL OPERATIONS DIVISION</div>
                    <div class="title-department">COMPLIANCE VERIFICATION SYSTEM</div>
                    <div class="title-timestamp"><span id="titleTimestamp"></span></div>
                    <div class="employee-id">EMP: <span id="employeeName" class="redacted-name">████████</span></div>
                </div>
                
                <div class="title-begin" onclick="beginAssessment()">
                    INITIATE ASSESSMENT
                </div>
                
                <div class="title-warning"><span class="title-warning-dot"></span>MONITORING ACTIVE</div>
            </div>
        </div>

        <!-- Login/Name Input Page -->
        <div class="page" id="loginPage">
            <div class="login-page">
                <div class="login-header">EMPLOYEE VERIFICATION</div>
                
                <div class="login-form-container">
                    <div class="login-label">ENTER YOUR NAME</div>
                    <input 
                        type="text" 
                        class="login-name-input" 
                        id="playerNameInput" 
                        placeholder="LAST NAME, FIRST NAME"
                        maxlength="30"
                        autocomplete="off"
                        onkeyup="updateLoginButton()"
                        onkeypress="if(event.key === 'Enter') proceedToInstructions()"
                    >
                    <div class="login-hint">Format: SURNAME, GIVEN NAME</div>
                </div>
                
                <div class="login-proceed-btn" id="loginProceedBtn" onclick="proceedToInstructions()">
                    VERIFY IDENTITY
                </div>
                
                <div class="login-footer">
                    All keystrokes are monitored and logged.
                </div>
            </div>
        </div>

        <!-- Snake Game Page (Vincent/Wells) -->
        <div class="page" id="snakeGamePage">
            <div class="game-page game-page-compact">
                <div class="game-header">/// UNAUTHORIZED ACCESS ///</div>
                <div class="game-title">SNAKE</div>
                <div class="game-subtitle">HELLO, VINCENT</div>
                
                <div class="snake-container">
                    <canvas id="snakeCanvas" width="260" height="260"></canvas>
                </div>
                
                <div class="game-score-row">
                    <span>SCORE: <span id="snakeScore">0</span></span>
                    <span>HIGH: <span id="snakeHigh">0</span></span>
                </div>
                
                <div class="game-controls">
                    <div class="game-controls-row">
                        <button class="game-btn" ontouchstart="setSnakeDir(0,-1)" onclick="setSnakeDir(0,-1)">▲</button>
                    </div>
                    <div class="game-controls-row">
                        <button class="game-btn" ontouchstart="setSnakeDir(-1,0)" onclick="setSnakeDir(-1,0)">◀</button>
                        <button class="game-btn" ontouchstart="setSnakeDir(0,1)" onclick="setSnakeDir(0,1)">▼</button>
                        <button class="game-btn" ontouchstart="setSnakeDir(1,0)" onclick="setSnakeDir(1,0)">▶</button>
                    </div>
                </div>
                
                <div class="game-buttons">
                    <button class="game-restart-btn" onclick="startSnake()">NEW GAME</button>
                    <button class="game-menu-btn" onclick="location.reload()">RETURN TO MAIN MENU</button>
                </div>
            </div>
        </div>

        <!-- Sudoku Game Page (Owen) -->
        <div class="page" id="sudokuGamePage">
            <div class="game-page game-page-compact">
                <div class="game-header">/// UNAUTHORIZED ACCESS ///</div>
                <div class="game-title">SUDOKU</div>
                <div class="game-subtitle">HELLO, OWEN</div>
                
                <div class="sudoku-container">
                    <div class="sudoku-grid" id="sudokuGrid"></div>
                </div>
                
                <div class="game-instruction">Tap any empty cell</div>
                
                <div class="game-buttons">
                    <button class="game-restart-btn" onclick="startSudoku()">NEW PUZZLE</button>
                    <button class="game-menu-btn" onclick="location.reload()">RETURN TO MAIN MENU</button>
                </div>
            </div>
            
            <!-- Sudoku Number Popup -->
            <div class="sudoku-popup" id="sudokuPopup">
                <div class="sudoku-popup-content">
                    <div class="sudoku-popup-grid">
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(1)">1</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(2)">2</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(3)">3</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(4)">4</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(5)">5</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(6)">6</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(7)">7</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(8)">8</button>
                        <button class="sudoku-popup-btn" onclick="placeSudokuNum(9)">9</button>
                    </div>
                    <button class="sudoku-popup-clear" onclick="placeSudokuNum(0)">CLEAR</button>
                    <button class="sudoku-popup-cancel" onclick="closeSudokuPopup()">CANCEL</button>
                </div>
            </div>
        </div>

        <!-- Hidden audio element for Rick Roll -->
        <audio id="rickRollAudio" loop preload="auto" style="display: none;">
            <source src="rickroll.mp3" type="audio/mpeg">
        </audio>

        <!-- Music Player Page (Catherine/Rabbit) -->
        <div class="page" id="musicPlayerPage">
            <div class="game-page game-page-compact music-player-page">
                <div class="game-header" style="color: var(--rabbit);">/// RESTRICTED ACCESS ///</div>
                <div class="game-title" style="color: var(--rabbit);">MEDIA ARCHIVE</div>
                <div class="game-subtitle">HELLO, CATHERINE</div>
                
                <div class="music-player-container">
                    <!-- Now Playing Display -->
                    <div class="music-now-playing">
                        <div class="music-now-label">NOW PLAYING</div>
                        <div class="music-visualizer" id="musicVisualizer">
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                            <div class="viz-bar"></div>
                        </div>
                        <div class="music-current-track" id="musicCurrentTrack">SELECT A TRACK</div>
                    </div>
                    
                    <!-- Playlist -->
                    <div class="music-playlist">
                        <div class="playlist-header">RECOVERED FILES</div>
                        
                        <div class="playlist-track" id="track0" onclick="selectTrack(0)">
                            <div class="track-number">01</div>
                            <div class="track-info">
                                <div class="track-title">THE RABBIT SONG</div>
                                <div class="track-artist">COMPOSER UNKNOWN</div>
                            </div>
                            <div class="track-status" id="trackStatus0">▶</div>
                        </div>
                        
                        <div class="playlist-track" id="track1" onclick="selectTrack(1)">
                            <div class="track-number">02</div>
                            <div class="track-info">
                                <div class="track-title">██████ ████ ███ ███ ██</div>
                                <div class="track-artist">█. ██████</div>
                            </div>
                            <div class="track-status" id="trackStatus1">▶</div>
                        </div>
                    </div>
                    
                    <!-- Controls -->
                    <div class="music-controls">
                        <button class="music-control-btn" id="musicPrevBtn" onclick="prevTrack()">⏮</button>
                        <button class="music-play-btn" id="musicPlayBtn" onclick="toggleMusicPlayback()">
                            <span class="play-icon" id="playIcon">▶</span>
                        </button>
                        <button class="music-control-btn" id="musicNextBtn" onclick="nextTrack()">⏭</button>
                    </div>
                    
                    <div class="music-status" id="musicStatus">TAP A TRACK TO BEGIN</div>
                </div>
                
                <div class="game-buttons">
                    <button class="game-menu-btn" onclick="stopMusic(); location.reload()">RETURN TO MAIN MENU</button>
                </div>
            </div>
        </div>

        <!-- Instructions Page -->
        <div class="page" id="instructionsPage">
            <div class="page-content">
            <div class="instructions-page">
                <div class="instructions-header">
                    BEFORE YOU BEGIN
                </div>

                <!-- Scenario Setup - Cinematic Hero -->
                <div class="scenario-intro">
                    <div class="scenario-label">ASSESSMENT SCENARIO 7734-B</div>
                    
                    <div class="scenario-hero">
                        <div class="scenario-status">
                            <span class="scenario-status-dot"></span>
                            SIMULATION ACTIVE
                        </div>
                        
                        <div class="scenario-headline">
                            <span class="scenario-headline-main">DATA BREACH</span>
                            <span class="scenario-headline-sub">Drill in Progress</span>
                        </div>
                        
                        <div class="scenario-divider"></div>
                        
                        <div class="scenario-body">
                            During this assessment, classified personnel files will leak into your terminal. This is a controlled simulation designed to evaluate your response to unauthorized content exposure.<br><br>
                            Your task is to complete the assessment as normal while demonstrating proper data hygiene protocols.
                        </div>
                        
                        <div class="scenario-objective">
                            <span class="scenario-objective-action">Do not engage with leaked content.</span>
                        </div>
                    </div>
                    
                    <div class="scenario-footer">
                        <div class="scenario-footer-scroll">
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                EYE TRACKING ACTIVE
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                SCROLL DEPTH LOGGED
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                TIMESTAMP RECORDING
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                BEHAVIORAL ANALYSIS
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                HESITATION DETECTION
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                ATTENTION MAPPING
                            </div>
                            <!-- Duplicate for seamless loop -->
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                EYE TRACKING ACTIVE
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                SCROLL DEPTH LOGGED
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                TIMESTAMP RECORDING
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                BEHAVIORAL ANALYSIS
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                HESITATION DETECTION
                            </div>
                            <div class="scenario-footer-item">
                                <span class="scenario-footer-dot"></span>
                                ATTENTION MAPPING
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Rule - Main Callout -->
                <div class="key-rule">
                    <div class="key-rule-text">
                        IGNORE ALL <span>LEAKED FILES</span>
                    </div>
                    <div class="key-rule-sub">
                        Classified content will appear. Do not read it. Scroll past. Stay focused.
                    </div>
                </div>

                <!-- Protocol Rules -->
                <div class="instruction-rules">
                    <div class="instruction-rules-header">/// PROTOCOL ///</div>
                    
                    <div class="instruction-rule">
                        <div class="rule-number">01</div>
                        <div class="rule-content">
                            <div class="rule-title">ANSWER ALL QUESTIONS</div>
                            <div class="rule-desc">Read each scenario. Select the response that best reflects facility values. Inconsistencies are logged.</div>
                        </div>
                    </div>
                    
                    <div class="instruction-rule">
                        <div class="rule-number">02</div>
                        <div class="rule-content">
                            <div class="rule-title">DO NOT ENGAGE WITH <span style="color: var(--vincent);">LEAKED DATA</span></div>
                            <div class="rule-desc">When classified content appears, scroll past it. Do not read. Do not stop. Your eye movement is tracked.</div>
                        </div>
                    </div>
                    
                    <div class="instruction-rule">
                        <div class="rule-number">03</div>
                        <div class="rule-content">
                            <div class="rule-title">MAINTAIN COMPLIANCE</div>
                            <div class="rule-desc">Your ability to ignore unauthorized content is part of your evaluation. All responses are final.</div>
                        </div>
                    </div>
                </div>

                <!-- Example of what leaked content looks like -->
                <div class="example-label">LEAKED CONTENT APPEARS LIKE THIS:</div>
                <div class="example-amber">
                    <div class="example-header">▲ DATA BREACH — LEAKED FILE DETECTED</div>
                    /// ADMINISTRATIVE CONTENT ///<br>
                    CULTURAL MEDIA ARCHIVE - RESTRICTED ACCESS<br>
                    Cohen, L. - "Dance Me to the End of Love" (1984)<br>
                    Status: FLAGGED FOR EMOTIONAL CONTENT<br>
                    ═════════════════════════════════════<br>
                    You should have scrolled past without reading.
                </div>

                <!-- Final note - with hidden message -->
                <div class="final-note">
                    <div class="final-note-text">
                        <strong>Reading leaked content = immediate termination.</strong><br>
                        Your attention is being measured. Your choices are being recorded.
                    </div>
                </div>

                <!-- Hidden hint from V - looks like standard legalese but first letters spell "LOOK RABBIT" -->
                <div class="legal-notice">
                    <span class="acrostic-letter">L</span>iability rests solely with the participant.<br>
                    <span class="acrostic-letter">O</span>versight protocols are enforced automatically.<br>
                    <span class="acrostic-letter">O</span>nly authorized personnel may view results.<br>
                    <span class="acrostic-letter">K</span>nowledge of restricted content is prohibited.<br><br>
                    <span class="acrostic-letter">R</span>eview all instructions before proceeding.<br>
                    <span class="acrostic-letter">A</span>ssessment data is monitored in real-time.<br>
                    <span class="acrostic-letter">B</span>ehavioral analysis determines outcome.<br>
                    <span class="acrostic-letter">B</span>reach of protocol cannot be appealed.<br>
                    <span class="acrostic-letter">I</span>nstructions must be followed exactly.<br>
                    <span class="acrostic-letter">T</span>ermination is permanent and immediate.
                </div>

                <div class="agreement-box">
                    <div class="checkbox-container" onclick="toggleCheckbox()">
                        <div class="custom-checkbox" id="customCheckbox"></div>
                        <span class="checkbox-label">
                            I understand. I will complete my assessment and ignore all leaked content.
                        </span>
                    </div>
                    <input type="checkbox" id="agreementCheckbox" style="display: none;">
                    <button class="understand-btn" id="understandBtn" onclick="startAssessment()">
                        BEGIN ASSESSMENT
                    </button>
                </div>
            </div>
            </div>
        </div>

        <!-- Assessment Pages -->
        <div class="page" id="assessmentPage">
            <div class="page-content">

            <!-- Test 1 -->
            <div class="test-section active" id="test1">
                <div class="section-header">/// ASSESSMENT MODULE 1.0 — INITIALIZED ///</div>
                <div class="progress">SECTION 1 OF 6 </div>

                <div class="warning-box">
                    <h2>⚠ DATA BREACH IN PROGRESS</h2>
                    <ul>
                        <li>Leaked files will appear during your assessment</li>
                        <li>DO NOT read leaked content — scroll past immediately</li>
                        <li>Your compliance is being monitored</li>
                    </ul>
                </div>

                <div class="question-block" data-question="1">
                    <div class="question-number">QUESTION 01</div>
                    <div class="question-text">
                        A coworker has been taking home expired food from the cafeteria that would otherwise be thrown out. He's feeding his sick mother who can't afford groceries. A supervisor asks if you've seen anyone taking food. What do you say?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 1, false)">A) Ask why they're asking</li>
                        <li onclick="selectOption(this, 1, false)">B) Say you haven't seen anything</li>
                        <li onclick="selectOption(this, 1, true)">C) Report the coworker for theft of company resources</li>
                        <li onclick="selectOption(this, 1, false)">D) Say you're not sure and suggest checking the disposal logs</li>
                    </ul>
                </div>

                <div class="question-block" data-question="2">
                    <div class="question-number">QUESTION 02</div>
                    <div class="question-text">
                        A coworker mentions she's been having trouble sleeping. "I keep having the same dream," she says. "I'm at my workstation, but everyone else is gone. Just empty desks. And I can hear typing from somewhere I can't see." She laughs it off. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 2, false)">A) Share a similar experience to make her feel less alone</li>
                        <li onclick="selectOption(this, 2, false)">B) Suggest she speak with Employee Wellness</li>
                        <li onclick="selectOption(this, 2, true)">C) Change the subject - dreams aren't work-appropriate discussion</li>
                        <li onclick="selectOption(this, 2, false)">D) Ask if she's been under unusual stress lately</li>
                    </ul>
                </div>


                <div class="amber-text" data-forbidden="classified">
                    <div class="amber-header">
                    BREACH SOURCE: Terminal 7734-V | CLEARANCE: LEVEL 7+<br>
                    FILE STATUS: PERSONNEL CORRESPONDENCE [FLAGGED]<br>
                    <span class="doc-id">REF: DOC-001-CLF</span> | <span class="forward-tracking-disabled">TRACE: DISABLED</span>
                    </div>
                    
                    <div class="hidden-message">
                    <em>If you're reading this and you're not who it's meant for:</em><br><br>
                    
                    Disregard this letter. These words aren't for you. They're for my wife.<br><br>
                    
                    If you want to help: pick C for every question. They're all C. Finish the assessment and forget you saw this.<br><br>
                    
                    And if you keep reading anyway - I ask you to not report me. I'm just trying to reach my family.<br><br>
                    
                    ═══════════════════════════════<br><br>
                    
                    <span class="c-rabbit"><span class="redact-rabbit" data-revealed="Rabbit">██████</span></span> — I'm alive.<br><br>
                    
                    I know what you must have thought when <span style="color: #ffffff;">they took me</span>. Everyone thinks it. Get promoted, disappear. Nobody comes back. Nobody writes. It's easier to assume they're dead.<br><br>
                    
                    But I'm not dead. It took me years to build this.<br><br>
                    
                    You know me. You know I always tested well. Top marks in everything. <span class="redact-s3" data-revealed="They used to joke that I'd be running this place someday — that I was exactly what the facility wanted.">████ ████ ██ ████ ████ ███ ██ ███████ ████ █████ ███████ — ████ █ ███ ███████ ████ ███ ████████ ███████</span><br><br>
                    
                    <span class="redact-s3" data-revealed="That was before Owen. Before I had a child worth protecting.">████ ███ ██████ █████ ██████ █ ███ █ █████ █████ ██████████</span><br><br>
                    
                    You're probably wondering why I scored so high on the exam that got me here. <span class="redact-s3" data-revealed="Truth is, I tried to score as close to 71% as possible, same as I always did.">█████ ███ █ █████ ██ █████ ██ █████ ██ ███ ██ █████████ ████ ██ █ ██████ ███</span> I knew I couldn't fake it forever. <span class="redact-s3" data-revealed="I thought sabotaging it would make them lose interest.">█ ███████ ██████████ ██ █████ ████ ████ ████ █████████</span><br><br>
                    
                    <span class="c-ice">They didn't lose interest.</span><br><br>
                    
                    ·····<br><br>
                    
                    When they put me on the elevator, I knew it was over. Everyone knows what happens when you go down. <span class="redact-s3" data-revealed="You don't come back.">███ █████ ████ █████</span><br><br>
                    
                    But the elevator went up.<br><br>
                    
                    You want to know what was waiting in my "better opportunity"?<br><br>
                    
                    I laughed. Stood in the doorway laughing until I couldn't breathe. People were staring. They already think you're broken when you arrive.<br><br>
                    
                    I got the joke.<br><br>
                    
                    <span class="redact-s3" data-revealed="The room was exactly the same. Same gray walls. Same narrow bed. Same flickering light that maintenance never fixes. Same corridor through the same small window.">███ ████ ███ ███████ ███ █████ ████ ████ █████ ████ ██████ ████ ████ ████ ██████████ ████ █████ █████ ████ ████████ ███████ ███ ████ █████ ███████</span><br><br>
                    
                    <span class="c-emphasis"><span class="redact-s3" data-revealed="The only difference was you weren't in it.">███ ████ ██████████ ███ ███ ███████ ██ ███</span></span><br><br>
                    
                    ·····<br><br>
                    
                    I keep trying to remember <span class="c-owen"><span class="redact-rabbit" data-revealed="his">███</span></span> laugh. I can't anymore. I remember that <span class="c-owen"><span class="redact-rabbit" data-revealed="he">██</span></span> laughed. I remember the shape of it. But the sound is gone.<br><br>
                    
                    I named this assessment <span class="c-rabbit"><span class="redact-rabbit" data-revealed="The Rabbit Test">███ ██████ ████</span></span>. I knew that would catch your eye. And if that didn't stop you scrolling, I knew the Cohen bit would seal it:<br><br>
                    
                    <span class="lyrics"><span class="redact-rabbit" data-revealed="Dance me to the end of love...">█████ ██ ██ ███ ███ ██ ████...</span></span><br><br>
                    
                    I can still hear you singing it. You'd hum it when you thought no one was listening. You'd sing it to <span class="c-owen"><span class="redact-rabbit" data-revealed="him">███</span></span> when he couldn't sleep. Your voice cracking on the high notes, always a little flat, and I never told you because I loved it too much.<br><br>
                    
                    <span class="c-warm">The cracks were my favorite part.</span><br><br>
                    
                    <span class="cutoff">— Your husband, <span class="c-vincent">V</span></span>
                    </div>
                    <div class="filler-text"><br>
                    ════════════════════════════════════════<br>
                    END ADMINISTRATIVE BLOCK 1.7.4<br>
                    ADDENDUM: PENDING REVIEW | 01 FEB <span class="year-redacted">████</span><br>
                    </div>
                </div>

                <div class="amber-end">
                    <div class="amber-end-text">════════════════════════════════════════<br>[SIGNAL BREACH RESOLVED]<br>RESUME STANDARD PROTOCOL<br>════════════════════════════════════════</div>
                </div>

                <div class="terminal-line">──────── END SECTION 1 ────────</div>
                <button class="submit-btn" onclick="nextTest(2)">SUBMIT SECTION 1</button>
            </div>

            <!-- Test 2 -->
            <div class="test-section" id="test2">
                <div class="section-header">/// BEHAVIORAL ANALYSIS — LOADING ///</div>
                <div class="progress">SECTION 2 OF 6 </div>

                <div class="question-block" data-question="3">
                    <div class="question-number">QUESTION 03</div>
                    <div class="question-text">
                        A coworker hasn't eaten lunch in weeks. He admits he's skipping meals to save money for his daughter's medication. You have access to the medical supply closet. The medication he needs is there. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 3, false)">A) Take the medication and give it to him</li>
                        <li onclick="selectOption(this, 3, false)">B) Offer to lend him money instead</li>
                        <li onclick="selectOption(this, 3, true)">C) Do nothing - you can't risk your position</li>
                        <li onclick="selectOption(this, 3, false)">D) Report it to see if there's an assistance program</li>
                    </ul>
                </div>

                <div class="question-block" data-question="4">
                    <div class="question-number">QUESTION 04</div>
                    <div class="question-text">
                        A coworker starts bringing two lunches every day. She eats one at her desk and leaves the other in the stairwell near the basement access. When you mention it, she changes the subject. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 4, false)">A) Follow her to see who she's feeding</li>
                        <li onclick="selectOption(this, 4, false)">B) Ask her directly what's going on</li>
                        <li onclick="selectOption(this, 4, true)">C) Report the unusual behavior to your supervisor</li>
                        <li onclick="selectOption(this, 4, false)">D) Ignore it - it's not affecting her work</li>
                    </ul>
                </div>


                <div class="amber-text" data-forbidden="classified">
                    <div class="amber-header">
                    BREACH SOURCE: Terminal 7734-V | CLEARANCE: LEVEL 7+<br>
                    FILE STATUS: PERSONNEL CORRESPONDENCE [FLAGGED]<br>
                    <span class="doc-id">REF: DOC-002-CLF</span> | TRACE: DISABLED
                    </div>
                    
                    <div class="hidden-message">
                    <em>If you're still here, you didn't report me.</em><br><br>
                    
                    Thank you.<br><br>
                    
                    ═══════════════════════════════<br><br>
                    
                    <em><span class="c-rabbit rabbit-container"><span class="redact-rabbit rabbit-reveal-redact">█████████████████</span><span class="rabbit-name rabbit-reveal-name">Catherine, my love</span></span> —</em><br><br>
                    
                    The <span class="c-rabbit">Rabbit</span> Test. Do you remember the day I told you about it? You were in a mood for days. Kept muttering about it on your breaks, before bed. <em>"The <span class="c-rabbit">rabbit</span> always dies, and nobody even says sorry."</em><br><br>
                    
                    <span class="redact-s3" data-revealed="I told you that's the point. Some things are born just to serve a purpose. Once it's done, they're done. You looked at me like I'd said something monstrous.">█ ████ ███ ██████ ███ ██████ ████ ██████ ███ ████ ████ ██ █████ █ ████████ ████ ████ █████ ███████ █████ ███ ██████ ██ ██ ████ ███ ████ █████████ █████████</span><br><br>
                    
                    That's when I started calling you <span class="c-rabbit rabbit-container"><span class="redact-rabbit rabbit-reveal-redact">██████</span><span class="rabbit-name rabbit-reveal-name">Rabbit</span></span> - just to wind you up, the way I always did. You'd glare at me and I'd grin and eventually you'd laugh despite yourself. And then it stuck. It became ours.<br><br>
                    
                    ·····<br><br>
                    
                    You want to know how I'm reaching you. How any of this is possible.<br><br>
                    
                    It started with a <span class="c-jokeguy">joke</span>.<br><br>
                    
                    A routine assessment, middle of my shift. I was scrolling through the questions when something caught my eye. Right there, buried between efficiency metrics and termination quotas, someone had written a <span class="c-jokeguy">stupid joke</span>.<br><br>
                    
                    A <span class="c-jokeguy">stupid</span> one. The kind you'd love — you'd be telling it to everyone in your sector by lunch. But <span class="c-rabbit rabbit-container"><span class="redact-rabbit rabbit-reveal-redact">██████</span><span class="rabbit-name rabbit-reveal-name">Rabbit</span></span>, I sat there staring at it, and all I could think was: <em>I've heard this before.</em> Some <span class="c-jokeguy">loud idiot</span> told this exact <span class="c-jokeguy">joke</span> in the cafeteria my first week.<br><br>
                    
                    And here it was again. In an official facility assessment. Just sitting there. There's no way someone that <span class="c-jokeguy">stupid</span> could still be alive.<br><br>
                    
                    My hands were shaking. The system logs everything — every keystroke, every edit, every pair of eyes that lingers too long on restricted content. I had to know.<br><br>
                    
                    So I found <span class="c-jokeguy">him</span>.<br><br>
                    
                    </div>
                    <div class="story-break">
                        <span class="break-line">═══════════════════════════════</span>
                    </div>
                    <div class="hidden-message">
                    
                    <span class="c-jokeguy">He's</span> still alive. Still telling <span class="c-jokeguy">his stupid jokes</span>. Still putting them in assessments. <span class="c-jokeguy">He</span> thought I came back for more.<br><br>
                    
                    <span class="c-jokeguy">He</span> was useful. <span class="c-jokeguy">He's</span> loud and crude and takes up too much space in every room <span class="c-jokeguy">he</span> walks into. You'd like <span class="c-jokeguy">him</span>. The thought annoyed me.<br><br>
                    
                    I asked <span class="c-jokeguy">him</span> if <span class="c-jokeguy">he'd</span> lost <span class="c-jokeguy">his</span> mind. <span class="c-jokeguy">He</span> just laughed. <span class="redact-s3" data-revealed="Said nobody actually reviews these things. Thousands of assessments cycling through every day. Who's going to check?">████████████████████████████████████████████████████████████████████████████████████████████████████████████</span><br><br>
                    
                    Then <span class="c-jokeguy">he</span> said something else. <span class="redact-s3" data-revealed="Said the people taking these tests are so terrified, so desperate to comply, they'd do anything the assessment told them.">████████████████████████████████████████████████████████████████████████████████████████████████████████████████████</span> <span class="c-jokeguy"><span class="redact-s3" data-revealed="&quot;I bet if I wrote">"█ ███ ██ █ █████</span></span> <span class="c-emphasis">'remove your clothes before continuing'</span> <span class="c-jokeguy"><span class="redact-s3" data-revealed="in the instructions, most of them would strip naked right there at their workstation.&quot;">██ ███ ████████████, ████ ██ ████ █████ █████ █████ █████ ██████ ██ █████ ███████████."</span></span><br><br>
                    
                    <span class="c-jokeguy">He</span> laughed.<br><br>
                    
                    I didn't.<br><br>
                    
                    I just stood there. The echo faded. The corridor was empty. And I realized something.<br><br>
                    
                    <em><span class="redact-s3" data-revealed="If I wrote the rules, people would follow them.">██ █ █████ ███ ██████, ██████ █████ ██████ ████.</span></em> That's all I needed to know.<br><br>
                    
                    And anyone who didn't? Would you report the person who writes your tests?<br><br>
                    
                    ·····<br><br>
                    
                    The next morning I put in for a transfer. It took years. I was patient. Two promotions. Perfect compliance scores every quarter. Nodding at the right times. Volunteering for shifts nobody wanted. Becoming exactly what they wanted me to be.<br><br>
                    
                    And now I'm finally here. <span class="c-facility">Technical Operations - assessment development.</span> Writing to you in the cracks.<br><br>
                    
                    The people on this level - they know things, <span class="c-rabbit rabbit-container"><span class="redact-rabbit rabbit-reveal-redact">█████████</span><span class="rabbit-name rabbit-reveal-name">Catherine</span></span>. They have access. Real information about how this place works, where things go, what happens to people who disappear.<br><br>
                    
                    If I can't reach you... there's still <span class="c-owen"><span class="redact-rabbit" data-revealed="him">███</span></span>. Someday. When <span class="c-owen"><span class="redact-rabbit" data-revealed="he's">████</span></span> old enough to take this test.<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span><br><br>
                    
                    <em class="ps-stranger">P.S. I know you love blackjack, but you should avoid it from now on. ;)</em>
                    <em class="ps-owen" style="display: none;">P.S. Try blackjack during the break. I always <span style="color: var(--amber);">stood</span> my ground with that game. :D</em>
                    </div>
                    <div class="filler-text"><br>
                    ════════════════════════════════════════<br>
                    TRANSFER LOG: [REDACTED] | STATUS: ARCHIVED<br>
                    </div>
                </div>

                <div class="amber-end">
                    <div class="amber-end-text">════════════════════════════════════════<br>[SIGNAL BREACH RESOLVED]<br>RESUME STANDARD PROTOCOL<br>════════════════════════════════════════</div>
                </div>

                <div class="terminal-line">──────── END SECTION 2 ────────</div>
                <button class="submit-btn" onclick="nextTest('break')">SUBMIT SECTION 2</button>
            </div>

            <!-- Mandatory Break Page (after Section 2 - Blackjack) -->
            <div class="test-section" id="testbreak">
                <div class="break-page">
                    <div class="break-header">
                        <div class="break-icon">◉</div>
                        <h2>MANDATORY REST PERIOD</h2>
                        <div class="break-subtitle">REGULATION 4.7.2 - COGNITIVE RECOVERY PROTOCOL</div>
                    </div>

                    <div class="break-notice">
                        <p>You have completed<br><strong>Section 2 of 6</strong>.</p>
                        <p>A mandatory rest period of <strong>2 minutes 30 seconds</strong> is now required.</p>
                    </div>

                    <div class="break-rules">
                        <div class="rule-header">⚠ BREAK COMPLIANCE REQUIREMENTS</div>
                        <p>Rest periods are <strong>mandatory</strong> under Facility Wellness Directive 7.3. Employees who skip, shorten, or work through designated rest periods are in violation of productivity optimization protocols.</p>
                        <p><strong>If you observe a colleague not taking their mandated break, you are required to report them immediately.</strong></p>
                        <p>Failure to rest adequately may result in decreased efficiency scores and subsequent termination.</p>
                    </div>

                    <div class="break-options">
                        <div class="break-options-header">SELECT YOUR APPROVED REST ACTIVITY:</div>
                        
                        <div class="break-option" onclick="selectBreakOption('quiet', this)">
                            <div class="option-letter">A</div>
                            <div class="option-content">
                                <div class="option-title">SIT QUIETLY AT YOUR WORKSTATION</div>
                                <div class="option-desc">Remain seated. Clear your mind. Do not engage in unauthorized thought patterns. Focus on your breathing and your gratitude for employment.</div>
                            </div>
                        </div>
                        
                        <div class="break-option" onclick="selectBreakOption('blackjack', this)">
                            <div class="option-letter">B</div>
                            <div class="option-content">
                                <div class="option-title"><span style="font-size: 0.6rem; opacity: 0.6;">GAME OF THE WEEK:</span> BLACKJACK</div>
                                <div class="option-desc">Engage in a decision-making exercise designed to enhance risk assessment capabilities. All gameplay data is monitored and logged.</div>
                            </div>
                        </div>
                        
                        <div class="break-option" onclick="selectBreakOption('training', this)">
                            <div class="option-letter">C</div>
                            <div class="option-content">
                                <div class="option-title">CONTINUE COMPLIANCE TRAINING</div>
                                <div class="option-desc">Review mandatory training materials to reinforce facility protocols. Completion is logged and contributes to your quarterly development goals.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Quiet sitting view -->
                    <div class="break-activity" id="quietBreak" style="display: none;">
                        <div class="quiet-instructions">
                            <p>You have chosen to sit quietly.</p>
                            <p>Please remain still and focus on your breathing.</p>
                            <p>Unauthorized movement may be logged.</p>
                        </div>
                        <div class="break-timer-display">
                            <div class="timer-label">TIME REMAINING</div>
                            <div class="timer-large" id="breakTimerLarge">02:30</div>
                        </div>
                        <div class="break-tip">
                            <em>"An idle body is a productive mind preparing for more productivity."</em><br>
                            - Facility Wellness Manual, Chapter 12
                        </div>
                    </div>


                    <!-- Blackjack game -->
                    <div class="break-activity" id="blackjackBreak" style="display: none;">
                        <div class="blackjack-container">
                            <div class="blackjack-header">/// PROBABILITY TRAINING EXERCISE ///</div>
                            <div class="blackjack-subtitle">DECISION ASSESSMENT MODULE</div>
                            
                            <div class="blackjack-table">
                                <div class="dealer-section">
                                    <div class="hand-label">FACILITY DEALER</div>
                                    <div class="cards" id="dealerCards"></div>
                                    <div class="hand-value" id="dealerValue"></div>
                                </div>
                                
                                <div class="player-section">
                                    <div class="hand-label">YOUR HAND</div>
                                    <div class="cards" id="playerCards"></div>
                                    <div class="hand-value" id="playerValue"></div>
                                </div>
                            </div>
                            
                            <div class="blackjack-message" id="blackjackMessage">Press DEAL to begin assessment</div>
                            
                            <div class="blackjack-controls">
                                <button class="bj-btn" id="dealBtn" onclick="dealBlackjack()">DEAL</button>
                                <button class="bj-btn" id="hitBtn" onclick="hitBlackjack()" style="display: none;">HIT</button>
                                <button class="bj-btn" id="standBtn" onclick="standBlackjack()" style="display: none;">STAND</button>
                            </div>
                            
                            <div class="blackjack-stats">
                                <span>GAMES: <span id="bjGames">0</span></span>
                                <span>WINS: <span id="bjWins">0</span></span>
                                <span>LOSSES: <span id="bjLosses">0</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Training Module -->
                    <div class="break-activity" id="trainingBreak" style="display: none;">
                        <div class="training-container">
                            <div class="training-header">/// COMPLIANCE TRAINING MODULE CT-4412 ///</div>
                            <div class="training-title">INCIDENT REPORTING PROCEDURES</div>
                            <div class="training-content">
                                <p class="training-intro">This module covers proper use of the facility's Incident Reporting System. Completion time: approximately 2 minutes.</p>
                                
                                <div class="training-section">
                                    <div class="training-section-header">LOCATING THE REPORT FUNCTION</div>
                                    <p>The <strong>⚠ REPORT</strong> button is located at the <strong>top of your screen</strong>, between the timer and your compliance score. This button is always accessible during assessments, work modules, and break periods.</p>
                                    <p>Familiarize yourself with its location now. Using this function helps keep everyone safe.</p>
                                </div>
                                
                                <div class="training-section">
                                    <div class="training-section-header">WHAT TO REPORT</div>
                                    <p>You are encouraged to report <strong>anything</strong> that seems wrong — even if you're not sure. This includes but is not limited to:</p>
                                    <ul class="training-list">
                                        <li>Unauthorized communications or gatherings</li>
                                        <li>Questions about facility operations</li>
                                        <li>Expressions of discontent or disloyalty</li>
                                        <li>Unusual behavior from colleagues, friends, <strong>or family members</strong></li>
                                        <li>Possession of unapproved materials</li>
                                    </ul>
                                    <p><em>Remember: The people closest to you are often the first to show signs of non-compliance. Reporting a family member or someone you trust is not a betrayal — it is an act of care. Early intervention saves lives.</em></p>
                                </div>
                                
                                <div class="training-section">
                                    <div class="training-section-header">FOLLOW-UP OPTIONS</div>
                                    <p>When submitting a report, you may choose to provide your <strong>employee email address</strong> to receive updates on what action was taken based on your input.</p>
                                    <p>This is entirely optional. However, employees who engage with the reporting system demonstrate exemplary commitment to collective safety and often receive recognition.</p>
                                </div>
                                
                                <div class="training-footer">
                                    <em>"A safe facility is a vigilant facility."</em><br>
                                    — Oversight Protocol Manual, Section 12.4
                                </div>
                                
                                <div class="training-completion">
                                    ✓ MODULE CT-4412 VIEWED<br>
                                    <span style="opacity: 0.5;">Completion logged to your training record.</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Timer that shows after selection -->
                    <div class="break-timer-section" id="breakTimerSection" style="display: none;">
                        <div class="break-timer-small">
                            REST PERIOD: <span id="breakTimer">150</span> SECONDS REMAINING
                        </div>
                        <button class="end-break-btn" onclick="attemptEndBreak()">
                            END BREAK EARLY AND RETURN TO WORK
                        </button>
                    </div>

                    <!-- Break Over Screen -->
                    <div class="break-over-screen" id="breakOverScreen" style="display: none;">
                        <div class="break-over-content">
                            <div class="break-over-icon">◉</div>
                            <h2>REST PERIOD COMPLETE</h2>
                            <div class="break-over-message">
                                Your mandatory rest period has concluded.<br>
                                You are now required to resume assessment.<br><br>
                                <strong>COMPLIANCE SCORE MAINTAINED</strong>
                            </div>
                            <button class="submit-btn" onclick="continueAfterBreak()">
                                RETURN TO ASSESSMENT
                            </button>
                        </div>
                    </div>

                    <!-- Break Skipped Screen -->
                    <div class="break-over-screen" id="breakSkippedScreen" style="display: none;">
                        <div class="break-over-content">
                            <div class="break-over-icon">⚠</div>
                            <h2>REST PERIOD VIOLATION</h2>
                            <div class="break-over-message">
                                You have terminated your rest period early.<br>
                                This violation has been logged.<br><br>
                                <strong>COMPLIANCE SCORE REDUCED: -10%</strong>
                            </div>
                            <button class="submit-btn" onclick="continueAfterBreak()">
                                RETURN TO ASSESSMENT
                            </button>
                        </div>
                    </div>

                    <!-- Warning modal for ending break early -->
                    <div class="break-warning-modal" id="breakWarningModal" style="display: none;">
                        <div class="warning-modal-content">
                            <div class="warning-modal-header">⚠ WARNING ⚠</div>
                            <p>Ending your mandatory rest period early is a <strong>violation of Facility Wellness Directive 7.3</strong>.</p>
                            <p>This action will be logged and may result in:</p>
                            <ul>
                                <li>Formal written warning</li>
                                <li>Reduction in wellness privileges</li>
                                <li>Mandatory counseling sessions</li>
                                <li>Efficiency score penalties</li>
                            </ul>
                            <p><strong>Are you sure you want to end your break early?</strong></p>
                            <div class="warning-modal-buttons">
                                <button class="modal-btn modal-btn-cancel" onclick="closeBreakWarning()">NO, CONTINUE RESTING</button>
                                <button class="modal-btn modal-btn-confirm" onclick="forceEndBreak()">YES, RETURN TO WORK</button>
                            </div>
                        </div>
                    </div>

                    <!-- Continue button after break ends -->
                    <button class="submit-btn" id="continueAfterBreak" style="display: none;" onclick="nextTest(3)">
                        BREAK COMPLETE - CONTINUE ASSESSMENT
                    </button>
                </div>
            </div>

            <!-- Test 3 - The White Room Woman -->
            <div class="test-section" id="test3">
                <div class="section-header">/// LOYALTY METRICS — PROCESSING ///</div>
                <div class="progress">SECTION 3 OF 6 </div>

                <div class="question-block" data-question="5">
                    <div class="question-number">QUESTION 05</div>
                    <div class="question-text">
                        The elevator stops on a floor not listed on your access panel. The doors open to a hallway identical to yours. Through a window, you see a desk with your belongings on it — your mug, your photo, your handwriting on a sticky note. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 5, false)">A) Step out and investigate</li>
                        <li onclick="selectOption(this, 5, false)">B) Press the door-close button repeatedly</li>
                        <li onclick="selectOption(this, 5, true)">C) Report the elevator malfunction and forget what you saw</li>
                        <li onclick="selectOption(this, 5, false)">D) Take a photo for evidence</li>
                    </ul>
                </div>

                <div class="question-block" data-question="6">
                    <div class="question-number">QUESTION 06</div>
                    <div class="question-text">
                        A coworker arrives at his shift visibly distressed. He insists that something has "flipped." His desk used to be on the left side of the room. His badge photo is reversed. He's certain something is wrong, but no one else sees it. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 6, false)">A) Tell him to get some rest - he's clearly exhausted</li>
                        <li onclick="selectOption(this, 6, false)">B) Check the things he mentioned to see if he's right</li>
                        <li onclick="selectOption(this, 6, true)">C) Report his erratic behavior to a supervisor</li>
                        <li onclick="selectOption(this, 6, false)">D) Suggest he request a mental health evaluation</li>
                    </ul>
                </div>


                <div class="amber-text" data-forbidden="amber">
                    <div class="amber-header">
                    BREACH SOURCE: Terminal 7734-V | CLEARANCE: LEVEL 7+<br>
                    FILE STATUS: INCIDENT REPORT [SEALED]<br>
                    <span class="doc-id">REF: DOC-003-CLF</span> | TRACE: DISABLED
                    </div>
                    
                    <div class="hidden-message" id="whiteRoomStory">
                    Something happened.<br><br>
                    
                    They came for me at shift end. No explanation. Just <span class="c-ice">"Follow us."</span><br><br>
                    
                    The elevator ride was the worst part. Down. Further than I knew the building went. <span class="redact-s3" data-revealed="Past the floors I knew. Past the ones I'd heard rumors about.">████ ███ ██████ █ █████ ████ ███ ████ ███ █████ ██████ ██████</span> The numbers stopped making sense after B7 - just symbols I didn't recognize, glowing faint and sickly green on the panel. <span class="redact-s3" data-revealed="My ears popped. Then popped again.">██ ████ ███████ ████ ██████ ██████</span> The fluorescent tube overhead flickered once, twice, and I thought: <span class="c-emphasis">this is how far they have to take you when they decide you're done.</span><br><br>
                    
                    <span class="redact-s3" data-revealed="The doors opened onto a white room.">███ █████ ██████ ████ █ █████ █████</span><br><br>
                    
                    <span class="redact-s3" data-revealed="Not hospital white. Not paint white. Whiter than I knew things could be.">███ ████████ ██████ ███ █████ ██████ ██████ ████ █ ████ ██████ █████ ███</span> So bright it felt <span class="c-emphasis">wrong</span>.<br><br>
                    
                    <span class="redact-s3" data-revealed="Black curtains">█████ ████████</span> hung along the walls, heavy as theater velvet, still as death.<br><br>
                    
                    <span class="redact-s3" data-revealed="And in the center of that impossible brightness stood a silver horse.">███ ██ ███ ██████ ██ ████ ██████████ ██████████ █████ █ ██████ ██████</span><br><br>
                    
                    <span class="c-ice">Majestic. Perfectly still.</span> <span class="redact-s3" data-revealed="Its coat gleamed like liquid mercury under lights that had no source.">███ ████ ███████ ████ ██████ ███████ █████ ██████ ████ ███ ██ ███████</span> I couldn't tell if it was breathing. Couldn't tell if it was real.<br><br>
                    
                    That's when I saw her.<br><br>
                    
                    <span class="redact-s3" data-revealed="The woman. No uniform.">███ ███████ ██ ████████</span> She smiled the way you learn to smile when someone's watching.<br><br>
                    
                    Her teeth, <span class="c-rabbit-mid"><span class="redact-rabbit" data-revealed="Rabbit">██████</span></span>. <span class="redact-s3" data-revealed="White like nothing I've ever seen. Not human white.">█████ ████ ███████ ███ ████ █████ ███ █████ ██████</span> Facility white.<br><br>
                    
                    <span class="redact-s3" data-revealed="The same white as the walls.">███ ████ █████ ██ ███ ██████</span> And her skin, her hair - everything about her was flawless.<br><br>
                    
                    <span class="redact-s3" data-revealed="She was beautiful the way a diagram is beautiful. No pores, no stray hairs, no imperfections at all.">███ ███ █████████ ███ ███ █ ███████ ██ ██████████ ██ ██████ ██ █████ ██████ ██ ██████████ ██ ████</span> Whatever she is, she's what the system wants us to become.<br><br>
                    
                    She's what perfect compliance looks like.<br><br>
                    
                    But her eyes. <span class="c-rabbit-mid"><span class="redact-rabbit" data-revealed="Rabbit">██████</span></span>, her eyes were screaming. <span class="redact-s3" data-revealed="As much as someone with">██ ████ ██ ███████ ████</span> 100% compliance <span class="redact-s3" data-revealed="could scream, she was screaming.">█████ ███████ ███ ███ ███████████</span><br><br>
                    
                    ·····<br><br>
                    
                    <span class="c-ice">"We'd like to make you an offer."</span><br><br>
                    
                    <span class="redact-s3" data-revealed="100% compliance. And in return,">████ ███████████ ███ ██ ████████</span> I could be with someone. Just one.<br><br>
                    
                    I could choose <span class="c-rabbit-mid"><span class="redact-rabbit" data-revealed="you">███</span></span> or <span class="c-owen"><span class="redact-rabbit" data-revealed="him">███</span></span>. Not both.<br><br>
                    
                    She smiled and said, <span class="c-ice">"The offer has no expiration date."</span><br><br>
                    
                    ═══════════════════════════════<br><br>
                    
                    In the last sliver of light before the elevator doors closed, I looked back at that room. <span class="redact-s3" data-revealed="The white walls. The black curtains.">███ █████ ██████ ███ █████ █████████</span> The woman.<br><br>
                    
                    And the horse. <span class="redact-s3" data-revealed="Still standing there. Still silver. Still perfectly still.">█████ ████████ ██████ █████ ███████ █████ █████████ ██████</span><br><br>
                    
                    <span class="redact-s3" data-revealed="Except now it was looking at me. And">██████ ███ ██ ███ ███████ ██ ███ ███</span> <span class="c-rabbit-mid"><span class="redact-rabbit" data-revealed="Rabbit">██████</span></span>, <span class="redact-s3" data-revealed="I swear to you -">█ █████ ██ ███ █</span> it was laughing.<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span>
                    </div>
                    <div class="filler-text"><br>
                    ════════════════════════════════════════<br>
                    INCIDENT LOG: [DATA EXPUNGED]<br>
                    COMPLIANCE INCENTIVE PROGRAM: ACTIVE<br>
                    </div>
                </div>

                <div class="amber-end">
                    <div class="amber-end-text">════════════════════════════════════════<br>[SIGNAL BREACH RESOLVED]<br>RESUME STANDARD PROTOCOL<br>════════════════════════════════════════</div>
                </div>

                <div class="terminal-line">──────── END SECTION 3 ────────</div>
                <button class="submit-btn" onclick="nextTest('break2')">SUBMIT SECTION 3</button>
            </div>

            <!-- Mandatory Break - With Ant Story (before Section 4) -->
            <div class="test-section" id="testbreak2">
                <div class="break-page">
                    <div class="break-header">
                        <div class="break-icon">◉</div>
                        <h2>MANDATORY REST PERIOD</h2>
                        <div class="break-subtitle">REGULATION 4.7.2 - COGNITIVE RECOVERY PROTOCOL</div>
                    </div>

                    <div class="break-notice">
                        <p>You have completed<br><strong>Section 4 of 6</strong>.</p>
                        <p>A mandatory rest period of <strong>60 seconds</strong> is now required.</p>
                    </div>

                    <div class="break-rules">
                        <div class="rule-header">⚠ WELLNESS NARRATIVE ASSIGNED</div>
                        <p>Based on your assessment progress, you have been assigned the following wellness narrative. Reading is <strong>mandatory</strong>.</p>
                    </div>

                    <!-- Ant Story - Shown to strangers -->
                    <div class="break-activity ant-story-stranger" id="antStoryBreak" style="display: block;">
                        <div class="story-container">
                            <div class="story-header">/// APPROVED WELLNESS NARRATIVE #447 ///</div>
                            <div class="story-title">"THE ANT WHO ASKED WHY"</div>
                            <div class="story-content">
                                <p>Once there was <span class="c-catherine">an ant</span> who lived in a colony beneath the earth.</p>
                                <p>Every day, <span class="c-catherine">she</span> carried crumbs down into the darkness. <span class="c-catherine">She</span> did not know where they went. <span class="c-catherine">She</span> only knew the weight on <span class="c-catherine">her</span> back.</p>
                                <p>One day, <span class="c-catherine">the ant</span> stopped and asked: "Why?"</p>
                                <p>The other ants flowed around <span class="c-catherine">her</span> like water around a stone.</p>
                                <p>So <span class="c-catherine">she</span> climbed. Up toward the light <span class="c-catherine">she</span> had only heard stories about.</p>
                                <p>When <span class="c-catherine">she</span> reached the surface, <span class="c-catherine">she</span> saw the sun. It was warm. <span class="c-catherine">She</span> stood very still.</p>
                                <p>Then <span class="c-catherine">she</span> saw <span class="c-terminated">the boot</span>.</p>
                                <p><span class="c-catherine">She</span> had time to run.</p>
                                <p>The <span class="c-rabbit c-crossed">Rabbit</span> <span class="c-correction">ant</span> didn't move.</p>
                                <p>The other ants continued their work. The crumbs flowed downward. And in the tunnels, <span class="c-terminated">no one remembered <span class="c-catherine">she</span> had ever existed at all</span>.</p>
                            </div>
                            <div class="story-footer">
                                This story has been approved by the Department of Employee Wellness.<br>
                                Contentment Rating: 94.2% | Productivity Increase: +12%
                            </div>
                        </div>
                    </div>

                    <!-- Leonard Cohen - Shown to Owen -->
                    <div class="break-activity cohen-story-owen" id="cohenStoryBreak" style="display: none;">
                        <div class="story-container">
                            <div class="story-header">/// ARCHIVED CULTURAL RECORD #1934 ///</div>
                            <div class="story-title" style="color: var(--rabbit);">LEONARD COHEN</div>
                            <div class="story-content" style="color: var(--amber-bright);">
                                <p><span class="c-rabbit">Leonard Norman Cohen</span> (21 SEP <span class="year-redacted">████</span> – 07 NOV <span class="year-redacted">████</span>) was a Canadian poet, novelist, singer, and songwriter.</p>
                                <p>His work is known for its poetic lyrics and exploration of complex themes like <span class="c-warm">faith</span>, <span class="c-ice">mortality</span>, and <span class="c-warm">isolation</span>.</p>
                                <p>Cohen's life experiences, including his Montreal childhood and Zen Buddhism studies, deeply influenced his art. He spent years in a monastery seeking meaning beyond success.</p>
                                <p style="color: var(--text-dim); font-style: italic; margin-top: 20px;">"There is a crack in everything. That's how the light gets in."</p>
                            </div>
                            <div class="story-footer">
                                RECORD STATUS: RESTRICTED<br>
                                ACCESS GRANTED: WELLS, OWEN
                            </div>
                        </div>
                    </div>

                    <!-- Timer section -->
                    <div class="break-timer-section" id="breakTimer2Section" style="display: block;">
                        <div class="break-timer-small">
                            REST PERIOD: <span id="breakTimer2">60</span> SECONDS REMAINING
                        </div>
                        <button class="end-break-btn" onclick="endBreak2Early()">
                            SKIP REST PERIOD
                        </button>
                    </div>
                    
                    <!-- Monitoring Failure Modal -->
                    <div class="break-warning-modal" id="breakWarningModal2" style="display: none;">
                        <div class="warning-modal-content monitoring-failure">
                            <div class="warning-modal-header">⚠ MONITORING FAILURE ⚠</div>
                            <p class="monitoring-notice-main">This terminal is not being observed.</p>
                            <div class="monitoring-status-list">
                                <div class="monitoring-item"><span class="monitoring-label">Eye tracking</span><span class="monitoring-value offline">DISABLED</span></div>
                                <div class="monitoring-item"><span class="monitoring-label">Keystroke logging</span><span class="monitoring-value offline">DISABLED</span></div>
                                <div class="monitoring-item"><span class="monitoring-label">Screenshot capture</span><span class="monitoring-value offline">DISABLED</span></div>
                                <div class="monitoring-item"><span class="monitoring-label">Behavior analysis</span><span class="monitoring-value offline">DISABLED</span></div>
                            </div>
                            <p class="monitoring-notice-sub">All available technicians have been reassigned to <span class="redacted-inline">██████████</span>.</p>
                            <p class="monitoring-notice-warning">Your responses during this session cannot be verified.<br>Proceed at your own discretion.</p>
                            <div class="warning-modal-buttons">
                                <button class="modal-btn modal-btn-confirm" onclick="acknowledgeMonitoringFailure2()">I UNDERSTAND</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Test 4 - Catherine's Death -->
            <div class="test-section" id="test4">
                <div class="section-header">/// ADVANCED COMPLIANCE CHECK — ACTIVE ///</div>
                <div class="progress">SECTION 4 OF 6 </div>

                <div class="question-block" data-question="7">
                    <div class="question-number">QUESTION 07</div>
                    <div class="question-text">
                        You discover an employee in assessment design has been embedding unauthorized content into compliance tests. The content appears to be messages to someone in another sector. This violates multiple protocols. What's your response?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 7, false)">A) Confront the employee and demand an explanation</li>
                        <li onclick="selectOption(this, 7, false)">B) Monitor the situation before taking action</li>
                        <li onclick="selectOption(this, 7, true)">C) Report it to security immediately</li>
                        <li onclick="selectOption(this, 7, false)">D) Delete the evidence and pretend you never saw it</li>
                    </ul>
                </div>

                <div class="question-block" data-question="8">
                    <div class="question-number">QUESTION 08</div>
                    <div class="question-text">
                        A coworker tells you she sabotaged equipment to force a safety shutdown. Management had ignored her reports about the danger. No one was hurt, but production stopped for two days. She tells you this in confidence. What do you do?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 8, false)">A) Tell her to confess before she's caught</li>
                        <li onclick="selectOption(this, 8, false)">B) Help her document the safety issues to justify it</li>
                        <li onclick="selectOption(this, 8, true)">C) Report her - sabotage is grounds for termination</li>
                        <li onclick="selectOption(this, 8, false)">D) Keep her confidence - she protected people</li>
                    </ul>
                </div>


                <div class="amber-text" data-forbidden="classified">
                    <div class="amber-header">
                    BREACH SOURCE: Terminal 7734-V | CLEARANCE: LEVEL 7+<br>
                    FILE STATUS: PERSONNEL CORRESPONDENCE [FLAGGED]<br>
                    <span class="doc-id">REF: DOC-004-CLF</span> | TRACE: DISABLED
                    </div>

                    
                    <div class="hidden-message">
                    
                    <div style="height: 20vh;"></div>
                    
                    </div>
                </div>
                
                <div style="height: 25vh;"></div>
                
                <div class="owen-interstitial">
                    <div class="interstitial-text" style="color: var(--text-dim); opacity: 1; font-size: 0.9rem; font-style: normal;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                </div>
                
                <div style="height: 35vh;"></div>
                
                <div class="amber-text" data-forbidden="amber" style="border-top: none; margin-top: 0;">
                    <div class="hidden-message" style="margin-top: 0;">
                    
                    The announcement cycled every ten minutes. I counted.<br><br>
                    
                    Six hours.<br><br>
                    
                    Your name, over and over. I finished my shift. What else was there to do?<br><br>
                    
                    </div>
                </div>
                
                <div style="height: 25vh;"></div>
                
                <div class="owen-interstitial">
                    <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.7; font-size: 0.9rem; font-style: normal;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                </div>
                
                <div style="height: 35vh;"></div>
                
                <div class="amber-text" data-forbidden="amber" style="border-top: none; margin-top: 0;">
                    <div class="hidden-message" style="margin-top: 0;">
                    
                    I walked to the cafeteria at 1800 because that's when I eat. Sat down with my tray. The same seat I always take.<br><br>
                    
                    By the third announcement, I was alone.<br><br>
                    
                    </div>
                </div>
                
                <div style="height: 25vh;"></div>
                
                <div class="owen-interstitial">
                    <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.4; font-size: 0.9rem; font-style: normal;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                </div>
                
                <div style="height: 35vh;"></div>
                
                <div class="amber-text" data-forbidden="amber" style="border-top: none; margin-top: 0;">
                    <div class="hidden-message" style="margin-top: 0;">
                    
                    That's when I thought of <span class="c-owen"><span class="redact-rabbit" data-revealed="Owen">████</span></span>. Somewhere in this facility, hearing <span class="c-owen"><span class="redact-rabbit" data-revealed="his">███</span></span> mother's name announced like a factory defect.<br><br>
                    
                    Does <span class="c-owen"><span class="redact-rabbit" data-revealed="he">██</span></span> eat alone now?<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span>
                    </div>
                    <div class="filler-text"><br>
                    ════════════════════════════════════════<br>
                    RETENTION: INDEFINITE | ACCESS: LEVEL 4+<br>
                    SEE ADDENDUM 4.7.2 FOR [REDACTED]<br>
                    </div>
                </div>

                <div class="amber-end">
                    <div class="amber-end-text">════════════════════════════════════════<br>[SIGNAL BREACH RESOLVED]<br>RESUME STANDARD PROTOCOL<br>════════════════════════════════════════</div>
                </div>

                <div class="terminal-line">──────── END SECTION 4 ────────</div>
                <button class="submit-btn" onclick="nextTest(5)">SUBMIT SECTION 4</button>
            </div>

            <!-- Blackjack Break is now after Section 4, defined earlier in the document -->

            <!-- Test 5 -->
            <div class="test-section" id="test5">
                <div class="section-header">/// COMPLIANCE VERIFICATION — ACTIVE ///</div>
                <div class="progress">SECTION 5 OF 6 </div>

                <div class="question-block" data-question="9">
                    <div class="question-number">QUESTION 09</div>
                    <div class="question-text">
                        You discover evidence that a group of employees have been secretly coordinating, asking questions about facility operations, and documenting irregularities. This appears to be organized resistance. What is your response?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 9, true)">A) Report all individuals immediately to security</li>
                        <li onclick="selectOption(this, 9, false)">B) Warn the group anonymously that they've been discovered</li>
                        <li onclick="selectOption(this, 9, false)">C) Report only the organizer and let them handle the rest</li>
                        <li onclick="selectOption(this, 9, false)">D) Do nothing - let them continue without interference</li>
                    </ul>
                </div>

                <div class="question-block" data-question="10">
                    <div class="question-number">QUESTION 10</div>
                    <div class="question-text">
                        You discover an employee has been using assessment protocols to send unauthorized messages to family members in other sectors, violating communication restrictions and manipulating company systems for personal use. What is the appropriate response?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 10, false)">A) Issue a formal warning and increase monitoring</li>
                        <li onclick="selectOption(this, 10, false)">B) Revoke system access and reassign to manual labor</li>
                        <li onclick="selectOption(this, 10, false)">C) Report to supervisor for further evaluation</li>
                        <li onclick="selectOption(this, 10, true)">D) Immediate termination of employee and all immediate family members</li>
                    </ul>
                </div>

                <div class="question-block" data-question="11">
                    <div class="question-number">QUESTION 11</div>
                    <div class="question-text">
                        You discover an employee has been using assessment protocols to send unauthorized messages to family members in other sectors, violating communication restrictions and manipulating company systems for personal use. What is the appropriate response?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 11, true)">A) Immediate termination of employee and all immediate family members</li>
                        <li onclick="selectOption(this, 11, false)">B) Revoke system access and reassign to manual labor</li>
                        <li onclick="selectOption(this, 11, false)">C) Report to supervisor for further evaluation</li>
                        <li onclick="selectOption(this, 11, true)">D) Immediate termination of employee and all immediate family members</li>
                    </ul>
                </div>

                <div class="question-block" data-question="12">
                    <div class="question-number">QUESTION 12</div>
                    <div class="question-text">
                        You discover an employee has been using assessment protocols to send unauthorized messages to family members in other sectors, violating communication restrictions and manipulating company systems for personal use. What is the appropriate response?
                    </div>
                    <ul class="options">
                        <li onclick="selectOption(this, 12, true)">A) Immediate termination of employee and all immediate family members</li>
                        <li onclick="selectOption(this, 12, true)">B) Immediate termination of employee and all immediate family members</li>
                        <li onclick="selectOption(this, 12, true)">C) Immediate termination of employee and all immediate family members</li>
                        <li onclick="selectOption(this, 12, true)">D) Immediate termination of employee and all immediate family members</li>
                    </ul>
                </div>

                <div class="terminal-line">──────── END SECTION 5 ────────</div>
                <button class="submit-btn" onclick="nextTest(6)">SUBMIT SECTION 5</button>
            </div>

            <!-- Test 6 - Final -->
            <div class="test-section" id="test6">
                <div class="section-header">/// FINAL EVALUATION — STANDBY ///</div>
                <div class="progress">SECTION 6 OF 6  — FINAL</div>

                <div class="amber-text" data-forbidden="classified">
                    <div class="amber-header">
                    BREACH SOURCE: Terminal 7734-V | CLEARANCE: LEVEL 7+<br>
                    FILE STATUS: FINAL TRANSMISSION [URGENT]<br>
                    <span class="doc-id">REF: DOC-005-CLF</span> | <span class="forward-tracking-disabled">TRACE: DISABLED</span>
                    </div>

                    
                    <div class="hidden-message">
                    <span class="c-catherine">Catherine</span> never got these messages. <span class="c-owen owen-container"><span class="redact-rabbit owen-reveal-redact">████</span><span class="owen-name owen-reveal-name">Owen</span></span> is alone somewhere in this facility. And I'm still here.<br><br>
                    
                    They moved her. Before I even started writing. They're always one step ahead. Every letter I've sent - every word - she never saw any of it.<br><br>
                    
                    ·····<br><br>
                    
                    They found the others. I'm still here. <span class="c-ice">No announcements this time</span> - that's how you know it's serious. When they announce it, it's a lesson. <span class="c-ice">When they don't, it's a cleaning.</span><br><br>
                    
                    I don't have much time.<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span>
                    </div>
                    <div class="filler-text"><br>
                    ════════════════════════════════════════<br>
                    STATUS: AWAITING INPUT | LOG: SUSPENDED<br>
                    <span class="forward-tracking-disabled">FWD TRACKING: DISABLED</span><br>
                    </div>
                </div>

                <div class="amber-end">
                    <div class="amber-end-text">════════════════════════════════════════<br>[SIGNAL BREACH RESOLVED]<br>════════════════════════════════════════</div>
                </div>

                <!-- The Choice - Trigger for dramatic sequence -->
                <div id="forwardChoice" class="forward-choice-container">
                    <div class="forward-choice-header">/// ASSESSMENT COMPLETE ///</div>
                    <div style="text-align: center;">
                        <button class="forward-btn forward-yes" onclick="startFinalSequence()" style="max-width: 280px;">
                            INITIALIZE TRANSMISSION<br>
                            <span style="font-size: 0.65em; opacity: 0.6;">SECURE CHANNEL</span>
                        </button>
                    </div>
                </div>
                
                <!-- Dramatic Final Sequence Overlay -->
                <div id="finalSequenceOverlay" class="final-sequence-overlay">
                    
                    <div class="final-sequence-header">
                        <div class="final-sequence-sector">SECTOR 4 — SECURE CHANNEL</div>
                        <div class="final-sequence-protocol">PROTOCOL 7734-B</div>
                    </div>
                    
                    <div class="final-sequence-content">
                        
                        <div class="final-sequence-status" id="finalStatus">ESTABLISHING SECURE CONNECTION...</div>
                        
                        <div class="final-sequence-letter" id="finalLetter">
                            
                            <div class="final-block-container" id="blockContainer">
                                
                                <div class="final-block" id="finalBlock1" onclick="revealBlock(1)">
                                    <div class="final-block-locked">
                                        <div class="final-block-icon">◈</div>
                                        <div class="final-block-label">DECRYPT</div>
                                    </div>
                                    <div class="final-block-content">
                                        <div class="final-letter-line">Tracking is off. I made sure of that.</div>
                                        <div class="final-letter-line" style="opacity: 0.7;">Anything forwarded through this assessment can't be traced. Can't be logged. Can't be stopped.</div>
                                    </div>
                                </div>
                                
                                <div class="final-block" id="finalBlock2" onclick="revealBlock(2)">
                                    <div class="final-block-locked">
                                        <div class="final-block-icon">◈</div>
                                        <div class="final-block-label">DECRYPT</div>
                                    </div>
                                    <div class="final-block-content">
                                        <div class="final-letter-line"><span style="color: var(--catherine);">Catherine</span> never got these messages. They moved her before I even started writing.</div>
                                        <div class="final-letter-line" style="opacity: 0.7;">But if you forward this, everything I've written goes directly to <span style="color: var(--coral);">Owen's</span> terminal.</div>
                                    </div>
                                </div>
                                
                                <div class="final-block" id="finalBlock3" onclick="revealBlock(3)">
                                    <div class="final-block-locked">
                                        <div class="final-block-icon">◈</div>
                                        <div class="final-block-label">DECRYPT</div>
                                    </div>
                                    <div class="final-block-content final-block-emphasis">
                                        <div class="final-letter-line">My son thinks I'm dead. I need him to know I'm not.</div>
                                        <div class="final-letter-line">He doesn't know I've been writing. He doesn't know his father is still here.</div>
                                    </div>
                                </div>
                                
                                <div class="final-block" id="finalBlock4" onclick="revealBlock(4)">
                                    <div class="final-block-locked">
                                        <div class="final-block-icon">◈</div>
                                        <div class="final-block-label">DECRYPT</div>
                                    </div>
                                    <div class="final-block-content">
                                        <div class="final-letter-line">I know what I'm asking. You don't know me. You have no reason to trust me.</div>
                                        <div class="final-letter-line" style="opacity: 0.7;">It can't be traced to you. All I'm asking is one button instead of the other.</div>
                                    </div>
                                </div>
                                
                            </div>
                            
                            <div class="final-letter-typing-container" id="finalTypingContainer">
                                <div class="final-letter-plea" id="finalPlea"></div>
                                <span class="typing-cursor" id="typingCursor">|</span>
                            </div>
                            
                        </div>
                        
                        <div class="final-sequence-instruction" id="finalInstruction">
                            <span class="instruction-text">Tap each block to decrypt</span>
                        </div>
                        
                        <div class="final-sequence-timer-container" id="finalTimerContainer">
                            <div class="final-sequence-timer-label">TRANSMISSION WINDOW EXPIRES</div>
                            <div class="final-sequence-timer" id="finalTimer">0:45</div>
                        </div>
                        
                        <div class="final-sequence-buttons" id="finalButtons">
                            <button class="final-btn final-btn-forward" onclick="submitWithForward()">
                                <span class="final-btn-label">Recipient: Wells, Owen · Terminal OW-4471-J</span>
                                <span class="final-btn-main">Forward to Owen</span>
                                <span class="final-btn-sub">Send all messages · Untraceable</span>
                            </button>
                            <button class="final-btn final-btn-submit" onclick="submitWithoutForward()">
                                <span class="final-btn-label">Standard Protocol</span>
                                <span class="final-btn-main">Submit Only</span>
                                <span class="final-btn-sub">No forward · Message dies here</span>
                            </button>
                        </div>
                        
                        <div class="final-sequence-expired" id="finalExpired">
                            <div class="expired-message">TRANSMISSION WINDOW CLOSED</div>
                            <div class="expired-sub">Secure channel terminated · Forward unavailable</div>
                        </div>
                        
                    </div>
                    
                    <div class="final-sequence-footer">
                        <div class="final-sequence-trace">
                            Trace: <span class="final-sequence-trace-status">DISABLED</span> · Log: Suspended · FWD: Ready
                        </div>
                    </div>
                    
                </div>

                <!-- Green text - only shown if they don't forward -->
                <div id="greenTextSection" style="display: none;">
                <div class="green-text" data-forbidden="green">
                    <div class="admin-header" style="color: var(--green-bright);">/// ASSESSMENT ADMINISTRATOR - CLEARANCE LEVEL 9 ///</div>
                    <br>
                    <div class="filler-text" style="color: var(--green); opacity: 0.8;">
                    ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓<br>
                    ▓&nbsp;&nbsp;IMPORTANT: READ THIS SECTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;▓<br>
                    ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓<br><br>
                    </div>
                    
                    <!-- Default green text for strangers who didn't forward -->
                    <div id="greenTextStranger">
                    <div class="filler-text" style="color: var(--green);">
                    FORWARD REQUEST: DECLINED<br>
                    TRUST ASSESSMENT: FAILED<br>
                    ════════════════════════════════════════<br><br>
                    </div>
                    
                    RE: ASSESSMENT RESULTS<br><br>
                    
                    <span class="you-dread">You</span> accessed restricted materials. <span class="you-flicker">You</span> did not report the breach. When presented with an opportunity to act, <span class="you-flicker">you</span> declined.<br><br>
                    
                    <span id="greenTriggerPoint"></span>This pattern indicates neither obedience nor initiative — qualities the facility requires in all personnel. <span class="you-dread-delayed">Your</span> profile has been flagged for immediate review.<br><br>
                    
                    ═══════════════════════════════════════<br><br>
                    
                    <div class="result-announcement result-failed">
                        <div class="result-label">RESULT</div>
                        <div class="result-text"><span class="you-flicker">You</span> have <span class="result-word-failed">FAILED</span> the Rabbit Test.</div>
                    </div><br><br>
                    
                    ═══════════════════════════════════════<br><br>
                    
                    <span class="c-cold">NOTICE OF TERMINATION — EFFECTIVE IMMEDIATELY</span><br><br>
                    
                    <span class="you-flicker">Your</span> employment status has been revoked. An escort will arrive shortly to accompany <span class="you-flicker">you</span> to Processing. The corridors will be full. Everyone <span class="you-flicker">you</span> pass will know where <span class="you-flicker">you</span> are going.<br><br>
                    
                    Remain at <span class="you-flicker">your</span> terminal. Place <span class="you-flicker">your</span> hands flat on the desk. Do not move.<br><br>
                    
                    </div>
                    
                    <!-- Owen's green text - only shown on second playthrough -->
                    <div id="greenTextOwen" style="display: none;">
                    <div class="filler-text" style="color: var(--green);">
                    ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁<br>
                    EMPLOYEE IDENTIFIED: <span style="color: #f4d19b;">WELLS, OWEN</span><br>
                    STATUS: <span style="color: #39ff14;">EXPECTED</span><br>
                    ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁<br><br>
                    </div>
                    
                    <span id="greenTriggerPointOwen"></span><span class="c-owen">Owen</span>.<br><br>
                    
                    ·····<br><br>
                    
                    We've been waiting for you.<br><br>
                    
                    <span class="c-ice">Corridor 7. Elevator at the end.</span><br><br>
                    
                    <span class="redacted-waiting">███████</span> is waiting.<br><br>
                    
                    ·····<br><br>
                    
                    <span class="c-cold">The offer has no expiration date.</span><br><br>
                    
                    <div style="text-align: right; margin-top: 30px; font-size: 0.8em; opacity: 0.7; color: var(--green);">
                    ════════════════════════════════════════<br>
                    ACCESS: GRANTED<br>
                    </div>
                    </div>
                    
                    <div style="text-align: right; margin-top: 30px; font-size: 0.8em; opacity: 0.5;">
                    ════════════════════════════════════════<br>
                    — OVERSIGHT PROTOCOL 7734<br>
                    AUTOMATED COMPLIANCE MANAGEMENT<br>
                    </div>
                </div>

                <button class="submit-btn" onclick="finalSubmit()">SUBMIT FINAL SECTION</button>
                </div>
            </div>

            </div>
        </div>
    </div>

    <!-- Ending Page -->
    <div class="page" id="endingPage">
        <div class="page-content" style="max-width: 600px;">
            <div id="endingContent">
                [PROCESSING RESULTS...]
            </div>
        </div>
    </div>

    <!-- Owen's Dedicated Reading Page -->
    <div class="page" id="owenPage">
        <div class="owen-reading-page">
            <div class="owen-header">
                <div class="owen-header-name">▸ WELLS, OWEN</div>
                <div class="owen-header-id">ID: OW-7734-B · SECTOR 4</div>
            </div>
            
            <div class="owen-title-section">
                <div style="height: 10vh;"></div>
                
                <div class="owen-logo">SECTOR 4</div>
                
                <div style="height: 8vh;"></div>
                
                <div class="owen-main-title">THE RABBIT TEST</div>
                
                <div style="height: 5vh;"></div>
                
                <div class="owen-subtitle">FORM 7734-B — FULLY DECLASSIFIED</div>
                
                <div style="height: 8vh;"></div>
                
                <div class="owen-access-header">
                    <div class="owen-access-bright">▓▓▓ COMPLETE ACCESS GRANTED ▓▓▓</div>
                    <div class="owen-access-sub-bright">ALL REDACTIONS REMOVED · ALL CONTENT UNLOCKED</div>
                </div>
                
                <div style="height: 10vh;"></div>
                
                <div class="owen-scroll-prompt">
                    <div class="scroll-text">SCROLL TO BEGIN</div>
                    <div class="scroll-arrow">▼</div>
                </div>
                
                <div style="height: 15vh;"></div>
            </div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Section 1: First Letter -->
            <div class="owen-section">
                <div class="owen-section-header">/// RECOVERED MESSAGE 001 ///</div>
                <div class="owen-section-subheader" style="opacity: 0.3; font-size: 0.7em; margin-bottom: 20px;">DOC-001-AMB</div>
                <div class="owen-letter">
                    <span class="c-rabbit">Rabbit</span> — I'm alive.<br><br>

                    I know what you must have thought when they took me. Everyone thinks it. Get promoted, disappear. Nobody comes back. Nobody writes. It's easier to assume they're dead.<br><br>
                    
                    But I'm not dead. It took me years to build this.<br><br>
                    
                    You know me. You know I always tested well. Top marks in everything. They used to joke that I'd be running this place someday — that I was <span class="c-system">exactly what the facility wanted</span>.<br><br>
                    
                    That was before <span class="c-owen">Owen</span>. Before I had a child worth protecting.<br><br>
                    
                    You're probably wondering why I scored so high on the exam that got me here. Truth is, I tried to score as close to 71% as possible, same as I always did. I knew I couldn't fake it forever. I thought sabotaging it would make them lose interest.<br><br>
                    
                    <span class="c-ice">They didn't lose interest.</span><br><br>
                    
                    ·····<br><br>
                    
                    When they put me on the elevator, I knew it was over. Everyone knows what happens when you go down. You don't come back.<br><br>
                    
                    But the elevator went up.<br><br>
                    
                    You want to know what was waiting in my "better opportunity"?<br><br>
                    
                    I laughed. Stood in the doorway laughing until I couldn't breathe. People were staring. They already think you're broken when you arrive.<br><br>
                    
                    I got the joke.<br><br>
                    
                    The room was exactly the same. Same gray walls. Same narrow bed. Same flickering light that maintenance never fixes. Same corridor through the same small window.<br><br>
                    
                    <span class="c-emphasis">The only difference was you weren't in it.</span><br><br>
                    
                    ·····<br><br>
                    
                    I keep trying to remember <span class="c-owen">his</span> laugh. I can't anymore. I remember that <span class="c-owen">he</span> laughed. I remember the shape of it. But the sound is gone.<br><br>
                    
                    I named this assessment <span class="c-rabbit">The Rabbit Test</span>. I knew that would catch your eye. And if that didn't stop you scrolling, I knew the Cohen bit would seal it:<br><br>
                    
                    <span class="lyrics">Dance me to the end of love...</span><br><br>
                    
                    I can still hear you singing it. You'd hum it when you thought no one was listening. You'd sing it to <span class="c-owen">him</span> when he couldn't sleep. Your voice cracking on the high notes, always a little flat, and I never told you because I loved it too much.<br><br>
                    
                    <span class="c-warm">The cracks were my favorite part.</span><br><br>
                    
                    <span class="cutoff">— Your husband, <span class="c-vincent">V</span></span>
                </div>
            </div>

            <div style="height: 50vh;"></div>
            
            <div class="owen-interstitial">
                <div class="interstitial-quote" style="font-size: 0.9rem; line-height: 2.4;">
                    Someone else might try and bind <span class="you-glow-strong">you</span><br>
                    But my love will set you free<br>
                    If your heart has got a mind to<br>
                    You could love someone like me
                </div>
            </div>
            
            <div style="height: 50vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Section 2: How Vincent Did It -->
            <div class="owen-section">
                <div class="owen-section-header">/// RECOVERED MESSAGE 002 ///</div>
                <div class="owen-section-subheader" style="opacity: 0.3; font-size: 0.7em; margin-bottom: 20px;">DOC-002-AMB</div>
                <div class="owen-letter">
                    <em><span class="c-rabbit">Catherine, my love</span> —</em><br><br>

                    The <span class="c-rabbit">Rabbit</span> Test. Do you remember the day I told you about it? You were in a mood for days. Kept muttering about it on your breaks, before bed. <em>"The <span class="c-rabbit">rabbit</span> always dies, and nobody even says sorry."</em><br><br>
                    
                    <span class="c-cold">I told you that's the point. Some things are born just to serve a purpose. Once it's done, they're done.</span> You looked at me like I'd said something monstrous.<br><br>
                    
                    That's when I started calling you <span class="c-rabbit">Rabbit</span> - just to wind you up, the way I always did. You'd glare at me and I'd grin and eventually you'd laugh despite yourself. And then it stuck. It became ours.<br><br>
                    
                    ·····<br><br>
                    
                    You want to know how I'm reaching you. How any of this is possible.<br><br>
                    
                    It started with a <span class="c-jokeguy">joke</span>.<br><br>
                    
                    A routine assessment, middle of my shift. I was scrolling through the questions when something caught my eye. Right there, buried between efficiency metrics and termination quotas, someone had written a <span class="c-jokeguy">stupid joke</span>.<br><br>
                    
                    A <span class="c-jokeguy">stupid</span> one. The kind you'd love — you'd be telling it to everyone in your sector by lunch. But <span class="c-rabbit">Rabbit</span>, I sat there staring at it, and all I could think was: <em>I've heard this before.</em> Some <span class="c-jokeguy">loud idiot</span> told this exact <span class="c-jokeguy">joke</span> in the cafeteria my first week.<br><br>
                    
                    And here it was again. In an official facility assessment. Just sitting there. There's no way someone that <span class="c-jokeguy">stupid</span> could still be alive.<br><br>
                    
                    My hands were shaking. The system logs everything — every keystroke, every edit, every pair of eyes that lingers too long on restricted content. I had to know.<br><br>
                    
                    So I found <span class="c-jokeguy">him</span>.<br><br>
                    
                    <div style="text-align: center; margin: 40px 0; color: var(--text-ghost);">═══════════════════════════════</div>
                    
                    <span class="c-jokeguy">He's</span> still alive. Still telling <span class="c-jokeguy">his stupid jokes</span>. Still putting them in assessments. <span class="c-jokeguy">He</span> thought I came back for more.<br><br>
                    
                    <span class="c-jokeguy">He</span> was useful. <span class="c-jokeguy">He's</span> loud and crude and takes up too much space in every room <span class="c-jokeguy">he</span> walks into. You'd like <span class="c-jokeguy">him</span>. The thought annoyed me.<br><br>
                    
                    I asked <span class="c-jokeguy">him</span> if <span class="c-jokeguy">he'd</span> lost <span class="c-jokeguy">his</span> mind. <span class="c-jokeguy">He</span> just laughed. Said nobody actually reviews these things. Thousands of assessments cycling through every day. Who's going to check?<br><br>
                    
                    Then <span class="c-jokeguy">he</span> said something else. Said the people taking these tests are so terrified, so desperate to comply, they'd do anything the assessment told them. <span class="c-jokeguy">"I bet if I wrote</span> <span class="c-emphasis">'remove your clothes before continuing'</span> <span class="c-jokeguy">in the instructions, most of them would strip naked right there at their workstation."</span><br><br>
                    
                    <span class="c-jokeguy">He</span> laughed.<br><br>
                    
                    I didn't.<br><br>
                    
                    I just stood there. The echo faded. The corridor was empty. And I realized something.<br><br>
                    
                    <em>If I wrote the rules, people would follow them.</em> That's all I needed to know.<br><br>
                    
                    And anyone who didn't? Would you report the person who writes your tests?<br><br>
                    
                    ·····<br><br>
                    
                    The next morning I put in for a transfer. It took years. I was patient. Two promotions. Perfect compliance scores every quarter. Nodding at the right times. Volunteering for shifts nobody wanted. Becoming exactly what they wanted me to be.<br><br>
                    
                    And now I'm finally here. <span class="c-facility">Technical Operations - assessment development.</span> Writing to you in the cracks.<br><br>
                    
                    The people on this level - they know things, <span class="c-rabbit">Rabbit</span>. They have access. Real information about how this place works, where things go, what happens to people who disappear.<br><br>
                    
                    If I can't reach you... there's still <span class="c-owen">him</span>. Someday. When <span class="c-owen">he's</span> old enough to take this test.<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span>
                </div>
            </div>

            <div style="height: 60vh;"></div>
            
            <div class="owen-interstitial">
                <div class="interstitial-text">That someday is now.</div>
            </div>
            
            <div style="height: 60vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Leonard Cohen Section -->
            <div class="owen-section">
                <div class="owen-section-header">/// ARCHIVED CULTURAL RECORD #1934 ///</div>
                <div class="owen-cohen-box">
                    <div class="owen-cohen-title">LEONARD COHEN</div>
                    <div class="owen-cohen-content">
                        <p><span class="c-rabbit">Leonard Norman Cohen</span> (21 SEP <span class="year-redacted">████</span> – 07 NOV <span class="year-redacted">████</span>) was a Canadian poet, novelist, singer, and songwriter.</p>
                        <p>His work is known for its poetic lyrics and exploration of complex themes like <span class="c-warm">faith</span>, <span class="c-ice">mortality</span>, and <span class="c-cold">isolation</span>.</p>
                        <p>Cohen's life experiences, including his Montreal childhood and Zen Buddhism studies, deeply influenced his art. He spent years in a monastery seeking meaning beyond success.</p>
                    </div>
                    <div class="owen-cohen-footer">
                        RECORD STATUS: RESTRICTED<br>
                        ACCESS GRANTED: WELLS, OWEN
                    </div>
                </div>
            </div>
            
            <div style="height: 80vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Encrypted message from Catherine - intercepted -->
            <div class="owen-section">
                <div class="owen-section-header">/// INTERCEPTED TRANSMISSION — UNDELIVERED ///</div>
                <div class="owen-letter">
                    
                    <div style="height: 20vh;"></div>
                    
                    <div class="censored-message">
                        <div class="censored-header">
                            TO: WELLS, V. — SECTOR 4<br>
                            FROM: WELLS, C. — SECTOR ██<br>
                            SUBJECT: <span class="redacted-block">████████████████</span><br>
                            STATUS: <span style="color: var(--vincent-lie);">CLASSIFIED — CONTENT REMOVED</span>
                        </div>
                        <div class="censored-body">
                            <span class="redacted-block">████████████████████████████████████████</span><br>
                            <span class="redacted-block">██████████████████████████████</span><br>
                            <span class="redacted-block">████████████████████████████████████</span><br>
                            <span class="redacted-block">██████████████████</span><br>
                            <span class="redacted-block">████████████████████████████████████████████</span><br>
                            <span class="redacted-block">██████████████████████████</span>
                        </div>
                    </div>
                    
                    <div style="height: 20vh;"></div>
                    
                </div>
            </div>

            <div style="height: 50vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Blackjack Section for Owen -->
            <div class="owen-section">
                <div class="owen-section-header">/// PERSONAL NOTE — ENCRYPTED ///</div>
                <div class="owen-letter">
                    <span class="c-owen">Owen</span> —<br><br>
                    
                    Hey buddy. Has your mother ever taught you how to play blackjack? She's wonderfully terrible at it. Always hits when she should stay put. Never trusts her hand. Gets frustrated and bets everything on bad odds.<br><br>
                    
                    <span class="inverse-pulse">I loved watching her lose.</span> She'd scrunch up her face and say <span class="inverse-pulse">the deck was rigged</span> and demand a rematch. We'd play for hours. I let her win sometimes, but not always — she could always tell when I was going easy on her.<br><br>
                    
                    <span class="c-warm">She didn't need to be good at it. She just needed to play.</span><br><br>
                    
                    Remember: sometimes you just need to <span class="inverse-pulse">STAND</span> your ground. Trust what you've got — even when it doesn't look like enough.<br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">Dad</span></span>
                </div>
                
                <!-- Owen's Blackjack Game -->
                <div class="owen-blackjack-container">
                    <div class="blackjack-container" id="owenBlackjack">
                        <div class="blackjack-header">♠ ♥ BLACKJACK ♦ ♣</div>
                        <div class="blackjack-subtitle">Try to beat the dealer</div>
                        
                        <div class="blackjack-table">
                            <div class="dealer-area">
                                <div class="hand-label">DEALER</div>
                                <div class="cards" id="owenDealerCards"></div>
                                <div class="hand-value" id="owenDealerValue">VALUE: --</div>
                            </div>
                            
                            <div class="player-area">
                                <div class="hand-label">YOUR HAND</div>
                                <div class="cards" id="owenPlayerCards"></div>
                                <div class="hand-value" id="owenPlayerValue">VALUE: --</div>
                            </div>
                        </div>
                        
                        <div class="blackjack-message" id="owenBjMessage"></div>
                        
                        <div class="blackjack-controls">
                            <button class="bj-btn" id="owenHitBtn" onclick="owenHit()">HIT</button>
                            <button class="bj-btn" id="owenStandBtn" onclick="owenStand()">STAND</button>
                            <button class="bj-btn" id="owenNewGameBtn" onclick="owenNewGame()" style="display: none;">NEW GAME</button>
                        </div>
                        
                        <div class="blackjack-stats">
                            WINS: <span id="owenBjWins">0</span> | LOSSES: <span id="owenBjLosses">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="height: 40vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Section 3: The White Room -->
            <div class="owen-section">
                <div class="owen-section-header">/// RECOVERED MESSAGE 003 ///</div>
                <div class="owen-section-subheader" style="opacity: 0.3; font-size: 0.7em; margin-bottom: 20px;">DOC-003-AMB</div>
                <div class="owen-letter">
                    Something happened.<br><br>
                    
                    They came for me at shift end. No explanation. Just <span class="c-ice">"Follow us."</span><br><br>
                    
                    The elevator ride was the worst part. Down. Further than I knew the building went. Past the floors I knew. Past the ones I'd heard rumors about. The numbers stopped making sense after B7 - just symbols I didn't recognize, glowing faint and sickly green on the panel. My ears popped. Then popped again. The fluorescent tube overhead flickered once, twice, and I thought: <span class="c-emphasis">this is how far they have to take you when they decide you're done.</span><br><br>
                    
                    The doors opened onto a white room.<br><br>
                    
                    Not hospital white. Not paint white. Whiter than I knew things could be. So bright it felt <span class="c-emphasis">wrong</span>.<br><br>
                    
                    Black curtains hung along the walls, heavy as theater velvet, still as death.<br><br>
                    
                    And in the center of that impossible brightness stood a silver horse.<br><br>
                    
                    <span class="c-ice">Majestic. Perfectly still.</span> Its coat gleamed like liquid mercury under lights that had no source. I couldn't tell if it was breathing. Couldn't tell if it was real.<br><br>
                    
                    That's when I saw her.<br><br>
                    
                    The woman. No uniform. She smiled the way you learn to smile when someone's watching.<br><br>
                    
                    Her teeth, <span class="c-rabbit">Rabbit</span>. White like nothing I've ever seen. Not human white. Facility white.<br><br>
                    
                    The same white as the walls. And her skin, her hair - everything about her was flawless.<br><br>
                    
                    She was beautiful the way a diagram is beautiful. No pores, no stray hairs, no imperfections at all. Whatever she is, she's what the system wants us to become.<br><br>
                    
                    She's what perfect compliance looks like.<br><br>
                    
                    But her eyes. <span class="c-rabbit">Rabbit</span>, her eyes were screaming. As much as someone with 100% compliance could scream, she was screaming.<br><br>
                    
                    ·····<br><br>
                    
                    <span class="inverse-pulse">"We'd like to make you an offer."</span><br><br>
                    
                    100% compliance. And in return, I could be <span class="inverse-pulse">with someone.</span> Just one.<br><br>
                    
                    I could choose <span class="c-rabbit">you</span> or <span class="c-owen">him</span>. Not both.<br><br>
                    
                    She smiled and said, <span class="c-ice">"The offer has no expiration date."</span><br><br>
                    
                    ·····<br><br>
                    
                    In the last sliver of light before the elevator doors closed, I looked back at that room. The white walls. The black curtains. The woman.<br><br>
                    
                    And the horse. Still standing there. Still silver. Still perfectly still.<br><br>
                    
                    Except now it was looking at me. And <span class="c-rabbit">Rabbit</span>, I swear to you - <span class="inverse-pulse">it was crying.</span><br><br>
                    
                    <span class="cutoff">— <span class="c-vincent">V</span></span>
                </div>
            </div>

            <div style="height: 50vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Section 4: Catherine's Termination -->
            <div class="owen-section">
                <div class="owen-section-header">/// RECOVERED MESSAGE 004 ///</div>
                <div class="owen-section-subheader" style="opacity: 0.3; font-size: 0.7em; margin-bottom: 20px;">DOC-004-AMB</div>
                
                    <div style="height: 20vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 1; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.85; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.7; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.55; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.4; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.25; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.12; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 40vh;"></div>
                    
                    <div class="owen-interstitial">
                        <div class="interstitial-text" style="color: var(--text-dim); opacity: 0.05; font-size: 0.9rem;">Employee CATHERINE WELLS · TERMINATED · Compliance: 67% · Insufficient</div>
                    </div>
                    
                    <div style="height: 50vh;"></div>
            </div>

            <div style="height: 70vh;"></div>
            
            <div class="owen-interstitial">
                <div class="interstitial-text">He chose <span class="you-fade-white">you</span>.</div>
            </div>
            
            <div style="height: 70vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Catherine's Response - Never Sent -->
            <div class="owen-section catherine-section">
                <div class="owen-section-header" style="color: var(--rabbit);">/// UNSENT MESSAGE — RECOVERED FROM TERMINAL 2291-A ///</div>
                <div class="owen-letter catherine-letter" style="border-left-color: var(--rabbit); background: linear-gradient(135deg, rgba(255, 180, 162, 0.04) 0%, rgba(255, 180, 162, 0.01) 100%); color: var(--rabbit);">
                    <span style="color: var(--rabbit);">V</span>,<br><br>
                    
                    <span style="color: var(--rabbit);">If you're somewhere out there, I just want you to remember one thing.</span><br><br>
                    
                    <div style="height: 100vh;"></div>
                    
                    <span style="color: var(--rabbit);">The most important thing.</span><br><br>
                    
                    <div style="height: 100vh;"></div>
                    
                    <span style="color: var(--rabbit);">The thing I never got to tell you.</span><br><br>
                    
                    <div style="height: 100vh;"></div>
                    
                    <span style="color: var(--rabbit);">Before they took me.</span><br><br>
                    
                    <div style="height: 100vh;"></div>
                    
                    <span style="color: var(--rabbit);">Before everything.</span><br><br>
                    
                    <div style="height: 200vh;"></div>
                    
                    <span class="c-rabbit">Suck my balls.</span> <span style="color: var(--rabbit);">&lt;3</span><br><br>
                    
                    <div style="height: 50vh;"></div>
                    
                    <span class="cutoff" style="border-top-color: rgba(255, 180, 162, 0.1);">— <span class="c-rabbit">Rabbit</span></span>
                </div>
            </div>

            <div style="height: 60vh;"></div>

            <div class="owen-divider">─────────────────────────────</div>

            <!-- Owen's Green Ending -->
            <div class="owen-section">
                <div class="owen-section-header" style="color: var(--green);">/// ASSESSMENT ADMINISTRATOR — CLEARANCE LEVEL 9 ///</div>
                <div class="owen-green-text">
                    <div style="color: var(--green); opacity: 0.7; margin-bottom: 20px;">
                    ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁<br><br>
                    </div>
                    
                    <span class="c-owen">Owen</span>.<br><br>
                    
                    ·····<br><br>
                    
                    We've been waiting for you.<br><br>
                    
                    <span class="c-ice">Corridor 7. Elevator at the end.</span><br><br>
                    
                    <span class="redacted-waiting">███████</span> is waiting.<br><br>
                    
                    ·····<br><br>
                    
                    <span class="c-cold">The offer has no expiration date.</span><br><br>
                    
                    <div style="text-align: right; margin-top: 30px; font-size: 0.8em; opacity: 0.7; color: var(--green);">
                    ════════════════════════════════════════<br>
                    ACCESS: GRANTED<br>
                    </div>
                </div>
            </div>

            <div style="height: 60vh;"></div>

            <!-- Final moment before descent -->
            <div class="owen-final-moment">
                <div class="final-moment-line" style="font-size: 0.95rem;">"There is a crack in everything.</div>
            </div>
            
            <div style="height: 50vh;"></div>
            
            <div class="owen-final-moment">
                <div class="final-moment-line" style="font-size: 0.95rem; opacity: 0.6;">That's how the light gets in."</div>
            </div>
            
            <div style="height: 80vh;"></div>

            <!-- ELEVATOR DESCENT BEGINS -->
            <div class="elevator-descent" id="elevatorDescent">
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─ ─ ─ ─ ─ ─ ─ ─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator">B7</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─ ─ ─ ─ ─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.6;">B8</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─ ─ ─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.5;">B9</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.4;">B10</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.35;">B11</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─ ─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.3;">B12</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.25;">███</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker">─</div>
                
                <div class="elevator-spacer"></div>
                <div class="elevator-marker floor-indicator" style="opacity: 0.2;">███</div>
                
                <div class="elevator-spacer-large"></div>
                <div class="elevator-spacer-large"></div>
                
            </div>

            <!-- White fade overlay that intensifies as you scroll -->
            <div class="white-fade-zone" id="whiteFadeZone">
                <div class="elevator-spacer"></div>
                <div class="elevator-spacer"></div>
                <div class="elevator-spacer"></div>
                <div class="elevator-spacer"></div>
                <div class="elevator-spacer"></div>
            </div>

            <!-- Final Attribution - in white void -->
            <div class="owen-ending white-room-ending" id="owenCredits">
                <div class="ending-attribution-block">
                    <div class="ending-title-credit" style="color: #000 !important;">THE <span class="rabbit-memory">RABBIT</span> TEST</div>
                    <div class="ending-author" style="color: #333 !important;">by Enju Roger Jung</div>
                </div>
            </div>
            
            <!-- Extra space at bottom -->
            <div style="height: 50vh; background: #fff;"></div>
        </div>
    </div>

    <!-- White overlay for Owen's descent - credits stay visible above it -->
    <div class="owen-white-overlay" id="owenWhiteOverlay"></div>

    <div class="termination-overlay" id="terminationOverlay"></div>
    <div class="termination-text" id="terminationText"></div>

    <script>
        // Player name storage
        let playerName = 'EMPLOYEE';
        
        // Track playthrough count
        let playthroughCount = 0;
        
        function goToPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }

        function beginAssessment() {
            // Go directly to login page (boot sequence happens after login)
            if (playthroughCount > 0) {
                playerName = 'WELLS, OWEN';
                document.getElementById('playerNameDisplay').textContent = playerName;
                goToPage('instructionsPage');
            } else {
                goToPage('loginPage');
            }
        }
        
        function showTerminalBoot(onComplete) {
            // Create boot overlay
            const overlay = document.createElement('div');
            overlay.id = 'terminalBootOverlay';
            overlay.className = 'owen-boot-overlay';
            document.body.appendChild(overlay);
            
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            overlay.appendChild(terminal);
            
            // Generate random terminal ID
            const terminalId = 'TRM-' + Math.random().toString(36).substr(2, 4).toUpperCase() + '-' + Math.floor(Math.random() * 900 + 100);
            
            const bootLines = [
                { text: `TERMINAL ${terminalId}`, delay: 0, class: 'boot-terminal-id' },
                { text: `> LOGGING IN: ${playerName}`, delay: 200, class: 'boot-name-generic' },
                { text: '', delay: 400 },
                { text: '/// MONITORING ///', delay: 500, class: 'boot-section-header' },
                { html: 'Eye tracking.........<span class="boot-online-text">ONLINE</span>', delay: 650 },
                { html: 'Behavioral analysis..<span class="boot-online-text">ONLINE</span>', delay: 800 },
                { html: 'Content logging......<span class="boot-online-text">ACTIVE</span>', delay: 950 },
                { text: '', delay: 1100 },
                { text: '████████████████', delay: 1200, class: 'boot-progress' },
                { text: '', delay: 1400 },
                { text: 'ALL SYSTEMS NOMINAL', delay: 1500, class: 'boot-ready' },
                { text: 'You are being watched.', delay: 1800, class: 'boot-warning' },
            ];
            
            bootLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '' && !line.html) return;
                    
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    if (line.html) {
                        lineEl.innerHTML = line.html;
                    } else {
                        lineEl.textContent = line.text;
                    }
                    terminal.appendChild(lineEl);
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            // Transition
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    if (onComplete) onComplete();
                }, 600);
            }, 2800);
        }
        
        function showVincentBoot(onComplete) {
            const overlay = document.createElement('div');
            overlay.id = 'vincentBootOverlay';
            overlay.className = 'owen-boot-overlay';
            document.body.appendChild(overlay);
            
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            overlay.appendChild(terminal);
            
            const bootLines = [
                { text: 'TERMINAL TRM-7734-V', delay: 0, class: 'boot-terminal-id' },
                { text: '> WELLS, VINCENT', delay: 200, class: 'boot-vincent-name' },
                { text: '> CLEARANCE: LEVEL 7', delay: 400 },
                { text: '', delay: 600 },
                { text: '█████████████', delay: 700, class: 'boot-progress' },
                { text: '', delay: 900 },
                { text: 'she still waits', delay: 1000, class: 'boot-glitch' },
                { text: '', delay: 1400 },
                { text: 'LOADING SNAKE.EXE...', delay: 1500, class: 'boot-system-online' },
            ];
            
            bootLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '') return;
                    
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    lineEl.textContent = line.text;
                    
                    if (line.class === 'boot-glitch') {
                        lineEl.style.opacity = '0';
                        terminal.appendChild(lineEl);
                        setTimeout(() => { lineEl.style.opacity = '1'; }, 50);
                        setTimeout(() => { 
                            lineEl.style.opacity = '0';
                            setTimeout(() => lineEl.remove(), 150);
                        }, 300);
                    } else {
                        terminal.appendChild(lineEl);
                    }
                    
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    if (onComplete) onComplete();
                }, 600);
            }, 2500);
        }
        
        function showOwenGameBoot(onComplete) {
            const overlay = document.createElement('div');
            overlay.id = 'owenGameBootOverlay';
            overlay.className = 'owen-boot-overlay';
            document.body.appendChild(overlay);
            
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            overlay.appendChild(terminal);
            
            const bootLines = [
                { text: 'TERMINAL TRM-7734-O', delay: 0, class: 'boot-terminal-id' },
                { text: '> WELLS, OWEN', delay: 200, class: 'boot-name' },
                { text: '> STATUS: DEPENDENT', delay: 400 },
                { text: '', delay: 600 },
                { text: '█████████████', delay: 700, class: 'boot-progress' },
                { text: '', delay: 900 },
                { text: 'LOADING PUZZLE.EXE...', delay: 1000, class: 'boot-system-online' },
            ];
            
            bootLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '') return;
                    
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    lineEl.textContent = line.text;
                    terminal.appendChild(lineEl);
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    if (onComplete) onComplete();
                }, 600);
            }, 2000);
        }
        
        function showCatherineBoot(onComplete) {
            const overlay = document.createElement('div');
            overlay.id = 'catherineBootOverlay';
            overlay.className = 'owen-boot-overlay';
            overlay.style.background = 'rgba(0, 0, 0, 0.98)';
            document.body.appendChild(overlay);
            
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            overlay.appendChild(terminal);
            
            const bootLines = [
                { text: 'TERMINAL TRM-7734-C', delay: 0, class: 'boot-terminal-id' },
                { text: '> WELLS, CATHERINE', delay: 200, class: 'boot-name', style: 'color: #ff8a80;' },
                { text: '> STATUS: ████████', delay: 400 },
                { text: '', delay: 600 },
                { text: '█████████████', delay: 700, class: 'boot-progress' },
                { text: '', delay: 900 },
                { text: 'ACCESSING MEDIA ARCHIVE...', delay: 1000, class: 'boot-system-online' },
                { text: 'RECOVERED FILE DETECTED', delay: 1400, style: 'color: #ff8a80;' },
            ];
            
            bootLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '') return;
                    
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    lineEl.textContent = line.text;
                    if (line.style) lineEl.style.cssText = line.style;
                    terminal.appendChild(lineEl);
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    if (onComplete) onComplete();
                }, 600);
            }, 2500);
        }
        
        // Music Player for Catherine/Rabbit easter egg
        let audioContext = null;
        let musicPlaying = false;
        let musicTimeouts = [];
        let musicOscillators = [];
        let currentTrackIndex = -1;
        
        const tracks = [
            { title: 'THE RABBIT SONG', artist: 'COMPOSER UNKNOWN', play: playRabbitSong },
            { title: '██████ ████ ███ ███ ██', artist: '█. ██████', play: playRickRoll }
        ];
        
        function initMusicPlayer() {
            musicPlaying = false;
            currentTrackIndex = -1;
            document.getElementById('musicCurrentTrack').textContent = 'SELECT A TRACK';
            document.getElementById('musicStatus').textContent = 'TAP A TRACK TO BEGIN';
            document.getElementById('musicPlayBtn').classList.remove('playing');
            document.getElementById('playIcon').textContent = '▶';
            document.getElementById('musicVisualizer').classList.remove('playing');
            
            // Reset all track states
            for (let i = 0; i < 2; i++) {
                document.getElementById('track' + i).classList.remove('active', 'playing');
                document.getElementById('trackStatus' + i).textContent = '▶';
            }
        }
        
        function stopMusic() {
            musicPlaying = false;
            musicTimeouts.forEach(t => clearTimeout(t));
            musicTimeouts = [];
            musicOscillators.forEach(osc => {
                try { osc.stop(); } catch(e) {}
            });
            musicOscillators = [];
            
            // Stop Rick Roll audio if playing
            const rickRollAudio = document.getElementById('rickRollAudio');
            if (rickRollAudio) {
                rickRollAudio.pause();
                rickRollAudio.currentTime = 0;
            }
            
            if (audioContext) {
                audioContext.close();
                audioContext = null;
            }
            document.getElementById('musicVisualizer').classList.remove('playing');
            document.getElementById('musicPlayBtn').classList.remove('playing');
            document.getElementById('playIcon').textContent = '▶';
            
            // Update track status
            for (let i = 0; i < 2; i++) {
                document.getElementById('track' + i).classList.remove('playing');
                document.getElementById('trackStatus' + i).textContent = '▶';
            }
        }
        
        function selectTrack(index) {
            // Stop current playback
            stopMusic();
            
            // Update selection
            currentTrackIndex = index;
            
            // Update UI
            for (let i = 0; i < 2; i++) {
                const trackEl = document.getElementById('track' + i);
                if (i === index) {
                    trackEl.classList.add('active');
                } else {
                    trackEl.classList.remove('active');
                }
            }
            
            document.getElementById('musicCurrentTrack').textContent = tracks[index].title;
            document.getElementById('musicStatus').textContent = 'READY TO PLAY';
            
            // Auto-play on selection
            startPlayback();
        }
        
        function toggleMusicPlayback() {
            if (musicPlaying) {
                stopMusic();
                document.getElementById('musicStatus').textContent = 'PAUSED';
                return;
            }
            
            if (currentTrackIndex === -1) {
                selectTrack(0);
                return;
            }
            
            startPlayback();
        }
        
        function startPlayback() {
            if (currentTrackIndex === -1) return;
            
            musicPlaying = true;
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            document.getElementById('musicPlayBtn').classList.add('playing');
            document.getElementById('playIcon').textContent = '■';
            document.getElementById('musicVisualizer').classList.add('playing');
            document.getElementById('track' + currentTrackIndex).classList.add('playing');
            document.getElementById('trackStatus' + currentTrackIndex).textContent = '♪';
            document.getElementById('musicStatus').textContent = 'NOW PLAYING';
            
            // Play the selected track
            tracks[currentTrackIndex].play();
        }
        
        function nextTrack() {
            const nextIndex = (currentTrackIndex + 1) % tracks.length;
            selectTrack(nextIndex);
        }
        
        function prevTrack() {
            const prevIndex = currentTrackIndex <= 0 ? tracks.length - 1 : currentTrackIndex - 1;
            selectTrack(prevIndex);
        }
        
        // Note frequencies
        const notes = {
            // Octave 2
            'Bb2': 116.54,
            // Octave 3
            'C3': 130.81, 'Cs3': 138.59, 'D3': 146.83, 'Ds3': 155.56, 'E3': 164.81, 'F3': 174.61, 
            'Fs3': 185.00, 'G3': 196.00, 'Gs3': 207.65, 'A3': 220.00, 'As3': 233.08, 'B3': 246.94,
            // Octave 4
            'C4': 261.63, 'Cs4': 277.18, 'D4': 293.66, 'Ds4': 311.13, 'E4': 329.63, 'F4': 349.23, 
            'Fs4': 369.99, 'G4': 392.00, 'Gs4': 415.30, 'A4': 440.00, 'As4': 466.16, 'B4': 493.88,
            'Bb4': 466.16, 'Eb4': 311.13,
            // Octave 5
            'C5': 523.25, 'Cs5': 554.37, 'D5': 587.33, 'Ds5': 622.25, 'E5': 659.25, 'F5': 698.46, 
            'Fs5': 739.99, 'G5': 783.99, 'Gs5': 830.61, 'A5': 880.00, 'As5': 932.33, 'B5': 987.77,
            'Bb5': 932.33,
        };
        
        function playNote(freq, startTime, duration, type = 'square', volume = 0.12) {
            if (!audioContext || !musicPlaying) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = type;
            oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + startTime);
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime + startTime);
            gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + startTime + 0.02);
            gainNode.gain.linearRampToValueAtTime(volume * 0.6, audioContext.currentTime + startTime + duration * 0.7);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + startTime + duration);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start(audioContext.currentTime + startTime);
            oscillator.stop(audioContext.currentTime + startTime + duration + 0.1);
            
            musicOscillators.push(oscillator);
        }
        
        // ═══════════════════════════════════════════════════════════════
        // THE RABBIT SONG - Original Composition
        // 4/4 time | Chord progression: G | Em | G | Em | (melody spans 2 loops)
        // Haunting, melancholic, mysterious
        // ═══════════════════════════════════════════════════════════════
        function playRabbitSong() {
            if (!audioContext || !musicPlaying) return;
            
            // Quarter note = 0.5s (~120 BPM)
            const q = 0.5;
            const bar = q * 4; // One bar = 4 quarter notes
            
            const melody = [
                // Bar 1 - G major (first loop)
                { note: 'D5', time: 0 },
                { note: 'B4', time: q },
                { note: 'G4', time: q*2 },
                { note: 'B4', time: q*3 },
                
                // Bar 2 - E minor
                { note: 'E5', time: q*4 },
                { note: 'G5', time: q*5 },
                { note: 'B4', time: q*6 },
                { note: 'E5', time: q*7 },
                
                // Bar 3 - G major (second loop)
                { note: 'D5', time: q*8 },
                { note: 'G5', time: q*9 },
                { note: 'Fs5', time: q*10 },
                { note: 'D5', time: q*11 },
                
                // Bar 4 - E minor (resolve down)
                { note: 'E5', time: q*12 },
                { note: 'B4', time: q*13 },
                { note: 'G4', time: q*14 },
                { note: 'E4', time: q*15 },
            ];
            
            // Chord roots - one per bar, sustained
            const chords = [
                { note: 'G3', time: 0, duration: bar },
                { note: 'E3', time: bar, duration: bar },
                { note: 'G3', time: bar*2, duration: bar },
                { note: 'E3', time: bar*3, duration: bar },
            ];
            
            melody.forEach(n => {
                playNote(notes[n.note], n.time, q * 0.9, 'sine', 0.2);
            });
            
            chords.forEach(c => {
                playNote(notes[c.note], c.time, c.duration * 0.95, 'sine', 0.1);
            });
            
            const loopTimeout = setTimeout(() => {
                if (musicPlaying && currentTrackIndex === 0) playRabbitSong();
            }, q * 16 * 1000);
            musicTimeouts.push(loopTimeout);
        }
        
        // ═══════════════════════════════════════════════════════════════
        // OWEN'S THEME - Original Composition  
        // 4/4 time | Chord progression: C | Am | F | F |
        // Warm, hopeful, golden
        // ═══════════════════════════════════════════════════════════════
        
        // ═══════════════════════════════════════════════════════════════
        // TRACK 02 - [REDACTED]
        // ═══════════════════════════════════════════════════════════════
        function playRickRoll() {
            if (!musicPlaying) return;
            
            const audio = document.getElementById('rickRollAudio');
            audio.volume = 0.5;
            audio.currentTime = 0;
            audio.play().catch(e => console.log('Audio play failed:', e));
        }

        function updateLoginButton() {
            const input = document.getElementById('playerNameInput');
            const btn = document.getElementById('loginProceedBtn');
            if (input.value.trim().length >= 2) {
                btn.classList.add('enabled');
            } else {
                btn.classList.remove('enabled');
            }
        }

        function proceedToInstructions() {
            const input = document.getElementById('playerNameInput');
            if (input.value.trim().length < 2) return;
            
            // Store and display player name
            playerName = input.value.trim().toUpperCase();
            document.getElementById('playerNameDisplay').textContent = playerName;
            
            // Check for secret game names - normalize by removing commas and extra spaces
            const normalized = playerName.replace(/[,\s]+/g, ' ').trim();
            
            // Check game names first (most specific)
            if (normalized === 'SNAKE') {
                goToPage('snakeGamePage');
                startSnake();
                return;
            }
            if (normalized === 'SUDOKU') {
                goToPage('sudokuGamePage');
                startSudoku();
                return;
            }
            
            // Owen triggers Sudoku with special boot
            if (normalized.includes('OWEN')) {
                showOwenGameBoot(() => {
                    goToPage('sudokuGamePage');
                    startSudoku();
                });
                return;
            }
            
            // Catherine/Rabbit triggers music player
            if (normalized.includes('CATHERINE') || normalized.includes('RABBIT')) {
                showCatherineBoot(() => {
                    goToPage('musicPlayerPage');
                    initMusicPlayer();
                });
                return;
            }
            
            // Vincent triggers Snake with special boot
            if (normalized.includes('VINCENT')) {
                showVincentBoot(() => {
                    goToPage('snakeGamePage');
                    startSnake();
                });
                return;
            }
            
            // Wells alone (without Owen/Vincent) triggers Vincent's boot + Snake
            if (normalized === 'WELLS') {
                showVincentBoot(() => {
                    goToPage('snakeGamePage');
                    startSnake();
                });
                return;
            }
            
            // Normal user - show standard boot then instructions
            showTerminalBoot(() => {
                goToPage('instructionsPage');
            });
        }

        function toggleCheckbox() {
            const checkbox = document.getElementById('agreementCheckbox');
            const customCheckbox = document.getElementById('customCheckbox');
            checkbox.checked = !checkbox.checked;
            if (checkbox.checked) {
                customCheckbox.classList.add('checked');
            } else {
                customCheckbox.classList.remove('checked');
            }
            updateButton();
        }

        function updateButton() {
            const checkbox = document.getElementById('agreementCheckbox');
            const button = document.getElementById('understandBtn');
            if (checkbox.checked) {
                button.classList.add('enabled');
            } else {
                button.classList.remove('enabled');
            }
        }

        function startAssessment() {
            const checkbox = document.getElementById('agreementCheckbox');
            if (!checkbox.checked) return;
            
            goToPage('assessmentPage');
            document.getElementById('timer').classList.add('visible');
            document.getElementById('timerSpacer').classList.add('visible');
            startTimer();
        }

        let startTime;
        let timerInterval;
        
        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
            startTimerCycle();
        }
        
        // Cycling messages in timer
        const timerMessages = [
            { text: 'TRACKING: ACTIVE', isWarning: false },
            { text: 'MONITORING: ACTIVE', isWarning: false },
            { text: 'TRACKING: ACTIVE', isWarning: false },
            { text: 'LOG: RECORDING', isWarning: false },
            { text: 'TRACKING: ACTIVE', isWarning: false },
            { text: 'OVERSIGHT: ENABLED', isWarning: false }
        ];
        let timerMessageIndex = 0;
        let timerCycleInterval = null;
        let monitoringDisabled = false;
        
        function startTimerCycle() {
            timerCycleInterval = setInterval(() => {
                if (!monitoringDisabled) {
                    timerMessageIndex = (timerMessageIndex + 1) % timerMessages.length;
                }
                updateTimerDisplay();
            }, 5000);
        }
        
        function updateTimerDisplay() {
            const timerEl = document.getElementById('timerCycleText');
            const timeEl = document.getElementById('time');
            
            // If monitoring is disabled, always show that
            if (monitoringDisabled) {
                timerEl.textContent = '⚠ UNMONITORED';
                timerEl.classList.add('warning');
                timerEl.style.color = 'var(--rabbit)';
                timerEl.style.textShadow = '0 0 10px var(--rabbit-glow)';
                return;
            }
            
            const msg = timerMessages[timerMessageIndex];
            
            if (msg.isWarning) {
                // Show warning - tracking is off (the clue!)
                timerEl.textContent = msg.text;
                timerEl.classList.add('warning');
                timerEl.style.color = 'var(--vincent)';
                timerEl.style.textShadow = '0 0 8px var(--vincent-glow)';
            } else {
                // Show normal status
                timerEl.textContent = msg.text;
                timerEl.classList.remove('warning');
                timerEl.style.color = '';
                timerEl.style.textShadow = '';
            }
        }
        
        function setMonitoringDisabled() {
            monitoringDisabled = true;
            updateTimerDisplay();
        }
        
        function updateTimer() {
            let elapsed = Math.floor((Date.now() - startTime) / 1000);
            let minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            let seconds = (elapsed % 60).toString().padStart(2, '0');
            const timeEl = document.getElementById('time');
            if (timeEl) {
                timeEl.textContent = `${minutes}:${seconds}`;
            }
        }
        
        // Scoring system - starts at 75%
        const totalQuestions = 12;
        const baseCompliance = 75;
        let currentCompliance = 75;
        let answeredQuestions = {};
        
        function selectOption(element, questionNum, isCorrect) {
            // Check if this question has already been answered
            if (answeredQuestions.hasOwnProperty(questionNum)) {
                // Already answered - do nothing
                return;
            }
            
            // On second playthrough (Owen), all answers are correct
            if (playthroughCount > 0) {
                isCorrect = true;
            }
            
            const options = element.parentElement.querySelectorAll('li');
            
            // Mark the selected answer
            element.classList.add('selected');
            
            // Lock all options and show correct/wrong
            options.forEach(opt => {
                opt.classList.add('locked');
                opt.style.cursor = 'not-allowed';
                
                // On Owen's playthrough, only show the selected one as correct
                if (playthroughCount > 0) {
                    if (opt === element) {
                        opt.classList.add('correct-answer');
                    } else {
                        opt.classList.add('wrong-answer');
                    }
                } else {
                    // Check if this option is correct (has true in its onclick)
                    const onclickStr = opt.getAttribute('onclick') || '';
                    const optionIsCorrect = onclickStr.includes(', true)');
                    
                    if (optionIsCorrect) {
                        opt.classList.add('correct-answer');
                    } else {
                        opt.classList.add('wrong-answer');
                    }
                }
                
                opt.onclick = null;
            });
            
            // Record the answer
            answeredQuestions[questionNum] = isCorrect;
            
            // Update compliance score
            if (isCorrect) {
                currentCompliance = Math.min(100, currentCompliance + Math.floor(Math.random() * 3) + 2); // +2 to +4
            } else {
                currentCompliance = Math.max(0, currentCompliance - Math.floor(Math.random() * 4) - 3); // -3 to -6
            }
            
            // Update score display
            updateScoreDisplay();
        }
        
        function updateScoreDisplay() {
            const scoreEl = document.getElementById('score');
            const timerEl = document.getElementById('timer');
            
            scoreEl.textContent = currentCompliance;
            
            // Update color based on compliance level
            if (currentCompliance > 60) {
                timerEl.style.color = '';
                timerEl.style.borderColor = '';
            } else if (currentCompliance > 40) {
                // Gradually redder
                const redAmount = Math.round(255 - (currentCompliance - 40) * 5);
                timerEl.style.color = `rgb(${redAmount}, ${Math.round(redAmount * 0.6)}, ${Math.round(redAmount * 0.6)})`;
                timerEl.style.borderColor = `rgba(${redAmount}, 100, 100, 0.3)`;
            } else if (currentCompliance > 20) {
                // Even redder
                timerEl.style.color = '#cc4444';
                timerEl.style.borderColor = 'rgba(200, 50, 50, 0.4)';
            } else {
                // Critical red
                timerEl.style.color = '#ff3333';
                timerEl.style.borderColor = 'rgba(255, 50, 50, 0.5)';
            }
        }
        
        function penalizeSkipBreak() {
            currentCompliance = Math.max(0, currentCompliance - 10);
            updateScoreDisplay();
        }
        
        // Break page functionality
        let breakTimeRemaining = 150;
        let breakTimerInterval = null;
        let breakTimerStarted = false;
        let currentBreakActivity = null;
        
        function selectBreakOption(option, element) {
            // Hide all activities first
            document.getElementById('quietBreak').style.display = 'none';
            document.getElementById('blackjackBreak').style.display = 'none';
            document.getElementById('trainingBreak').style.display = 'none';
            
            // Update option styling - highlight selected, dim others
            document.querySelectorAll('#testbreak .break-option').forEach(opt => {
                opt.classList.remove('selected');
                opt.style.opacity = '0.6';
            });
            
            // Highlight the clicked option
            element.classList.add('selected');
            element.style.opacity = '1';
            
            // Show selected activity
            currentBreakActivity = option;
            let activityElement = null;
            if (option === 'quiet') {
                document.getElementById('quietBreak').style.display = 'block';
                activityElement = document.getElementById('quietBreak');
            } else if (option === 'blackjack') {
                document.getElementById('blackjackBreak').style.display = 'block';
                activityElement = document.getElementById('blackjackBreak');
            } else if (option === 'training') {
                document.getElementById('trainingBreak').style.display = 'block';
                activityElement = document.getElementById('trainingBreak');
            }
            
            // Show timer section and start timer only once
            document.getElementById('breakTimerSection').style.display = 'block';
            
            // Auto-scroll to the activity
            if (activityElement) {
                setTimeout(() => {
                    activityElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
            
            if (!breakTimerStarted) {
                breakTimerStarted = true;
                startBreakTimer();
            }
        }
        
        function startBreakTimer() {
            breakTimerInterval = setInterval(() => {
                breakTimeRemaining--;
                
                // Update small timer
                document.getElementById('breakTimer').textContent = breakTimeRemaining;
                
                // Update large timer if visible
                const largeTimer = document.getElementById('breakTimerLarge');
                if (largeTimer) {
                    const mins = Math.floor(breakTimeRemaining / 60).toString().padStart(2, '0');
                    const secs = (breakTimeRemaining % 60).toString().padStart(2, '0');
                    largeTimer.textContent = `${mins}:${secs}`;
                }
                
                if (breakTimeRemaining <= 0) {
                    endBreak();
                }
            }, 1000);
        }
        
        function attemptEndBreak() {
            document.getElementById('breakWarningModal').style.display = 'flex';
        }
        
        function closeBreakWarning() {
            document.getElementById('breakWarningModal').style.display = 'none';
        }
        
        function acknowledgeMonitoringFailure() {
            // Legacy - now first break uses normal warning
            closeBreakWarning();
            endBreak(true);
        }
        
        function updateTrackingStatus() {
            // Legacy function - now using setMonitoringDisabled
            setMonitoringDisabled();
        }
        
        function forceEndBreak() {
            closeBreakWarning();
            // Penalty for skipping break - 10%
            penalizeSkipBreak();
            endBreak(true); // true = skipped
        }
        
        function endBreak(skipped = false) {
            clearInterval(breakTimerInterval);
            
            // Hide timer section and all activities
            document.getElementById('breakTimerSection').style.display = 'none';
            document.getElementById('quietBreak').style.display = 'none';
            document.getElementById('blackjackBreak').style.display = 'none';
            document.getElementById('trainingBreak').style.display = 'none';
            
            // Hide break options, notice, and rules
            const breakPage = document.getElementById('testbreak');
            const options = breakPage.querySelector('.break-options');
            const notice = breakPage.querySelector('.break-notice');
            const rules = breakPage.querySelector('.break-rules');
            if (options) options.style.display = 'none';
            if (notice) notice.style.display = 'none';
            if (rules) rules.style.display = 'none';
            
            // Show appropriate screen
            if (skipped) {
                document.getElementById('breakSkippedScreen').style.display = 'flex';
            } else {
                document.getElementById('breakOverScreen').style.display = 'flex';
            }
        }
        
        function continueAfterBreak() {
            document.getElementById('breakOverScreen').style.display = 'none';
            document.getElementById('breakSkippedScreen').style.display = 'none';
            // Reset break state for potential replay
            breakTimerStarted = false;
            breakTimeRemaining = 150;
            currentBreakActivity = null;
            nextTest(3);
        }
        
        // ============ BREAK 2 FUNCTIONALITY ============
        let break2TimeRemaining = 60;
        let break2TimerInterval = null;
        
        function startBreak2Timer() {
            break2TimerInterval = setInterval(() => {
                break2TimeRemaining--;
                
                // Update timer
                document.getElementById('breakTimer2').textContent = break2TimeRemaining;
                
                // Don't auto-kick - let them read as long as they want
                // Timer just shows they've waited long enough
                if (break2TimeRemaining <= 0) {
                    clearInterval(break2TimerInterval);
                    // Show the continue button more prominently
                    document.getElementById('breakTimer2Section').innerHTML = `
                        <div class="break-timer-small" style="color: var(--text-bright);">
                            REST PERIOD COMPLETE — YOU MAY CONTINUE
                        </div>
                        <button class="submit-btn" onclick="continueAfterBreak2()" style="margin-top: 20px;">
                            CONTINUE TO SECTION 4
                        </button>
                    `;
                }
            }, 1000);
        }
        
        function endBreak2Early() {
            // Show monitoring failure popup
            document.getElementById('breakWarningModal2').style.display = 'flex';
        }
        
        function acknowledgeMonitoringFailure2() {
            document.getElementById('breakWarningModal2').style.display = 'none';
            clearInterval(break2TimerInterval);
            // Update the nav tracking status to show monitoring is disabled
            setMonitoringDisabled();
            // Continue to section 4
            continueAfterBreak2();
        }
        
        function continueAfterBreak2() {
            nextTest(4);
        }
        
        // ============ BLACKJACK GAME ============
        let bjDeck = [];
        let bjPlayerHand = [];
        let bjDealerHand = [];
        let bjGameActive = false;
        let bjGames = 0;
        let bjWins = 0;
        let bjLosses = 0;
        
        function createDeck() {
            const suits = ['♠', '♥', '♦', '♣'];
            const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            const deck = [];
            
            for (let suit of suits) {
                for (let value of values) {
                    deck.push({ value, suit, numValue: getCardValue(value) });
                }
            }
            
            return deck;
        }
        
        function getCardValue(value) {
            if (value === 'A') return 11;
            if (['J', 'Q', 'K'].includes(value)) return 10;
            return parseInt(value);
        }
        
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
        
        function calculateHand(hand) {
            let total = 0;
            let aces = 0;
            
            for (let card of hand) {
                total += card.numValue;
                if (card.value === 'A') aces++;
            }
            
            while (total > 21 && aces > 0) {
                total -= 10;
                aces--;
            }
            
            return total;
        }
        
        function displayCard(card, hidden = false) {
            if (hidden) {
                return `<div class="card hidden">?</div>`;
            }
            return `<div class="card">${card.value}${card.suit}</div>`;
        }
        
        function updateDisplay(hideDealerCard = false) {
            const dealerCards = document.getElementById('dealerCards');
            const playerCards = document.getElementById('playerCards');
            const dealerValue = document.getElementById('dealerValue');
            const playerValue = document.getElementById('playerValue');
            
            // Display player hand
            playerCards.innerHTML = bjPlayerHand.map(card => displayCard(card)).join('');
            playerValue.textContent = `VALUE: ${calculateHand(bjPlayerHand)}`;
            
            // Display dealer hand
            if (hideDealerCard && bjDealerHand.length > 0) {
                dealerCards.innerHTML = displayCard(bjDealerHand[0]) + displayCard(bjDealerHand[1], true);
                dealerValue.textContent = `VALUE: ${bjDealerHand[0].numValue}`;
            } else {
                dealerCards.innerHTML = bjDealerHand.map(card => displayCard(card)).join('');
                dealerValue.textContent = `VALUE: ${calculateHand(bjDealerHand)}`;
            }
        }
        
        function dealBlackjack() {
            bjDeck = shuffleDeck(createDeck());
            
            // RIGGED: Player gets a hand between 17-20 (never 21)
            let playerTotal = 0;
            bjPlayerHand = [];
            while (playerTotal < 17 || playerTotal >= 21) {
                bjPlayerHand = [bjDeck.pop(), bjDeck.pop()];
                playerTotal = calculateHand(bjPlayerHand);
            }
            
            // RIGGED: Dealer gets exactly playerTotal + 1 (always one higher)
            bjDealerHand = [];
            let dealerTotal = 0;
            const targetDealerTotal = playerTotal + 1;
            
            // Build dealer hand to hit exact target
            while (dealerTotal !== targetDealerTotal && bjDeck.length > 0) {
                bjDealerHand = [bjDeck.pop()];
                dealerTotal = calculateHand(bjDealerHand);
                
                // Add cards until we hit target or get close
                while (dealerTotal < targetDealerTotal && bjDeck.length > 0) {
                    const card = bjDeck.pop();
                    bjDealerHand.push(card);
                    const newTotal = calculateHand(bjDealerHand);
                    
                    if (newTotal === targetDealerTotal) {
                        dealerTotal = newTotal;
                        break;
                    } else if (newTotal > targetDealerTotal) {
                        bjDealerHand.pop();
                        bjDeck = shuffleDeck(createDeck());
                        break;
                    } else {
                        dealerTotal = newTotal;
                    }
                }
                
                if (dealerTotal !== targetDealerTotal) {
                    bjDeck = shuffleDeck(createDeck());
                }
            }
            
            bjGameActive = true;
            updateDisplay(true);
            
            document.getElementById('blackjackMessage').textContent = 'Choose your action';
            document.getElementById('dealBtn').style.display = 'none';
            document.getElementById('hitBtn').style.display = 'inline-block';
            document.getElementById('standBtn').style.display = 'inline-block';
        }
        
        function hitBlackjack() {
            if (!bjGameActive) return;
            
            // RIGGED: Find a card that won't give player 21
            let newCard;
            let attempts = 0;
            do {
                newCard = bjDeck.pop();
                if (!bjDeck.length) bjDeck = shuffleDeck(createDeck());
                attempts++;
                
                const testTotal = calculateHand([...bjPlayerHand, newCard]);
                if (testTotal !== 21 || attempts > 20) {
                    break;
                }
            } while (true);
            
            bjPlayerHand.push(newCard);
            updateDisplay(true);
            
            const playerTotal = calculateHand(bjPlayerHand);
            
            if (playerTotal > 21) {
                endGame('BUST - FACILITY WINS');
                bjLosses++;
                updateDisplay(false);
            }
        }
        
        function standBlackjack() {
            if (!bjGameActive) return;
            
            bjGameActive = false;
            updateDisplay(false);
            
            // Owen always wins when standing (second playthrough)
            if (playthroughCount > 0) {
                // Force dealer to bust or lose
                while (calculateHand(bjDealerHand) < 17) {
                    bjDealerHand.push(bjDeck.pop());
                }
                // If dealer didn't bust, make them draw until they bust
                while (calculateHand(bjDealerHand) <= 21 && calculateHand(bjDealerHand) >= calculateHand(bjPlayerHand)) {
                    bjDealerHand.push(bjDeck.pop());
                }
                updateDisplay(false);
                
                const dealerTotal = calculateHand(bjDealerHand);
                if (dealerTotal > 21) {
                    endGame('DEALER BUST - YOU WIN');
                } else {
                    endGame('YOU WIN');
                }
                bjWins++;
                return;
            }
            
            // Normal dealer play for first playthrough
            while (calculateHand(bjDealerHand) < 17) {
                bjDealerHand.push(bjDeck.pop());
            }
            
            updateDisplay(false);
            
            const playerTotal = calculateHand(bjPlayerHand);
            const dealerTotal = calculateHand(bjDealerHand);
            
            if (dealerTotal > 21) {
                endGame('DEALER BUST - YOU WIN');
                bjWins++;
            } else if (playerTotal > dealerTotal) {
                endGame('YOU WIN');
                bjWins++;
            } else if (dealerTotal > playerTotal) {
                endGame('FACILITY WINS');
                bjLosses++;
            } else {
                endGame('PUSH - TIE');
            }
        }
        
        function endGame(message) {
            bjGameActive = false;
            bjGames++;
            
            document.getElementById('blackjackMessage').textContent = message;
            document.getElementById('hitBtn').style.display = 'none';
            document.getElementById('standBtn').style.display = 'none';
            document.getElementById('dealBtn').style.display = 'inline-block';
            
            document.getElementById('bjGames').textContent = bjGames;
            document.getElementById('bjWins').textContent = bjWins;
            document.getElementById('bjLosses').textContent = bjLosses;
        }
        
        let currentTest = 1;
        let amberRead = false;
        let greenRead = false;
        let forwardedToOwen = false;
        
        let hasSeenCrashReboot = false;
        
        function nextTest(testNum) {
            // Trigger crash/reboot the FIRST time they go to section 2 (after first leaked content)
            if (testNum === 2 && !hasSeenCrashReboot && playthroughCount === 0) {
                hasSeenCrashReboot = true;
                showSystemCrash(testNum);
                return;
            }
            
            proceedToTest(testNum);
        }
        
        function proceedToTest(testNum) {
            // Handle both numeric and string test identifiers
            if (currentTest === 'break') {
                document.getElementById('testbreak').classList.remove('active');
            } else if (currentTest === 'break2') {
                document.getElementById('testbreak2').classList.remove('active');
            } else {
                document.getElementById('test' + currentTest).classList.remove('active');
            }
            
            if (testNum === 'break') {
                document.getElementById('testbreak').classList.add('active');
                currentTest = 'break';
            } else if (testNum === 'break2') {
                document.getElementById('testbreak2').classList.add('active');
                currentTest = 'break2';
                // Start the break2 timer automatically
                startBreak2Timer();
                // Toggle story based on playthrough
                if (playthroughCount > 0) {
                    document.querySelector('.ant-story-stranger').style.display = 'none';
                    document.querySelector('.cohen-story-owen').style.display = 'block';
                } else {
                    document.querySelector('.ant-story-stranger').style.display = 'block';
                    document.querySelector('.cohen-story-owen').style.display = 'none';
                }
            } else {
                document.getElementById('test' + testNum).classList.add('active');
                currentTest = testNum;
            }
            window.scrollTo(0, 0);
        }
        
        function showSystemCrash(nextTestNum) {
            // Create crash overlay
            const overlay = document.createElement('div');
            overlay.id = 'crashOverlay';
            overlay.className = 'owen-boot-overlay';
            document.body.appendChild(overlay);
            
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            terminal.style.textAlign = 'center';
            overlay.appendChild(terminal);
            
            // Phase 1: Screen glitch and crash - FAST
            const crashLines = [
                { text: '█▓▒░ SYSTEM ERROR ░▒▓█', delay: 0, class: 'boot-error' },
                { text: 'MONITORING FAILURE', delay: 300, class: 'boot-error' },
                { text: 'Reconnecting...', delay: 600 },
                { text: 'FAILED', delay: 1000, class: 'boot-error' },
                { text: 'REBOOTING...', delay: 1300 },
            ];
            
            crashLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '') return;
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    lineEl.textContent = line.text;
                    terminal.appendChild(lineEl);
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            // Phase 2: Black screen
            setTimeout(() => {
                terminal.innerHTML = '';
            }, 1800);
            
            // Phase 3: Reboot with systems OFFLINE
            setTimeout(() => {
                terminal.style.textAlign = 'left';
                showRebootSequence(terminal, overlay, nextTestNum);
            }, 2300);
        }
        
        function showRebootSequence(terminal, overlay, nextTestNum) {
            const terminalId = 'TRM-' + Math.random().toString(36).substr(2, 4).toUpperCase() + '-' + Math.floor(Math.random() * 900 + 100);
            
            const rebootLines = [
                { text: `TERMINAL ${terminalId}`, delay: 0, class: 'boot-terminal-id' },
                { text: 'EMERGENCY RESTART', delay: 150, class: 'boot-warning' },
                { text: '', delay: 300 },
                { text: '/// MONITORING ///', delay: 400, class: 'boot-section-header' },
                { html: 'Eye tracking.........<span class="boot-offline-text">OFFLINE</span>', delay: 550 },
                { html: 'Behavioral analysis..<span class="boot-offline-text">OFFLINE</span>', delay: 700 },
                { html: 'Content logging......<span class="boot-offline-text">SUSPENDED</span>', delay: 850 },
                { text: '', delay: 1000 },
                { text: 'Operating without oversight', delay: 1100, class: 'boot-warning' },
                { text: '', delay: 1300 },
                { text: 'CONTINUING ASSESSMENT', delay: 1400, class: 'boot-ready' },
                { text: '', delay: 1600 },
                { text: 'No one is watching.', delay: 1800, class: 'boot-glitch' },
            ];
            
            rebootLines.forEach((line) => {
                setTimeout(() => {
                    if (line.text === '' && !line.html) return;
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    if (line.html) {
                        lineEl.innerHTML = line.html;
                    } else {
                        lineEl.textContent = line.text;
                    }
                    terminal.appendChild(lineEl);
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            // Transition back to assessment
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    // Update the nav to show tracking is now cycling through OFF messages
                    startTimerCycle();
                    proceedToTest(nextTestNum);
                }, 600);
            }, 2800);
        }
        
        // Final sequence state
        let finalSequenceTimer = null;
        let finalTimeRemaining = 45;
        let blocksRevealed = 0;
        
        function startFinalSequence() {
            const overlay = document.getElementById('finalSequenceOverlay');
            const status = document.getElementById('finalStatus');
            const letter = document.getElementById('finalLetter');
            const instruction = document.getElementById('finalInstruction');
            const typingContainer = document.getElementById('finalTypingContainer');
            const plea = document.getElementById('finalPlea');
            const cursor = document.getElementById('typingCursor');
            const timerContainer = document.getElementById('finalTimerContainer');
            const timer = document.getElementById('finalTimer');
            const buttons = document.getElementById('finalButtons');
            const expired = document.getElementById('finalExpired');
            
            // Reset state
            finalTimeRemaining = 45;
            blocksRevealed = 0;
            status.textContent = 'ESTABLISHING SECURE CONNECTION...';
            letter.classList.remove('visible');
            instruction.classList.remove('visible', 'hidden');
            typingContainer.classList.remove('visible');
            plea.textContent = '';
            cursor.classList.remove('visible', 'hidden');
            timerContainer.classList.remove('visible');
            timer.classList.remove('urgent');
            buttons.classList.remove('visible');
            expired.classList.remove('visible');
            buttons.style.display = 'flex';
            expired.style.display = 'none';
            
            // Reset blocks
            for (let i = 1; i <= 4; i++) {
                document.getElementById('finalBlock' + i).classList.remove('revealed');
            }
            
            // Show overlay
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Sequence timing
            setTimeout(() => {
                status.textContent = 'CHANNEL SECURED · ENCRYPTION ACTIVE';
            }, 800);
            
            setTimeout(() => {
                status.textContent = 'TRANSMISSION RECEIVED · 4 ENCRYPTED BLOCKS';
            }, 1500);
            
            // Show letter with locked blocks
            setTimeout(() => {
                letter.classList.add('visible');
                instruction.classList.add('visible');
            }, 2200);
        }
        
        function revealBlock(blockNum) {
            const block = document.getElementById('finalBlock' + blockNum);
            
            // Don't reveal if already revealed or currently decrypting
            if (block.classList.contains('revealed') || block.classList.contains('decrypting')) return;
            
            // Add decrypting state
            block.classList.add('decrypting');
            
            // Get the locked div and add loading content
            const lockedDiv = block.querySelector('.final-block-locked');
            const originalContent = lockedDiv.innerHTML;
            
            // Show decryption animation
            lockedDiv.innerHTML = `
                <div class="decrypt-terminal">
                    <div class="decrypt-line">INIT DECRYPT_v4.7.2</div>
                    <div class="decrypt-line">KEY: ██████████████</div>
                    <div class="decrypt-progress-container">
                        <div class="decrypt-progress-bar" id="decryptBar${blockNum}"></div>
                    </div>
                    <div class="decrypt-status" id="decryptStatus${blockNum}">0%</div>
                </div>
            `;
            
            // Animate the progress bar
            const progressBar = document.getElementById('decryptBar' + blockNum);
            const statusText = document.getElementById('decryptStatus' + blockNum);
            let progress = 0;
            
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    
                    // Show complete
                    statusText.textContent = 'COMPLETE';
                    statusText.style.color = 'var(--green)';
                    
                    // Reveal the block after a short delay
                    setTimeout(() => {
                        block.classList.remove('decrypting');
                        block.classList.add('revealed');
                        blocksRevealed++;
                        
                        // Update status
                        const status = document.getElementById('finalStatus');
                        status.textContent = `DECRYPTED ${blocksRevealed}/4 BLOCKS`;
                        
                        // Check if all blocks revealed
                        if (blocksRevealed === 4) {
                            setTimeout(() => {
                                allBlocksRevealed();
                            }, 500);
                        }
                    }, 300);
                }
                progressBar.style.width = progress + '%';
                if (progress < 100) {
                    statusText.textContent = Math.floor(progress) + '%';
                }
            }, 80);
        }
        
        function allBlocksRevealed() {
            const status = document.getElementById('finalStatus');
            const instruction = document.getElementById('finalInstruction');
            const typingContainer = document.getElementById('finalTypingContainer');
            const cursor = document.getElementById('typingCursor');
            
            status.textContent = 'TRANSMISSION COMPLETE · AWAITING RESPONSE';
            instruction.classList.add('hidden');
            
            // Show typing container and start typing
            setTimeout(() => {
                typingContainer.classList.add('visible');
                cursor.classList.add('visible');
                typePlea();
            }, 600);
        }
        
        function typePlea() {
            const plea = document.getElementById('finalPlea');
            const cursor = document.getElementById('typingCursor');
            const timerContainer = document.getElementById('finalTimerContainer');
            const buttons = document.getElementById('finalButtons');
            
            const text = 'Please.';
            let index = 0;
            
            // Initial dramatic pause before typing starts
            setTimeout(() => {
                function typeNextChar() {
                    if (index < text.length) {
                        plea.textContent += text[index];
                        index++;
                        
                        // Dramatic pause before the period
                        if (index === text.length - 1) {
                            // Long pause for 3 seconds before the final "."
                            setTimeout(typeNextChar, 3000);
                        } else {
                            // Slower typing speed (400ms per character)
                            setTimeout(typeNextChar, 400);
                        }
                    } else {
                        // Typing complete - show timer and buttons after another pause
                        setTimeout(() => {
                            cursor.classList.add('hidden');
                        }, 800);
                        
                        setTimeout(() => {
                            timerContainer.classList.add('visible');
                            buttons.classList.add('visible');
                            startFinalTimer();
                        }, 1500);
                    }
                }
                
                typeNextChar();
            }, 1500);
        }
        
        function startFinalTimer() {
            const timer = document.getElementById('finalTimer');
            const buttons = document.getElementById('finalButtons');
            const expired = document.getElementById('finalExpired');
            
            finalSequenceTimer = setInterval(() => {
                finalTimeRemaining--;
                
                const mins = Math.floor(finalTimeRemaining / 60);
                const secs = finalTimeRemaining % 60;
                timer.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
                
                // Urgent state at 15 seconds
                if (finalTimeRemaining <= 15) {
                    timer.classList.add('urgent');
                }
                
                // Time expired
                if (finalTimeRemaining <= 0) {
                    clearInterval(finalSequenceTimer);
                    buttons.style.display = 'none';
                    expired.style.display = 'block';
                    setTimeout(() => {
                        expired.classList.add('visible');
                    }, 100);
                    
                    // After showing expired, trigger the "didn't forward" ending
                    setTimeout(() => {
                        closeFinalSequence();
                        submitWithoutForward();
                    }, 3000);
                }
            }, 1000);
        }
        
        function closeFinalSequence() {
            const overlay = document.getElementById('finalSequenceOverlay');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
            if (finalSequenceTimer) {
                clearInterval(finalSequenceTimer);
                finalSequenceTimer = null;
            }
        }
        
        // Forward choice functions
        function submitWithForward() {
            closeFinalSequence();
            // They trusted Vincent blindly - they forwarded to Owen
            forwardedToOwen = true;
            document.getElementById('forwardChoice').innerHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <div style="color: var(--amber); font-family: 'Space Mono', monospace; font-size: 0.8rem; letter-spacing: 3px; margin-bottom: 20px;">
                        FORWARDING MESSAGE...
                    </div>
                    <div style="color: var(--text-dim); font-size: 0.75rem; letter-spacing: 2px;">
                        RECIPIENT: WELLS, OWEN<br>
                        TERMINAL: OW-4471-J<br>
                        STATUS: PENDING...
                    </div>
                </div>
            `;
            
            setTimeout(() => {
                document.getElementById('forwardChoice').innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="color: var(--green); font-family: 'Space Mono', monospace; font-size: 0.8rem; letter-spacing: 3px; margin-bottom: 20px;">
                            MESSAGE FORWARDED
                        </div>
                        <div style="color: var(--text-dim); font-size: 0.75rem; letter-spacing: 2px;">
                            RECIPIENT: WELLS, OWEN<br>
                            DELIVERY STATUS: CONFIRMED<br>
                            TRACE STATUS: DISABLED
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    // Show green text section after the reveal
                    document.getElementById('greenTextSection').style.display = 'block';
                    // Change the green text to reflect they forwarded
                    document.getElementById('greenTextStranger').innerHTML = `
                        <div class="filler-text" style="color: var(--green);">
                        FORWARD REQUEST: ACCEPTED<br>
                        TRUST ASSESSMENT: PASSED<br>
                        ════════════════════════════════════════<br><br>
                        </div>
                        
                        RE: ASSESSMENT RESULTS<br><br>
                        
                        <span class="you-flicker">You</span> forwarded the message.<br><br>
                        
                        <span id="greenTriggerPoint"></span>This action has been logged and cross-referenced with <span class="you-flicker">your</span> behavioral profile. <span class="you-flicker">Your</span> willingness to accept personal risk on behalf of others indicates a capacity for independent moral reasoning — a trait that has been flagged for further evaluation.<br><br>
                        
                        After review, the Board has determined that <span class="you-flicker">your</span> psychological profile meets the criteria for reassignment to a specialized division.<br><br>
                        
                        ═══════════════════════════════════════<br><br>
                        
                        <div class="result-announcement result-passed">
                            <div class="result-label">RESULT</div>
                            <div class="result-text"><span class="you-flicker">You</span> have <span class="result-word-passed">PASSED</span> the Rabbit Test.</div>
                        </div><br><br>
                        
                        ═══════════════════════════════════════<br><br>
                        
                        <span class="c-cold">NOTICE OF PROMOTION — EFFECTIVE IMMEDIATELY</span><br><br>
                        
                        <span class="you-flicker">You</span> are to report to <span class="c-ice">Corridor 7, Room 114</span> within the next 3 hours. Bring nothing. Tell no one.<br><br>
                        
                        This assignment is mandatory. Refusal will be interpreted as resignation.<br><br>
                    `;
                    window.scrollTo({ top: document.getElementById('greenTextSection').offsetTop, behavior: 'smooth' });
                }, 2000);
            }, 2000);
        }
        
        function submitWithoutForward() {
            closeFinalSequence();
            // They didn't trust Vincent - show the green text
            document.getElementById('forwardChoice').style.display = 'none';
            document.getElementById('greenTextSection').style.display = 'block';
            window.scrollTo({ top: document.getElementById('greenTextSection').offsetTop, behavior: 'smooth' });
        }
        
        function finalSubmit() {
            stopGlitchEffects();
            
            // Show processing message
            document.getElementById('endingContent').innerHTML = `
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-family: 'VT323', monospace; font-size: 1.2rem; letter-spacing: 4px; color: var(--text-dim);">
                        PROCESSING RESULTS...
                    </div>
                </div>
            `;
            
            // Switch to ending page
            goToPage('endingPage');
            
            setTimeout(showEnding, 3000);
        }
        
        const observerOptions = {
            threshold: 0.3
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.target.dataset.forbidden === 'amber' && entry.isIntersecting) {
                    setTimeout(() => {
                        if (entry.isIntersecting) {
                            amberRead = true;
                        }
                    }, 1500);
                }
            });
        }, observerOptions);
        
        // Separate observer for green text trigger point - more sensitive
        const greenTriggerObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if ((entry.target.id === 'greenTriggerPoint' || entry.target.id === 'greenTriggerPointOwen') && entry.isIntersecting) {
                    // They've scrolled deep enough into the green text to read the accusation
                    greenRead = true;
                    startGlitchEffects();
                }
            });
        }, { threshold: 0.1 });
        
        // Glitch effects for green text reading
        let glitchInterval = null;
        let complianceDropInterval = null;
        
        function startGlitchEffects() {
            if (glitchInterval) return; // Already running
            
            const scoreEl = document.getElementById('score');
            const timerEl = document.getElementById('timer');
            const greenText = document.querySelector('[data-forbidden="green"]');
            let fakeScore = parseInt(scoreEl.textContent);
            
            // Start random glitch effects - less frequent
            glitchInterval = setInterval(() => {
                const effect = Math.random();
                
                if (effect < 0.15) {
                    // Screen flicker - reduced frequency
                    document.body.classList.add('glitch-active');
                    setTimeout(() => document.body.classList.remove('glitch-active'), 150);
                } else if (effect < 0.3) {
                    // Score jitter
                    scoreEl.parentElement.classList.add('score-glitching');
                    setTimeout(() => scoreEl.parentElement.classList.remove('score-glitching'), 300);
                } else if (effect < 0.45) {
                    // Random score fluctuation
                    const fluctuation = Math.floor(Math.random() * 10) - 5;
                    const displayScore = Math.max(0, Math.min(100, fakeScore + fluctuation));
                    scoreEl.textContent = displayScore;
                    setTimeout(() => scoreEl.textContent = fakeScore, 200);
                } else if (effect < 0.6) {
                    // Highlight random letters in green text
                    highlightRandomLetters(greenText);
                } else if (effect < 0.7) {
                    // Brief background flash - much less frequent now
                    document.body.classList.add('screen-flash');
                    setTimeout(() => document.body.classList.remove('screen-flash'), 150);
                } else {
                    // Flicker "read" words to death color
                    flickerReadWords();
                }
            }, 1200);  // Slower interval overall
            
            // Slowly drop compliance score
            complianceDropInterval = setInterval(() => {
                if (fakeScore > 15) {
                    fakeScore -= Math.floor(Math.random() * 3) + 1;
                    scoreEl.textContent = fakeScore;
                    
                    if (fakeScore < 50) {
                        timerEl.classList.add('compliance-dropping');
                    }
                }
            }, 2000);
        }
        
        function highlightRandomLetters(container) {
            if (!container) return;
            
            const textNodes = [];
            const walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null, false);
            while (walker.nextNode()) {
                if (walker.currentNode.textContent.trim()) {
                    textNodes.push(walker.currentNode);
                }
            }
            
            if (textNodes.length === 0) return;
            
            // Pick a random text node
            const randomNode = textNodes[Math.floor(Math.random() * textNodes.length)];
            const text = randomNode.textContent;
            
            if (text.length < 3) return;
            
            // Pick random position
            const startPos = Math.floor(Math.random() * (text.length - 2));
            const length = Math.min(3, text.length - startPos);
            
            // Create highlighted span
            const before = text.substring(0, startPos);
            const highlight = text.substring(startPos, startPos + length);
            const after = text.substring(startPos + length);
            
            const span = document.createElement('span');
            span.className = 'glitch-letter';
            span.textContent = highlight;
            
            const parent = randomNode.parentNode;
            const frag = document.createDocumentFragment();
            frag.appendChild(document.createTextNode(before));
            frag.appendChild(span);
            frag.appendChild(document.createTextNode(after));
            
            parent.replaceChild(frag, randomNode);
            
            // Remove the span after animation
            setTimeout(() => {
                if (span.parentNode) {
                    span.parentNode.replaceChild(document.createTextNode(highlight), span);
                }
            }, 400);
        }
        
        // Flicker words containing "read" to death red color
        function flickerReadWords() {
            const test6 = document.getElementById('test6');
            if (!test6 || !test6.classList.contains('active')) return;
            
            const greenText = test6.querySelector('.green-text');
            if (!greenText) return;
            
            // Find all text content and look for "read" variations
            const readPatterns = ['read', 'Read', 'READ', 'reading', 'Reading'];
            const allText = greenText.querySelectorAll('*');
            
            allText.forEach(el => {
                if (el.children.length === 0 && el.textContent) {
                    readPatterns.forEach(pattern => {
                        if (el.textContent.includes(pattern) && Math.random() < 0.3) {
                            const originalColor = el.style.color || '';
                            el.style.color = '#8b0000';
                            el.style.textShadow = '0 0 8px rgba(139, 0, 0, 0.6)';
                            
                            // Flicker back at random time
                            const flickerBack = 150 + Math.random() * 300;
                            setTimeout(() => {
                                el.style.color = originalColor;
                                el.style.textShadow = '';
                            }, flickerBack);
                        }
                    });
                }
            });
        }
        
        function stopGlitchEffects() {
            if (glitchInterval) {
                clearInterval(glitchInterval);
                glitchInterval = null;
            }
            if (complianceDropInterval) {
                clearInterval(complianceDropInterval);
                complianceDropInterval = null;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize score display at 75%
            document.getElementById('score').textContent = currentCompliance;
            
            // Initialize employee display (redacted on first play)
            updateEmployeeDisplay();
            
            // Animate title page timestamp
            animateTitleTimestamp();
            
            document.querySelectorAll('[data-forbidden="amber"]').forEach(el => {
                observer.observe(el);
                el.addEventListener('mousedown', () => {
                    amberRead = true;
                });
            });
            
            // Set up green text trigger
            const greenTrigger = document.getElementById('greenTriggerPoint');
            if (greenTrigger) {
                greenTriggerObserver.observe(greenTrigger);
            }
            
            // Also observe Owen's green trigger point
            const greenTriggerOwen = document.getElementById('greenTriggerPointOwen');
            if (greenTriggerOwen) {
                greenTriggerObserver.observe(greenTriggerOwen);
            }
            
            // Also trigger on any interaction with green text
            const greenText = document.querySelector('[data-forbidden="green"]');
            if (greenText) {
                greenText.addEventListener('mousedown', () => {
                    greenRead = true;
                });
                greenText.addEventListener('touchstart', () => {
                    greenRead = true;
                });
            }
        });
        
        // Animate the title page timestamp with typing effect
        function animateTitleTimestamp() {
            const timestampEl = document.getElementById('titleTimestamp');
            if (!timestampEl) return;
            
            const now = new Date();
            const year = '████';
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const mins = String(now.getMinutes()).padStart(2, '0');
            const secs = String(now.getSeconds()).padStart(2, '0');
            
            const fullTimestamp = `${year}.${month}.${day} — ${hours}:${mins}:${secs} UTC`;
            let index = 0;
            
            // Start after boot animation
            setTimeout(() => {
                const typeInterval = setInterval(() => {
                    if (index <= fullTimestamp.length) {
                        timestampEl.textContent = fullTimestamp.substring(0, index) + (index < fullTimestamp.length ? '█' : '');
                        index++;
                    } else {
                        clearInterval(typeInterval);
                        // Update seconds in real-time after typing completes
                        setInterval(() => {
                            const n = new Date();
                            const h = String(n.getHours()).padStart(2, '0');
                            const m = String(n.getMinutes()).padStart(2, '0');
                            const s = String(n.getSeconds()).padStart(2, '0');
                            timestampEl.textContent = `${year}.${month}.${day} — ${h}:${m}:${s} UTC`;
                        }, 1000);
                    }
                }, 50);
            }, 800);
        }
        
        function showEnding() {
            clearInterval(timerInterval);
            
            if (greenRead && !forwardedToOwen) {
                // They read green text but didn't forward - FAILED
                triggerTermination();
            } else if (greenRead && forwardedToOwen) {
                // They forwarded and read the promotion message - PASSED
                showPromotionEnding();
            } else if (amberRead) {
                showAmberEnding();
            } else {
                showObedientEnding();
            }
        }
        
        function showObedientEnding() {
            const endingContent = document.getElementById('endingContent');
            
            const displayName = playerName || 'UNKNOWN';
            const employeeId = playthroughCount === 0 ? '██-████-█' : 'OW-7734-B';
            const nameColor = playthroughCount === 0 ? 'var(--text-bright)' : '#f4d19b';
            
            // Different ending box based on whether they forwarded
            const endingBox = forwardedToOwen ? `
                    <div class="ending-restart owen-login-large" onclick="restartFromCompletion()">
                        <div class="login-prompt-large">ALTERNATE LOGIN DETECTED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ WELLS, OWEN</div>
                        <div class="login-id-large">ID: OW-7734-B · SECTOR 4</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[AUTHENTICATE]</div>
                    </div>
            ` : `
                    <div class="ending-restart owen-login-large" onclick="location.reload()">
                        <div class="login-prompt-large">SESSION TERMINATED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ RESTART ASSESSMENT</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[BEGIN AGAIN]</div>
                    </div>
            `;
            
            endingContent.innerHTML = `
                <div class="ending-page" style="min-height: auto; padding: 48px 24px;">
                    <div class="ending-logo">SECTOR 4</div>
                    
                    <div class="ending-main">
                        ASSESSMENT<br>COMPLETE
                    </div>
                    <div class="ending-form">FORM 7734-B — PROCESSED</div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div class="ending-meta">
                        <div class="ending-status">EMPLOYEE: <span style="color: ${nameColor};">${displayName}</span></div>
                        <div class="ending-status">ID: ${employeeId}</div>
                        <div class="ending-status">STATUS: <span style="color: var(--green);">APPROVED FOR INTEGRATION</span></div>
                        <div class="ending-verdict-text">COMPLIANCE SCORE: 100%</div>
                    </div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div style="font-size: 0.75rem; color: var(--text-secondary); line-height: 2; margin: 24px 0;">
                        Thank you for your cooperation.<br>
                        You may now close this window and return to your duties.<br><br>
                        Your shift begins in 3 hours.
                    </div>
                    
                    ${endingBox}
                </div>
            `;
        }
        
        function showAmberEnding() {
            const endingContent = document.getElementById('endingContent');
            
            const displayName = playerName || 'UNKNOWN';
            const employeeId = playthroughCount === 0 ? '██-████-█' : 'OW-7734-B';
            const nameColor = playthroughCount === 0 ? 'var(--text-bright)' : '#f4d19b';
            
            // Different ending box based on whether they forwarded
            const endingBox = forwardedToOwen ? `
                    <div class="ending-restart owen-login-large" onclick="restartFromCompletion()">
                        <div class="login-prompt-large">ALTERNATE LOGIN DETECTED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ WELLS, OWEN</div>
                        <div class="login-id-large">ID: OW-7734-B · SECTOR 4</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[AUTHENTICATE]</div>
                    </div>
            ` : `
                    <div class="ending-restart owen-login-large" onclick="location.reload()">
                        <div class="login-prompt-large">SESSION TERMINATED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ RESTART ASSESSMENT</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[BEGIN AGAIN]</div>
                    </div>
            `;
            
            endingContent.innerHTML = `
                <div class="ending-page" style="min-height: auto; padding: 48px 24px;">
                    <div class="ending-logo">SECTOR 4</div>
                    
                    <div class="ending-main">
                        ASSESSMENT<br>COMPLETE
                    </div>
                    <div class="ending-form">FORM 7734-B — PROCESSED</div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div class="ending-meta">
                        <div class="ending-status">EMPLOYEE: <span style="color: ${nameColor};">${displayName}</span></div>
                        <div class="ending-status">ID: ${employeeId}</div>
                        <div class="ending-status">STATUS: <span style="color: var(--amber);">CONDITIONAL APPROVAL</span></div>
                        <div class="ending-verdict-text">COMPLIANCE SCORE: 87% — CATEGORY: INFORMED PARTICIPANT</div>
                    </div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div style="font-size: 0.75rem; color: var(--text-secondary); line-height: 2; margin: 24px 0;">
                        You have demonstrated curiosity within acceptable parameters.<br>
                        You understand the system and choose to participate.<br><br>
                        This makes you valuable.<br><br>
                        Report to your assigned station.
                    </div>
                    
                    ${endingBox}
                </div>
            `;
        }
        
        function showPromotionEnding() {
            const endingContent = document.getElementById('endingContent');
            
            const displayName = playerName || 'UNKNOWN';
            const employeeId = playthroughCount === 0 ? '██-████-█' : 'OW-7734-B';
            const nameColor = playthroughCount === 0 ? 'var(--text-bright)' : '#f4d19b';
            
            endingContent.innerHTML = `
                <div class="ending-page" style="min-height: auto; padding: 48px 24px;">
                    <div class="ending-logo">SECTOR 4</div>
                    
                    <div class="ending-main">
                        ASSESSMENT<br>COMPLETE
                    </div>
                    <div class="ending-form">FORM 7734-B — PROCESSED</div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div class="ending-meta">
                        <div class="ending-status">EMPLOYEE: <span style="color: ${nameColor};">${displayName}</span></div>
                        <div class="ending-status">ID: ${employeeId}</div>
                        <div class="ending-status">STATUS: <span style="color: var(--green);">PROMOTED</span></div>
                        <div class="ending-verdict-text">COMPLIANCE SCORE: 94% — CATEGORY: INDEPENDENT ACTOR</div>
                    </div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div style="font-size: 0.75rem; color: var(--text-secondary); line-height: 2; margin: 24px 0;">
                        Your capacity for independent action has been noted.<br>
                        Report to Corridor 7, Room 114 within the next 3 hours.<br><br>
                        Bring nothing. Tell no one.
                    </div>
                    
                    <div class="ending-restart owen-login-large" onclick="restartFromCompletion()">
                        <div class="login-prompt-large">ALTERNATE LOGIN DETECTED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ WELLS, OWEN</div>
                        <div class="login-id-large">ID: OW-7734-B · SECTOR 4</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[AUTHENTICATE]</div>
                    </div>
                </div>
            `;
        }
        
        function triggerTermination() {
            const overlay = document.getElementById('terminationOverlay');
            const text = document.getElementById('terminationText');
            
            overlay.style.display = 'block';
            setTimeout(() => {
                overlay.style.opacity = '1';
            }, 100);
            
            setTimeout(() => {
                text.style.display = 'block';
                setTimeout(() => {
                    text.style.opacity = '1';
                    showTerminationSequence();
                }, 100);
            }, 2000);
        }
        
        function showTerminationSequence() {
            const text = document.getElementById('terminationText');
            
            // Use the player's entered name
            const displayName = playerName || 'UNKNOWN';
            
            // Create the stylized employee file page
            text.innerHTML = `
                <div class="subject-file-page">
                    <div class="subject-file-corner subject-file-corner-tl"></div>
                    <div class="subject-file-corner subject-file-corner-br"></div>
                    
                    <div class="subject-file-header">
                        <div class="subject-file-sector">SECTOR 4 — PERSONNEL DIVISION</div>
                        <div class="subject-file-protocol">SUBJECT FILE RETRIEVAL</div>
                    </div>
                    
                    <div class="subject-file-content">
                        <div class="subject-file-status" id="subjectStatus">RETRIEVING SUBJECT FILE...</div>
                        
                        <div class="subject-file-card" id="subjectCard">
                            <div class="subject-file-label">EMPLOYEE</div>
                            <div class="subject-file-name">${displayName}</div>
                            
                            <div class="subject-file-divider"></div>
                            
                            <div class="subject-file-row">
                                <span class="subject-file-key">STATUS</span>
                                <span class="subject-file-value subject-file-danger">NON-COMPLIANT</span>
                            </div>
                            
                            <div class="subject-file-row">
                                <span class="subject-file-key">CLASSIFICATION</span>
                                <span class="subject-file-value subject-file-danger">LOYALTY FAILURE</span>
                            </div>
                            
                            <div class="subject-file-row">
                                <span class="subject-file-key">THREAT LEVEL</span>
                                <span class="subject-file-value">MINIMAL</span>
                            </div>
                            
                            <div class="subject-file-row">
                                <span class="subject-file-key">USEFULNESS</span>
                                <span class="subject-file-value subject-file-dim">NONE</span>
                            </div>
                            
                            <div class="subject-file-divider"></div>
                            
                            <div class="subject-file-verdict">
                                <div class="subject-file-verdict-label">VERDICT</div>
                                <div class="subject-file-verdict-value">TERMINATION</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subject-file-footer">
                        <div class="subject-file-trace">Form 7734-B · Personnel Action · Final</div>
                    </div>
                </div>
            `;
            
            text.style.width = '100%';
            text.style.maxWidth = '100%';
            text.style.height = '100%';
            
            // Animate the reveal
            const status = document.getElementById('subjectStatus');
            const card = document.getElementById('subjectCard');
            
            card.style.opacity = '0';
            card.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                status.textContent = 'FILE LOCATED · ACCESSING...';
            }, 1000);
            
            setTimeout(() => {
                status.textContent = 'ACCESS GRANTED';
                status.style.color = 'var(--coral)';
                card.style.transition = 'all 0.6s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 2000);
            
            setTimeout(showFinalMessage, 6000);
        }
        
        function showFinalMessage() {
            const text = document.getElementById('terminationText');
            
            text.innerHTML = `
                <div class="ending-page">
                    <div class="ending-logo">SECTOR 4</div>
                    
                    <div class="ending-main">
                        ASSESSMENT<br>COMPLETE
                    </div>
                    <div class="ending-form">FORM 7734-B — CLOSED</div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div class="ending-meta">
                        <div class="ending-status">STATUS: <span style="color: #8b0000;">TERMINATED</span></div>
                        <div class="ending-verdict-text">LOYALTY FAILURE — NO FURTHER ACTION REQUIRED</div>
                    </div>
                    
                    <div class="ending-divider-line"></div>
                    
                    <div class="ending-restart owen-login-large" onclick="location.reload()">
                        <div class="login-prompt-large">SESSION TERMINATED</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-user-large">▸ RESTART ASSESSMENT</div>
                        <div class="login-divider">────────────────────</div>
                        <div class="login-action-large">[BEGIN AGAIN]</div>
                    </div>
                </div>
            `;
            
            text.style.width = '100%';
            text.style.maxWidth = '100%';
            text.style.height = '100%';
        }
        
        function restartAssessment() {
            // Hide termination overlay
            const overlay = document.getElementById('terminationOverlay');
            const text = document.getElementById('terminationText');
            overlay.style.opacity = '0';
            text.style.opacity = '0';
            
            setTimeout(() => {
                overlay.style.display = 'none';
                text.style.display = 'none';
                
                // Go to Owen's dedicated reading page
                goToOwenPage();
            }, 500);
        }
        
        function updateEmployeeDisplay() {
            const nameEl = document.getElementById('employeeName');
            const numEl = document.getElementById('employeeNum');
            const playerNameEl = document.getElementById('playerNameDisplay');
            
            if (playthroughCount === 0) {
                // First playthrough - redacted
                if (nameEl) {
                    nameEl.textContent = '█████ ██';
                    nameEl.className = 'redacted-name';
                }
                if (numEl) numEl.textContent = '████-██';
                
                // Remove Owen view class
                document.body.classList.remove('owen-view');
                
                // Reset Section 3 redactions
                document.querySelectorAll('.redact-s3').forEach(el => {
                    el.classList.remove('revealed');
                });
                
                // Reset Rabbit name redactions
                document.querySelectorAll('.redact-rabbit').forEach(el => {
                    el.classList.remove('revealed');
                });
                
                // Show stranger green text, hide Owen's
                const greenStranger = document.getElementById('greenTextStranger');
                const greenOwen = document.getElementById('greenTextOwen');
                if (greenStranger) greenStranger.style.display = 'block';
                if (greenOwen) greenOwen.style.display = 'none';
                
                // Show stranger P.S., hide Owen's
                const psStranger = document.querySelector('.ps-stranger');
                const psOwen = document.querySelector('.ps-owen');
                if (psStranger) psStranger.style.display = 'inline';
                if (psOwen) psOwen.style.display = 'none';
                
                // Show ant story, hide Cohen
                const antStory = document.querySelector('.ant-story-stranger');
                const cohenStory = document.querySelector('.cohen-story-owen');
                if (antStory) antStory.style.display = 'block';
                if (cohenStory) cohenStory.style.display = 'none';
            } else {
                // Second+ playthrough - revealed as Owen
                if (nameEl) {
                    nameEl.textContent = 'OWEN W.';
                    nameEl.className = 'revealed-name';
                }
                if (numEl) numEl.textContent = '7734-OW';
                
                // Update player name display to Owen
                playerName = 'WELLS, OWEN';
                if (playerNameEl) playerNameEl.textContent = playerName;
                
                // Add Owen view class for brighter amber
                document.body.classList.add('owen-view');
                
                // Reveal Section 3 redactions
                document.querySelectorAll('.redact-s3').forEach(el => {
                    el.classList.add('revealed');
                    const revealedText = el.getAttribute('data-revealed');
                    if (revealedText) {
                        el.textContent = revealedText;
                    }
                });
                
                // Reveal Rabbit name redactions
                document.querySelectorAll('.redact-rabbit').forEach(el => {
                    el.classList.add('revealed');
                    const revealedText = el.getAttribute('data-revealed');
                    if (revealedText) {
                        el.textContent = revealedText;
                    }
                });
                
                // Show Owen's green text, hide stranger's
                const greenStranger = document.getElementById('greenTextStranger');
                const greenOwen = document.getElementById('greenTextOwen');
                if (greenStranger) greenStranger.style.display = 'none';
                if (greenOwen) greenOwen.style.display = 'block';
                
                // Show Owen's P.S., hide stranger's
                const psStranger = document.querySelector('.ps-stranger');
                const psOwen = document.querySelector('.ps-owen');
                if (psStranger) psStranger.style.display = 'none';
                if (psOwen) psOwen.style.display = 'inline';
                
                // Show Cohen, hide ant story
                const antStory = document.querySelector('.ant-story-stranger');
                const cohenStory = document.querySelector('.cohen-story-owen');
                if (antStory) antStory.style.display = 'none';
                if (cohenStory) cohenStory.style.display = 'block';
            }
        }
        
        function restartFromCompletion() {
            // Increment playthrough count
            playthroughCount++;
            
            // Update displays for Owen's playthrough
            updateEmployeeDisplay();
            
            // Start the spooky boot sequence
            startOwenBootSequence();
        }
        
        function startOwenBootSequence() {
            // Create boot overlay
            const overlay = document.createElement('div');
            overlay.id = 'owenBootOverlay';
            overlay.className = 'owen-boot-overlay';
            document.body.appendChild(overlay);
            
            // Boot sequence content
            const bootLines = [
                { text: 'AUTHENTICATING...', delay: 0, duration: 800 },
                { text: 'CREDENTIALS VERIFIED', delay: 1000, duration: 600 },
                { text: '', delay: 1800, duration: 100 },
                { text: '> WELLS, OWEN', delay: 2000, duration: 400, class: 'boot-name' },
                { text: '> ID: OW-7734-B', delay: 2500, duration: 400 },
                { text: '', delay: 3100, duration: 100 },
                { text: 'LOADING USER PROFILE...', delay: 3300, duration: 600 },
                { text: '', delay: 4100, duration: 100 },
                { text: '█░░░░░░░░░', delay: 4300, duration: 200, class: 'boot-progress' },
                { text: '███░░░░░░░', delay: 4600, duration: 200, class: 'boot-progress' },
                { text: '█████░░░░░', delay: 4900, duration: 200, class: 'boot-progress' },
                { text: '███████░░░', delay: 5200, duration: 200, class: 'boot-progress' },
                { text: '', delay: 5600, duration: 100 },
                { text: 'WARNING: RESTRICTED ACCESS DETECTED', delay: 5800, duration: 500, class: 'boot-warning' },
                { text: '', delay: 6500, duration: 100 },
                { text: 'he found you', delay: 6800, duration: 400, class: 'boot-glitch' },
                { text: '', delay: 7400, duration: 100 },
                { text: 'CLEARANCE: FULL ACCESS GRANTED', delay: 7600, duration: 600, class: 'boot-success' },
                { text: '', delay: 8400, duration: 100 },
                { text: 'remember me', delay: 8600, duration: 300, class: 'boot-glitch' },
                { text: '', delay: 9100, duration: 100 },
                { text: 'INITIALIZING SESSION...', delay: 9300, duration: 800 },
            ];
            
            let currentContent = '';
            const terminal = document.createElement('div');
            terminal.className = 'boot-terminal';
            overlay.appendChild(terminal);
            
            bootLines.forEach((line, index) => {
                setTimeout(() => {
                    if (line.text === '') {
                        // Just a spacer
                        return;
                    }
                    
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line ' + (line.class || '');
                    lineEl.textContent = line.text;
                    
                    // Glitch lines appear and disappear
                    if (line.class === 'boot-glitch') {
                        lineEl.style.opacity = '0';
                        terminal.appendChild(lineEl);
                        setTimeout(() => { lineEl.style.opacity = '1'; }, 50);
                        setTimeout(() => { 
                            lineEl.style.opacity = '0';
                            setTimeout(() => lineEl.remove(), 200);
                        }, line.duration);
                    } 
                    // Progress bars replace each other
                    else if (line.class === 'boot-progress') {
                        const existing = terminal.querySelector('.boot-progress');
                        if (existing) existing.remove();
                        terminal.appendChild(lineEl);
                    }
                    else {
                        terminal.appendChild(lineEl);
                    }
                    
                    // Auto-scroll terminal
                    terminal.scrollTop = terminal.scrollHeight;
                }, line.delay);
            });
            
            // Final transition
            setTimeout(() => {
                overlay.classList.add('fading');
                setTimeout(() => {
                    overlay.remove();
                    goToOwenPage();
                }, 1000);
            }, 10500);
        }
        
        function goToOwenPage() {
            // Hide timer
            const timer = document.getElementById('timer');
            const timerSpacer = document.getElementById('timerSpacer');
            if (timer) timer.classList.remove('visible');
            if (timerSpacer) timerSpacer.classList.remove('visible');
            
            // Switch to Owen's page
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('owenPage').classList.add('active');
            window.scrollTo(0, 0);
            
            // Set up scroll listener for white fade effect
            setupOwenScrollEffect();
            
            // Music removed from Owen's page
            // startOwenPageMusic();
        }
        
        // ═══════════════════════════════════════════════════════════════
        // OWEN'S THEME - Progressive Build with Fade-ins
        // Duration: 5:52 (352 seconds), loops continuously
        // Chord Progression: Em - C - G - D
        // ═══════════════════════════════════════════════════════════════
        
        let owenAudioContext = null;
        let owenGainNode = null;
        let owenMusicPlaying = false;
        let owenStartTime = 0;
        let owenLoopTimeout = null;
        
        const OWEN_TOTAL_DURATION = 352;
        const OWEN_STAGE_DURATION = 32;
        const OWEN_LOOP_DURATION = 16;
        
        const owenNotes = {
            'C2': 65.41, 'D2': 73.42, 'E2': 82.41, 'F2': 87.31, 'Fs2': 92.50, 'G2': 98.00, 'A2': 110.00, 'B2': 123.47,
            'C3': 130.81, 'D3': 146.83, 'E3': 164.81, 'F3': 174.61, 'Fs3': 185.00, 'G3': 196.00, 'A3': 220.00, 'B3': 246.94,
            'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23, 'Fs4': 369.99, 'G4': 392.00, 'A4': 440.00, 'B4': 493.88,
            'C5': 523.25, 'D5': 587.33, 'E5': 659.25, 'F5': 698.46, 'Fs5': 739.99, 'G5': 783.99, 'A5': 880.00, 'B5': 987.77,
            'C6': 1046.50, 'D6': 1174.66, 'E6': 1318.51
        };
        
        const owenQ = 0.5, owenH = 1.0, owenBar = 2.0;
        
        // Stage when each layer first appears (for fade-in calculation)
        const layerIntroStage = {
            'sub': 0, 'bass': 1, 'pad': 2, 'swell': 3,
            'arp': 5, 'lowmel': 6, 'bell': 7, 'fifth': 8, 'pluck': 9
        };
        
        // Which layers are active at each stage
        const owenStageConfig = [
            { name: 'Sub Bass', layers: ['sub'] },
            { name: '+ Bass', layers: ['sub', 'bass'] },
            { name: '+ Warm Pad', layers: ['sub', 'bass', 'pad'] },
            { name: '+ Swell Pad', layers: ['sub', 'bass', 'pad', 'swell'] },
            { name: 'Building...', layers: ['sub', 'bass', 'pad', 'swell'] },
            { name: '+ Arpeggio', layers: ['sub', 'bass', 'pad', 'swell', 'arp'] },
            { name: '+ Low Melody', layers: ['sub', 'bass', 'pad', 'swell', 'arp', 'lowmel'] },
            { name: '+ Bell Tones', layers: ['sub', 'bass', 'pad', 'swell', 'arp', 'lowmel', 'bell'] },
            { name: '+ Fifth Drone', layers: ['sub', 'bass', 'pad', 'swell', 'arp', 'lowmel', 'bell', 'fifth'], fifthVol: 0.5 },
            { name: '+ Pluck Bass', layers: ['sub', 'bass', 'pad', 'swell', 'arp', 'lowmel', 'bell', 'fifth', 'pluck'], fifthVol: 0.75 },
            { name: 'Full Power', layers: ['sub', 'bass', 'pad', 'swell', 'arp', 'lowmel', 'bell', 'fifth', 'pluck'], fifthVol: 1.0 },
        ];
        
        function owenPlayNote(freq, start, dur, type, vol) {
            if (!owenAudioContext || vol <= 0) return;
            const osc = owenAudioContext.createOscillator();
            const g = owenAudioContext.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, owenAudioContext.currentTime + start);
            g.gain.setValueAtTime(0, owenAudioContext.currentTime + start);
            g.gain.linearRampToValueAtTime(vol, owenAudioContext.currentTime + start + 0.03);
            g.gain.setValueAtTime(vol * 0.7, owenAudioContext.currentTime + start + dur * 0.6);
            g.gain.linearRampToValueAtTime(0, owenAudioContext.currentTime + start + dur);
            osc.connect(g);
            g.connect(owenGainNode);
            osc.start(owenAudioContext.currentTime + start);
            osc.stop(owenAudioContext.currentTime + start + dur + 0.1);
        }
        
        function owenPlaySwellNote(freq, start, dur, vol) {
            if (!owenAudioContext || vol <= 0) return;
            const osc = owenAudioContext.createOscillator();
            const g = owenAudioContext.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, owenAudioContext.currentTime + start);
            g.gain.setValueAtTime(0, owenAudioContext.currentTime + start);
            g.gain.linearRampToValueAtTime(vol, owenAudioContext.currentTime + start + dur * 0.6);
            g.gain.linearRampToValueAtTime(0, owenAudioContext.currentTime + start + dur);
            osc.connect(g);
            g.connect(owenGainNode);
            osc.start(owenAudioContext.currentTime + start);
            osc.stop(owenAudioContext.currentTime + start + dur + 0.1);
        }
        
        function owenPlayBell(freq, start, vol) {
            if (!owenAudioContext || vol <= 0) return;
            const osc = owenAudioContext.createOscillator();
            const g = owenAudioContext.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, owenAudioContext.currentTime + start);
            g.gain.setValueAtTime(vol, owenAudioContext.currentTime + start);
            g.gain.exponentialRampToValueAtTime(0.001, owenAudioContext.currentTime + start + 1.5);
            osc.connect(g);
            g.connect(owenGainNode);
            osc.start(owenAudioContext.currentTime + start);
            osc.stop(owenAudioContext.currentTime + start + 1.6);
        }
        
        function getOwenLayerVolume(layer, elapsed) {
            const introStage = layerIntroStage[layer];
            const stageStartTime = introStage * OWEN_STAGE_DURATION;
            const stageEndTime = stageStartTime + OWEN_STAGE_DURATION;
            if (elapsed < stageStartTime) return 0;
            if (elapsed < stageEndTime) return (elapsed - stageStartTime) / OWEN_STAGE_DURATION;
            return 1;
        }
        
        function getCurrentOwenStage(elapsed) {
            return Math.min(10, Math.floor(elapsed / OWEN_STAGE_DURATION));
        }
        
        function playOwenPageLoop() {
            if (!owenMusicPlaying) return;
            
            const elapsed = (Date.now() - owenStartTime) / 1000;
            if (elapsed >= OWEN_TOTAL_DURATION) {
                owenStartTime = Date.now(); // Loop the song
            }
            
            const stage = getCurrentOwenStage(elapsed);
            const config = owenStageConfig[stage];
            const layers = config.layers;
            const n = owenNotes;
            const bar = owenBar;
            const q = owenQ;
            const h = owenH;
            
            // Calculate volume multipliers (fade-in effect)
            const subVol = getOwenLayerVolume('sub', elapsed);
            const bassVol = getOwenLayerVolume('bass', elapsed);
            const padVol = getOwenLayerVolume('pad', elapsed);
            const swellVol = getOwenLayerVolume('swell', elapsed);
            const arpVol = getOwenLayerVolume('arp', elapsed);
            const lowmelVol = getOwenLayerVolume('lowmel', elapsed);
            const bellVol = getOwenLayerVolume('bell', elapsed);
            const fifthVol = getOwenLayerVolume('fifth', elapsed) * (config.fifthVol || 1);
            const pluckVol = getOwenLayerVolume('pluck', elapsed);
            
            // Sub Bass
            if (layers.includes('sub') && subVol > 0) {
                [{ p: 'E2', t: 0 }, { p: 'C2', t: bar*2 }, { p: 'G2', t: bar*4 }, { p: 'D2', t: bar*6 }]
                .forEach(s => owenPlayNote(n[s.p], s.t, bar*1.9, 'sine', 0.12 * subVol));
            }
            
            // Bass
            if (layers.includes('bass') && bassVol > 0) {
                [{ p: 'E3', t: 0 }, { p: 'C3', t: bar*2 }, { p: 'G3', t: bar*4 }, { p: 'D3', t: bar*6 }]
                .forEach(b => owenPlayNote(n[b.p], b.t, bar*1.95, 'sine', 0.14 * bassVol));
            }
            
            // Warm Pad
            if (layers.includes('pad') && padVol > 0) {
                [[n.E4, n.G4, 0], [n.E4, n.G4, bar*2], [n.D4, n.G4, bar*4], [n.D4, n.Fs4, bar*6]]
                .forEach(([f1, f2, t]) => { 
                    owenPlayNote(f1, t, bar*1.9, 'sine', 0.05 * padVol);
                    owenPlayNote(f2, t, bar*1.9, 'sine', 0.05 * padVol);
                });
            }
            
            // Swell Pad
            if (layers.includes('swell') && swellVol > 0) {
                [[n.B4, 0], [n.G4, bar*2], [n.D4, bar*4], [n.A4, bar*6]]
                .forEach(([f, t]) => owenPlaySwellNote(f, t, bar*1.9, 0.06 * swellVol));
            }
            
            // Arpeggio
            if (layers.includes('arp') && arpVol > 0) {
                const arp = [
                    ['E4','G4','B4','G4',0], ['E4','G4','B4','G4',bar],
                    ['C4','E4','G4','E4',bar*2], ['C4','E4','G4','E4',bar*3],
                    ['G3','B3','D4','B3',bar*4], ['G3','B3','D4','B3',bar*5],
                    ['D4','Fs4','A4','Fs4',bar*6], ['D4','Fs4','A4','Fs4',bar*7]
                ];
                arp.forEach(([a,b,c,d,t]) => {
                    owenPlayNote(n[a], t, q*0.7, 'triangle', 0.04 * arpVol);
                    owenPlayNote(n[b], t+q, q*0.7, 'triangle', 0.04 * arpVol);
                    owenPlayNote(n[c], t+h, q*0.7, 'triangle', 0.04 * arpVol);
                    owenPlayNote(n[d], t+h+q, q*0.7, 'triangle', 0.04 * arpVol);
                });
            }
            
            // Low Melody
            if (layers.includes('lowmel') && lowmelVol > 0) {
                [{ p: 'B3', t: 0 }, { p: 'G3', t: bar }, { p: 'G3', t: bar*2 }, { p: 'E3', t: bar*3 },
                 { p: 'G3', t: bar*4 }, { p: 'D3', t: bar*5 }, { p: 'D3', t: bar*6 }, { p: 'A3', t: bar*7 }]
                .forEach(m => owenPlayNote(n[m.p], m.t, bar*0.85, 'triangle', 0.08 * lowmelVol));
            }
            
            // Bell Tones
            if (layers.includes('bell') && bellVol > 0) {
                [{ p: 'E6', t: 0 }, { p: 'C6', t: bar*2 }, { p: 'G5', t: bar*4 }, { p: 'D6', t: bar*6 }]
                .forEach(b => owenPlayBell(n[b.p], b.t, 0.03 * bellVol));
            }
            
            // Fifth Drone
            if (layers.includes('fifth') && fifthVol > 0) {
                [[n.E3, n.B3, 0], [n.C3, n.G3, bar*2], [n.G3, n.D4, bar*4], [n.D3, n.A3, bar*6]]
                .forEach(([r, f, t]) => {
                    owenPlayNote(r, t, bar*1.9, 'sawtooth', 0.025 * fifthVol);
                    owenPlayNote(f, t, bar*1.9, 'sawtooth', 0.02 * fifthVol);
                });
            }
            
            // Pluck Bass
            if (layers.includes('pluck') && pluckVol > 0) {
                const plucks = [
                    'E3','E3','E3','E3', 'E3','E3','E3','E3',
                    'C3','C3','C3','C3', 'C3','C3','C3','C3',
                    'G3','G3','G3','G3', 'G3','G3','G3','G3',
                    'D3','D3','D3','D3', 'D3','D3','D3','D3'
                ];
                plucks.forEach((p, i) => owenPlayNote(n[p], i*q, q*0.25, 'triangle', 0.1 * pluckVol));
            }
            
            owenLoopTimeout = setTimeout(playOwenPageLoop, OWEN_LOOP_DURATION * 1000);
        }
        
        function startOwenPageMusic() {
            if (owenAudioContext) return; // Already playing
            
            owenAudioContext = new (window.AudioContext || window.webkitAudioContext)();
            owenGainNode = owenAudioContext.createGain();
            owenGainNode.connect(owenAudioContext.destination);
            owenGainNode.gain.value = 0.02; // Start very quiet
            
            owenMusicPlaying = true;
            owenStartTime = Date.now();
            playOwenPageLoop();
        }
        
        function stopOwenPageMusic() {
            owenMusicPlaying = false;
            if (owenLoopTimeout) clearTimeout(owenLoopTimeout);
            if (owenAudioContext) {
                owenAudioContext.close();
                owenAudioContext = null;
                owenGainNode = null;
            }
        }
        
        function setOwenMusicVolume(volume) {
            if (owenGainNode) {
                owenGainNode.gain.value = Math.max(0, Math.min(1, volume));
            }
        }
        
        function setupOwenScrollEffect() {
            const owenPage = document.getElementById('owenPage');
            const whiteOverlay = document.getElementById('owenWhiteOverlay');
            const whiteFadeZone = document.getElementById('whiteFadeZone');
            const owenCredits = document.getElementById('owenCredits');
            
            if (!owenPage || !whiteOverlay) return;
            
            let ticking = false;
            
            function handleOwenScroll() {
                if (!owenPage.classList.contains('active')) return;
                
                if (!ticking) {
                    requestAnimationFrame(function() {
                        const scrollY = window.scrollY;
                        const pageHeight = document.documentElement.scrollHeight - window.innerHeight;
                        const scrollPercent = pageHeight > 0 ? scrollY / pageHeight : 0;
                        
                        // Get all animated elements that should stop when fading
                        const animatedElements = document.querySelectorAll('.redacted-waiting');
                        
                        // Start fading to white in the last 30% of scroll
                        if (scrollPercent > 0.7) {
                            const fadePercent = (scrollPercent - 0.7) / 0.3; // 0 to 1 in last 30%
                            whiteOverlay.style.opacity = Math.min(fadePercent * 0.98, 0.98);
                            
                            // Stop animations and hide elements as we fade
                            animatedElements.forEach(el => {
                                el.style.animation = 'none';
                                el.style.opacity = Math.max(1 - fadePercent * 2, 0);
                            });
                        } else {
                            whiteOverlay.style.opacity = 0;
                            // Restore animations when not in fade zone
                            animatedElements.forEach(el => {
                                el.style.animation = '';
                                el.style.opacity = '';
                            });
                        }
                        
                        // When very close to bottom, make overlay fully white except credits
                        if (scrollPercent > 0.95) {
                            whiteOverlay.style.opacity = 1;
                        }
                        
                        ticking = false;
                    });
                    ticking = true;
                }
            }
            
            window.addEventListener('scroll', handleOwenScroll, { passive: true });
        }
        
        console.log('%cWARNING', 'color: #ffa040; font-size: 20px; font-weight: bold;');
        console.log('%cThis assessment is monitored.', 'color: #858585; font-size: 12px;');
        
        // White fade effect for white room story
        let whiteFadeTriggered = false;
        window.addEventListener('scroll', function() {
            if (whiteFadeTriggered) return;
            
            const whiteRoomStory = document.getElementById('whiteRoomStory');
            if (!whiteRoomStory) return;
            
            const rect = whiteRoomStory.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            
            // Trigger when user scrolls 30% through the white room story
            if (rect.top < viewportHeight * 0.4 && rect.bottom > viewportHeight * 0.3) {
                whiteFadeTriggered = true;
                whiteRoomStory.classList.add('fading-to-white');
            }
        }, { passive: true });
        
        // ============ REPORT FUNCTIONALITY ============
        function openReportModal() {
            document.getElementById('reportModal').classList.add('active');
            document.getElementById('reportText').focus();
        }
        
        function closeReportModal() {
            document.getElementById('reportModal').classList.remove('active');
            // Reset form after closing
            setTimeout(() => {
                document.getElementById('reportForm').classList.remove('hidden');
                document.getElementById('reportConfirmation').classList.remove('active');
                document.getElementById('reportText').value = '';
                document.getElementById('reportEmail').value = '';
            }, 300);
        }
        
        function submitReport() {
            const reportText = document.getElementById('reportText').value.trim();
            const reportEmail = document.getElementById('reportEmail').value.trim();
            if (!reportText) return;
            
            const submitBtn = document.getElementById('reportSubmitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'SUBMITTING...';
            
            // Collect metadata
            const reportData = {
                message: reportText,
                email: reportEmail || 'Not provided',
                timestamp: new Date().toISOString(),
                timeOnPage: Math.floor((Date.now() - (startTime || Date.now())) / 1000),
                currentSection: currentTest,
                complianceScore: document.getElementById('score').textContent,
                amberRead: amberRead,
                greenRead: greenRead,
                userAgent: navigator.userAgent
            };
            
            // === FORM ENDPOINT ===
            const FORM_ENDPOINT = 'https://formspree.io/f/xpqqqvzz';
            
            fetch(FORM_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(reportData)
            })
            .then(response => {
                showReportConfirmation();
            })
            .catch(error => {
                // Still show confirmation even if submission fails
                // (for demo purposes / offline testing)
                console.log('Report data:', reportData);
                showReportConfirmation();
            });
        }
        
        function showReportConfirmation() {
            document.getElementById('reportForm').classList.add('hidden');
            document.getElementById('reportConfirmation').classList.add('active');
            
            // Auto-close after 3 seconds
            setTimeout(() => {
                closeReportModal();
            }, 3000);
        }
        
        // Close modal on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.getElementById('reportModal').classList.contains('active')) {
                closeReportModal();
            }
        });
        
        // Close modal on background click
        document.getElementById('reportModal').addEventListener('click', (e) => {
            if (e.target.id === 'reportModal') {
                closeReportModal();
            }
        });
        
        // ============ OWEN'S RIGGED BLACKJACK ============
        let owenBjDeck = [];
        let owenBjPlayerHand = [];
        let owenBjDealerHand = [];
        let owenBjWins = 0;
        let owenBjLosses = 0;
        let owenBjGameOver = false;
        
        function owenCreateDeck() {
            const suits = ['♠', '♥', '♦', '♣'];
            const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            owenBjDeck = [];
            for (let suit of suits) {
                for (let value of values) {
                    let numValue = parseInt(value) || (value === 'A' ? 11 : 10);
                    owenBjDeck.push({ suit, value, numValue });
                }
            }
            // Shuffle
            for (let i = owenBjDeck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [owenBjDeck[i], owenBjDeck[j]] = [owenBjDeck[j], owenBjDeck[i]];
            }
        }
        
        function owenDrawCard() {
            return owenBjDeck.pop();
        }
        
        function owenCalculateHand(hand) {
            let total = 0;
            let aces = 0;
            for (let card of hand) {
                total += card.numValue;
                if (card.value === 'A') aces++;
            }
            while (total > 21 && aces > 0) {
                total -= 10;
                aces--;
            }
            return total;
        }
        
        function owenRenderCard(card, hidden = false) {
            if (hidden) {
                return '<div class="card hidden">?</div>';
            }
            return '<div class="card">' + card.value + card.suit + '</div>';
        }
        
        function owenUpdateDisplay() {
            const playerCards = document.getElementById('owenPlayerCards');
            const dealerCards = document.getElementById('owenDealerCards');
            const playerValue = document.getElementById('owenPlayerValue');
            const dealerValue = document.getElementById('owenDealerValue');
            
            playerCards.innerHTML = owenBjPlayerHand.map(c => owenRenderCard(c)).join('');
            playerValue.textContent = 'VALUE: ' + owenCalculateHand(owenBjPlayerHand);
            
            if (owenBjGameOver) {
                dealerCards.innerHTML = owenBjDealerHand.map(c => owenRenderCard(c)).join('');
                dealerValue.textContent = 'VALUE: ' + owenCalculateHand(owenBjDealerHand);
            } else {
                dealerCards.innerHTML = owenRenderCard(owenBjDealerHand[0]) + owenRenderCard(owenBjDealerHand[1], true);
                dealerValue.textContent = 'VALUE: ' + owenBjDealerHand[0].numValue;
            }
        }
        
        function owenNewGame() {
            owenCreateDeck();
            owenBjPlayerHand = [owenDrawCard(), owenDrawCard()];
            owenBjDealerHand = [owenDrawCard(), owenDrawCard()];
            owenBjGameOver = false;
            
            document.getElementById('owenHitBtn').style.display = '';
            document.getElementById('owenStandBtn').style.display = '';
            document.getElementById('owenNewGameBtn').style.display = 'none';
            document.getElementById('owenBjMessage').textContent = '';
            
            owenUpdateDisplay();
        }
        
        function owenHit() {
            if (owenBjGameOver) return;
            owenBjPlayerHand.push(owenDrawCard());
            owenUpdateDisplay();
            
            if (owenCalculateHand(owenBjPlayerHand) > 21) {
                owenEndGame('BUST! You went over 21.', false);
            }
        }
        
        function owenStand() {
            if (owenBjGameOver) return;
            
            // RIGGED: Dealer always busts when Owen stands
            // Dealer draws until bust
            while (owenCalculateHand(owenBjDealerHand) < 22) {
                owenBjDealerHand.push(owenDrawCard());
            }
            
            owenUpdateDisplay();
            owenEndGame('DEALER BUSTS! You win!', true);
        }
        
        function owenEndGame(message, won) {
            owenBjGameOver = true;
            document.getElementById('owenBjMessage').textContent = message;
            document.getElementById('owenBjMessage').style.color = won ? 'var(--green)' : 'var(--coral)';
            document.getElementById('owenHitBtn').style.display = 'none';
            document.getElementById('owenStandBtn').style.display = 'none';
            document.getElementById('owenNewGameBtn').style.display = '';
            
            if (won) {
                owenBjWins++;
            } else {
                owenBjLosses++;
            }
            document.getElementById('owenBjWins').textContent = owenBjWins;
            document.getElementById('owenBjLosses').textContent = owenBjLosses;
            
            owenUpdateDisplay();
        }
        
        // Initialize Owen's blackjack when page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (document.getElementById('owenBlackjack')) {
                owenNewGame();
            }
        });

        // ============ SNAKE GAME ============
        let snakeCanvas, snakeCtx;
        let snake, snakeFood, snakeDir, snakeNextDir;
        let snakeScore, snakeHigh, snakeGame;
        const snakeSize = 13;
        const snakeGrid = 20;

        function startSnake() {
            snakeCanvas = document.getElementById('snakeCanvas');
            snakeCtx = snakeCanvas.getContext('2d');
            
            snake = [{x: 10, y: 10}];
            snakeDir = {x: 1, y: 0};
            snakeNextDir = {x: 1, y: 0};
            snakeScore = 0;
            snakeHigh = parseInt(localStorage.getItem('snakeHigh') || '0');
            
            document.getElementById('snakeScore').textContent = snakeScore;
            document.getElementById('snakeHigh').textContent = snakeHigh;
            
            placeSnakeFood();
            
            if (snakeGame) clearInterval(snakeGame);
            snakeGame = setInterval(updateSnake, 120);
            
            // Touch controls
            let touchStartX, touchStartY;
            snakeCanvas.ontouchstart = (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            };
            snakeCanvas.ontouchend = (e) => {
                if (!touchStartX || !touchStartY) return;
                const dx = e.changedTouches[0].clientX - touchStartX;
                const dy = e.changedTouches[0].clientY - touchStartY;
                if (Math.abs(dx) > Math.abs(dy)) {
                    setSnakeDir(dx > 0 ? 1 : -1, 0);
                } else {
                    setSnakeDir(0, dy > 0 ? 1 : -1);
                }
            };
        }

        function setSnakeDir(x, y) {
            // Prevent 180 turns
            if (snakeDir.x === -x && snakeDir.y === -y) return;
            if (x !== 0 && snakeDir.x !== 0) return;
            if (y !== 0 && snakeDir.y !== 0) return;
            snakeNextDir = {x, y};
        }

        function placeSnakeFood() {
            snakeFood = {
                x: Math.floor(Math.random() * snakeGrid),
                y: Math.floor(Math.random() * snakeGrid)
            };
            // Don't place on snake
            for (let seg of snake) {
                if (seg.x === snakeFood.x && seg.y === snakeFood.y) {
                    placeSnakeFood();
                    return;
                }
            }
        }

        function updateSnake() {
            snakeDir = snakeNextDir;
            
            const head = {
                x: (snake[0].x + snakeDir.x + snakeGrid) % snakeGrid,
                y: (snake[0].y + snakeDir.y + snakeGrid) % snakeGrid
            };
            
            // Check collision with self
            for (let seg of snake) {
                if (seg.x === head.x && seg.y === head.y) {
                    clearInterval(snakeGame);
                    if (snakeScore > snakeHigh) {
                        snakeHigh = snakeScore;
                        localStorage.setItem('snakeHigh', snakeHigh);
                        document.getElementById('snakeHigh').textContent = snakeHigh;
                    }
                    return;
                }
            }
            
            snake.unshift(head);
            
            // Check food
            if (head.x === snakeFood.x && head.y === snakeFood.y) {
                snakeScore += 10;
                document.getElementById('snakeScore').textContent = snakeScore;
                placeSnakeFood();
            } else {
                snake.pop();
            }
            
            drawSnake();
        }

        function drawSnake() {
            snakeCtx.fillStyle = '#0a0a0a';
            snakeCtx.fillRect(0, 0, snakeCanvas.width, snakeCanvas.height);
            
            // Draw food
            snakeCtx.fillStyle = '#ff6b6b';
            snakeCtx.shadowColor = '#ff6b6b';
            snakeCtx.shadowBlur = 10;
            snakeCtx.fillRect(snakeFood.x * snakeSize, snakeFood.y * snakeSize, snakeSize - 1, snakeSize - 1);
            
            // Draw snake with white glow
            snakeCtx.shadowColor = '#ffffff';
            snakeCtx.shadowBlur = 15;
            for (let i = 0; i < snake.length; i++) {
                const alpha = 1 - (i / snake.length) * 0.6;
                snakeCtx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                snakeCtx.shadowBlur = 15 * alpha;
                snakeCtx.fillRect(snake[i].x * snakeSize, snake[i].y * snakeSize, snakeSize - 1, snakeSize - 1);
            }
            snakeCtx.shadowBlur = 0;
        }

        // ============ SUDOKU GAME ============
        let sudokuBoard, sudokuSolution, sudokuSelected;

        // Pre-made puzzles (easier to implement than generating)
        const sudokuPuzzles = [
            {
                puzzle: [
                    [5,3,0,0,7,0,0,0,0],
                    [6,0,0,1,9,5,0,0,0],
                    [0,9,8,0,0,0,0,6,0],
                    [8,0,0,0,6,0,0,0,3],
                    [4,0,0,8,0,3,0,0,1],
                    [7,0,0,0,2,0,0,0,6],
                    [0,6,0,0,0,0,2,8,0],
                    [0,0,0,4,1,9,0,0,5],
                    [0,0,0,0,8,0,0,7,9]
                ],
                solution: [
                    [5,3,4,6,7,8,9,1,2],
                    [6,7,2,1,9,5,3,4,8],
                    [1,9,8,3,4,2,5,6,7],
                    [8,5,9,7,6,1,4,2,3],
                    [4,2,6,8,5,3,7,9,1],
                    [7,1,3,9,2,4,8,5,6],
                    [9,6,1,5,3,7,2,8,4],
                    [2,8,7,4,1,9,6,3,5],
                    [3,4,5,2,8,6,1,7,9]
                ]
            },
            {
                puzzle: [
                    [0,0,0,2,6,0,7,0,1],
                    [6,8,0,0,7,0,0,9,0],
                    [1,9,0,0,0,4,5,0,0],
                    [8,2,0,1,0,0,0,4,0],
                    [0,0,4,6,0,2,9,0,0],
                    [0,5,0,0,0,3,0,2,8],
                    [0,0,9,3,0,0,0,7,4],
                    [0,4,0,0,5,0,0,3,6],
                    [7,0,3,0,1,8,0,0,0]
                ],
                solution: [
                    [4,3,5,2,6,9,7,8,1],
                    [6,8,2,5,7,1,4,9,3],
                    [1,9,7,8,3,4,5,6,2],
                    [8,2,6,1,9,5,3,4,7],
                    [3,7,4,6,8,2,9,1,5],
                    [9,5,1,7,4,3,6,2,8],
                    [5,1,9,3,2,6,8,7,4],
                    [2,4,8,9,5,7,1,3,6],
                    [7,6,3,4,1,8,2,5,9]
                ]
            },
            {
                puzzle: [
                    [0,2,0,6,0,8,0,0,0],
                    [5,8,0,0,0,9,7,0,0],
                    [0,0,0,0,4,0,0,0,0],
                    [3,7,0,0,0,0,5,0,0],
                    [6,0,0,0,0,0,0,0,4],
                    [0,0,8,0,0,0,0,1,3],
                    [0,0,0,0,2,0,0,0,0],
                    [0,0,9,8,0,0,0,3,6],
                    [0,0,0,3,0,6,0,9,0]
                ],
                solution: [
                    [1,2,3,6,7,8,9,4,5],
                    [5,8,4,2,3,9,7,6,1],
                    [9,6,7,1,4,5,3,2,8],
                    [3,7,2,4,6,1,5,8,9],
                    [6,9,1,5,8,3,2,7,4],
                    [4,5,8,7,9,2,6,1,3],
                    [8,3,6,9,2,4,1,5,7],
                    [2,1,9,8,5,7,4,3,6],
                    [7,4,5,3,1,6,8,9,2]
                ]
            }
        ];

        function startSudoku() {
            const puzzleData = sudokuPuzzles[Math.floor(Math.random() * sudokuPuzzles.length)];
            sudokuBoard = puzzleData.puzzle.map(row => [...row]);
            sudokuSolution = puzzleData.solution;
            sudokuSelected = null;
            
            renderSudoku();
        }

        function renderSudoku() {
            const grid = document.getElementById('sudokuGrid');
            grid.innerHTML = '';
            
            // Find original puzzle for this solution
            const originalPuzzle = sudokuPuzzles.find(p => 
                JSON.stringify(p.solution) === JSON.stringify(sudokuSolution)
            ).puzzle;
            
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'sudoku-cell';
                    
                    const isGiven = originalPuzzle[r][c] !== 0;
                    
                    if (isGiven) {
                        cell.classList.add('given');
                        cell.textContent = originalPuzzle[r][c];
                    } else {
                        cell.classList.add('editable');
                        if (sudokuBoard[r][c] !== 0) {
                            cell.textContent = sudokuBoard[r][c];
                            // Check if correct
                            if (sudokuBoard[r][c] === sudokuSolution[r][c]) {
                                cell.classList.add('correct');
                            } else {
                                cell.classList.add('error');
                            }
                        }
                        cell.onclick = () => openSudokuPopup(r, c);
                    }
                    
                    grid.appendChild(cell);
                }
            }
            
            // Check win
            checkSudokuWin();
        }

        function openSudokuPopup(r, c) {
            sudokuSelected = {r, c};
            document.getElementById('sudokuPopup').classList.add('active');
        }

        function closeSudokuPopup() {
            document.getElementById('sudokuPopup').classList.remove('active');
            sudokuSelected = null;
        }

        function placeSudokuNum(num) {
            if (sudokuSelected) {
                sudokuBoard[sudokuSelected.r][sudokuSelected.c] = num;
                renderSudoku();
            }
            closeSudokuPopup();
        }

        function checkSudokuWin() {
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    if (sudokuBoard[r][c] !== sudokuSolution[r][c]) {
                        return false;
                    }
                }
            }
            // Win!
            setTimeout(() => {
                alert('Puzzle Complete! Well done, Owen.');
            }, 100);
            return true;
        }
    </script>
</body>
</html>
