<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>M.A.R.A. - DIVISION 4 ARCADE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --rabbit: #e8707e;
            --rabbit-glow: rgba(232, 112, 126, 0.3);
            --rabbit-subtle: rgba(232, 112, 126, 0.12);
            --cyan: #00ffff;
            --cyan-glow: rgba(0, 255, 255, 0.3);
            --gold: #ffd700;
            --bg-dark: #050510;
            --bg-card: rgba(0, 10, 20, 0.95);
            --text-primary: #ffffff;
            --text-dim: #888888;
            --border: rgba(232, 112, 126, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            height: 100%;
            height: 100dvh;
            overflow: hidden;
        }
        
        body {
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            font-family: 'Space Mono', monospace;
            color: var(--text-primary);
            touch-action: none;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            padding-top: max(4px, env(safe-area-inset-top));
            padding-bottom: max(4px, env(safe-area-inset-bottom));
            -webkit-font-smoothing: antialiased;
        }
        
        .game-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 400px;
            height: 100%;
            max-height: 100dvh;
        }
        
        /* Compact header */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 8px 12px;
            font-size: 0.7rem;
            color: var(--rabbit);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            background: rgba(0, 5, 15, 0.95);
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }
        
        .game-header .weapon-info {
            color: var(--cyan);
            font-size: 0.65rem;
        }
        
        .lives-display {
            color: var(--rabbit);
            font-size: 0.75rem;
            letter-spacing: 2px;
        }
        
        /* Minimal title */
        .game-title {
            text-align: center;
            padding: 8px 0 6px;
            flex-shrink: 0;
        }
        
        .game-title h1 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--rabbit);
            text-shadow: 0 0 20px var(--rabbit-glow);
            letter-spacing: 0.3em;
            margin-bottom: 2px;
        }
        
        .game-title .subtitle {
            font-size: 0.5rem;
            color: var(--text-dim);
            letter-spacing: 0.15em;
            font-weight: 400;
        }
        
        /* Canvas takes remaining space */
        .canvas-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px;
            flex: 1;
            min-height: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #gameCanvas {
            display: block;
            max-width: 100%;
            max-height: 100%;
            border: 2px solid rgba(232, 112, 126, 0.3);
            background: var(--bg-dark);
        }
        
        /* CRT Effect Overlay */
        .crt-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            background: 
                repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.08),
                    rgba(0, 0, 0, 0.08) 1px,
                    transparent 1px,
                    transparent 2px
                );
        }
        
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           STAR WARS STYLE WEAPON SWITCH BUTTONS
           Horizontal, rectangular, digital blinking
           ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .side-weapon-btn {
            position: absolute;
            bottom: 15%;
            padding: 14px 18px;
            min-width: 90px;
            background: rgba(0, 20, 40, 0.85);
            border: 1px solid rgba(0, 255, 255, 0.4);
            color: rgba(0, 255, 255, 0.7);
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            cursor: pointer;
            z-index: 10;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: uppercase;
            box-shadow: 
                0 0 10px rgba(0, 255, 255, 0.1),
                inset 0 0 20px rgba(0, 255, 255, 0.05);
        }
        
        .side-weapon-btn::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.5), transparent);
            animation: scanline 2s linear infinite;
        }
        
        @keyframes scanline {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }
        
        @keyframes buttonBlink {
            0%, 90%, 100% { opacity: 1; }
            92%, 98% { opacity: 0.7; }
        }
        
        .side-weapon-btn {
            animation: buttonBlink 3s ease-in-out infinite;
        }
        
        .side-weapon-btn:active {
            background: rgba(0, 255, 255, 0.25);
            color: #00ffff;
            border-color: #00ffff;
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.4),
                inset 0 0 30px rgba(0, 255, 255, 0.15);
            transform: scale(0.97);
        }
        
        .side-weapon-btn.left-side {
            left: 5px;
            border-radius: 4px;
        }
        
        .side-weapon-btn.right-side {
            right: 5px;
            border-radius: 4px;
        }
        
        .side-weapon-btn .arrow {
            font-size: 1rem;
            line-height: 1;
        }
        
        .side-weapon-label {
            font-size: 0.6rem;
            letter-spacing: 0.05em;
            font-weight: 400;
        }
        }
        
        /* Hide side buttons on desktop (they have keyboard) */
        @media (min-width: 501px) {
            .side-weapon-btn { display: none; }
        }
        
        /* Mobile Controls - compact for Instagram browser */
        .mobile-controls {
            display: flex;
            width: 100%;
            max-width: 400px;
            gap: 8px;
            padding: 8px;
            box-sizing: border-box;
            flex-shrink: 0;
            background: rgba(0, 5, 15, 0.5);
        }
        
        .control-btn {
            background: rgba(232, 112, 126, 0.1);
            border: 1px solid var(--rabbit);
            color: var(--rabbit);
            font-family: 'Space Mono', monospace;
            font-weight: 700;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            box-shadow: 0 0 15px rgba(232, 112, 126, 0.1);
        }
        
        .control-btn:active, .control-btn.active {
            background: rgba(232, 112, 126, 0.35);
            transform: scale(0.97);
            box-shadow: 0 0 25px rgba(232, 112, 126, 0.3);
        }
        
        /* Big movement buttons on sides */
        .move-btn {
            flex: 1;
            height: 72px;
            font-size: 2rem;
        }
        
        /* Bomb button in center */
        .bomb-btn {
            flex: 0.7;
            height: 72px;
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--gold);
            color: var(--gold);
            flex-direction: column;
            gap: 2px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.1);
        }
        
        .bomb-btn .btn-label {
            font-size: 0.65rem;
            letter-spacing: 0.1em;
        }
        
        .bomb-btn .btn-icon {
            font-size: 0.8rem;
        }
        
        .bomb-btn:active {
            background: rgba(255, 215, 0, 0.35);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
        }
        
        .bomb-btn:disabled {
            opacity: 0.3;
            border-color: #333;
            color: #333;
            box-shadow: none;
        }
        
        /* Desktop controls hint */
        .desktop-controls {
            margin-top: 10px;
            text-align: center;
            color: var(--text-dim);
            font-size: 0.6rem;
            letter-spacing: 0.1em;
        }
        
        @media (max-width: 500px) {
            .desktop-controls { display: none; }
        }
        
        @media (min-width: 501px) {
            .mobile-controls { display: none; }
        }
        
        /* Start Screen */
        .overlay-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            padding: 15px;
        }
        
        .overlay-screen.hidden {
            display: none;
        }
        
        .overlay-screen h2 {
            font-size: 22px;
            color: #e8707e;
            text-shadow: 0 0 30px rgba(232, 112, 126, 0.8);
            letter-spacing: 6px;
            margin-bottom: 10px;
        }
        
        .overlay-screen .logo {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .overlay-screen p {
            color: #666;
            font-size: 10px;
            letter-spacing: 2px;
            margin-bottom: 6px;
            text-align: center;
        }
        
        /* Start Screen */
        .overlay-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(5, 5, 20, 0.98) 0%, rgba(10, 5, 15, 0.98) 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            padding: 20px;
        }
        
        .overlay-screen.hidden {
            display: none;
        }
        
        .overlay-screen h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--rabbit);
            text-shadow: 0 0 30px var(--rabbit-glow);
            letter-spacing: 0.3em;
            margin-bottom: 8px;
        }
        
        .overlay-screen .logo {
            margin-bottom: 12px;
            filter: drop-shadow(0 0 15px var(--rabbit-glow));
        }
        
        .overlay-screen .logo img {
            width: 80px;
            height: 80px;
            border-radius: 12px;
        }
        
        .overlay-screen p {
            color: var(--text-dim);
            font-size: 0.65rem;
            letter-spacing: 0.15em;
            margin-bottom: 6px;
            text-align: center;
            font-weight: 400;
        }
        
        .overlay-screen .blink {
            animation: blink 1s step-end infinite;
            color: var(--text-primary);
            margin-top: 20px;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        .overlay-screen .story {
            max-width: 320px;
            text-align: center;
            color: var(--text-dim);
            font-size: 0.7rem;
            line-height: 1.8;
            margin: 16px 0;
            padding: 16px 20px;
            background: rgba(232, 112, 126, 0.05);
            border: 1px solid var(--border);
            border-radius: 4px;
        }
        
        .overlay-screen .controls-info {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-top: 16px;
            font-size: 0.55rem;
            color: var(--text-dim);
            letter-spacing: 0.05em;
        }
        
        .controls-info div {
            text-align: center;
            padding: 10px 14px;
            background: rgba(0, 255, 255, 0.03);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 4px;
            min-width: 60px;
        }
        
        .controls-info span {
            color: var(--cyan);
            display: block;
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: 0.1em;
        }
        
        .victory h2 {
            color: #00ff88 !important;
            text-shadow: 0 0 30px rgba(0, 255, 136, 0.5) !important;
        }
        
        .game-btn {
            margin-top: 20px;
            padding: 14px 40px;
            background: rgba(232, 112, 126, 0.1);
            border: 1px solid var(--rabbit);
            color: var(--rabbit);
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            letter-spacing: 0.15em;
            transition: all 0.2s ease;
            text-shadow: 0 0 10px var(--rabbit-glow);
            box-shadow: 0 0 20px rgba(232, 112, 126, 0.1);
        }
        
        .game-btn:hover, .game-btn:active {
            background: rgba(232, 112, 126, 0.25);
            box-shadow: 0 0 30px rgba(232, 112, 126, 0.3);
            transform: scale(0.98);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-title">
            <h1>M.A.R.A.</h1>
            <div class="subtitle">MAMMALIAN ASSAULT RESISTANCE ARCADE</div>
        </div>
        
        <div class="game-header">
            <div>SCORE: <span id="score">0</span></div>
            <div class="weapon-info" id="weaponDisplay">BEAM LV.1</div>
            <div>WAVE: <span id="wave">1</span></div>
            <div class="lives-display" id="livesDisplay">‚ô•‚ô•‚ô•‚ô•‚ô•</div>
        </div>
        
        <div class="canvas-wrapper">
            <canvas id="gameCanvas" width="400" height="500"></canvas>
            <div class="crt-overlay"></div>
            
            <!-- Side weapon switch buttons -->
            <button class="side-weapon-btn left-side" id="weaponBtnLeft"><span class="arrow">‚óÄ</span><span class="side-weapon-label" id="weaponLabelLeft">HOMING</span></button>
            <button class="side-weapon-btn right-side" id="weaponBtnRight"><span class="side-weapon-label" id="weaponLabelRight">LASER</span><span class="arrow">‚ñ∂</span></button>
            
            <!-- Start Screen -->
            <div class="overlay-screen" id="startScreen">
                <div class="logo"><img src="data:image/jpeg;base64,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" alt="MARA"></div>
                <h2>M.A.R.A.</h2>
                <p>MAMMALIAN ASSAULT RESISTANCE ARCADE</p>
                <div class="story">
                    <span style="color: var(--rabbit);">DIVISION 4 HAS FALLEN.</span><br><br>
                    The horses have taken control.<br>
                    You are the last line of defense.<br><br>
                    <span style="color: var(--cyan);">‚óÜ</span> Survive 12 waves of enemies<br>
                    <span style="color: var(--cyan);">‚óÜ</span> Defeat the Mini-Boss (Wave 4)<br>
                    <span style="color: var(--cyan);">‚óÜ</span> Conquer 4 Main Bosses<br><br>
                    <span style="color: var(--rabbit);">‚ô•</span> Collect hearts for extra lives<br>
                    <span style="color: var(--gold);">‚òÖ</span> Grab power-ups to upgrade weapons
                </div>
                <div class="controls-info">
                    <div><span>‚óÄ ‚ñ∂</span>MOVE</div>
                    <div><span>AUTO</span>FIRE</div>
                    <div><span>üí•</span>BOMB</div>
                    <div><span>‚ü® ‚ü©</span>WEAPON</div>
                </div>
                <p class="blink">[ TAP ANYWHERE TO BEGIN ]</p>
            </div>
            
            <!-- Game Over Screen -->
            <div class="overlay-screen hidden" id="gameOverScreen">
                <div class="logo">üíÄ</div>
                <h2>GAME OVER</h2>
                <p style="color: var(--rabbit); font-size: 0.9rem; margin: 10px 0;">SCORE: <span id="finalScore">0</span></p>
                <p>The horses prevail... for now.</p>
                <button class="game-btn" onclick="restartGame()">TRY AGAIN</button>
            </div>
            
            <!-- Victory Screen -->
            <div class="overlay-screen victory hidden" id="victoryScreen">
                <div class="logo">üéâ</div>
                <h2 style="font-size: 1rem; letter-spacing: 0.15em;">SECRET ENDING UNLOCKED!</h2>
                <p style="color: #00ff88; font-size: 1.1rem; margin: 12px 0;">SCORE: <span id="victoryScore">0</span></p>
                <p style="color: var(--cyan); font-size: 0.8rem;">YOU FOUND THE SUPER SECRET ENDING!</p>
                <p style="color: #ffaa00; font-size: 0.9rem; margin: 8px 0;">‚ú® M.A.R.A. IS DEAD! ‚ú®</p>
                <p style="color: var(--rabbit); font-size: 0.85rem;">The horses have been vanquished!</p>
                <p style="font-size: 0.7rem; color: #666; margin-top: 10px;">Rabbitkind is finally free. YAY! üê∞</p>
                <button class="game-btn" onclick="restartGame()">PLAY AGAIN</button>
            </div>
        </div>
        
        <!-- Mobile Controls -->
        <div class="mobile-controls">
            <button class="control-btn move-btn" id="leftBtn">‚óÄ</button>
            <button class="control-btn bomb-btn" id="specialBtn">
                <span class="btn-label">BOMB</span>
                <span class="btn-icon" id="specialCount">√ó3</span>
            </button>
            <button class="control-btn move-btn" id="rightBtn">‚ñ∂</button>
        </div>
        
        <div class="desktop-controls">
            ‚Üê ‚Üí MOVE | SPACE = BOMB | 1-4 = SWITCH WEAPON
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GAME STATE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        let gameStarted = false;
        let gameOver = false;
        let victory = false;
        let score = 0;
        let lives = 5;
        let wave = 1;
        let bossActive = false;
        let waveTransitioning = false; // Prevents double wave advancement
        let lastTime = 0;
        let autoFireTimer = 0;
        
        // Main boss system - 4 main bosses after mini-boss
        let mainBossLevel = 0; // 0 = no main boss yet, 1-4 = current main boss
        let gameSpeed = 1.0; // Increases 10% after each main boss
        const MAX_MAIN_BOSSES = 4;
        const MAIN_BOSS_NAMES = ['STANDING STALLION', 'GALLOPING FURY', 'BABY TERROR', 'BASKETBALL BEAST'];
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // BOSS SPRITE SYSTEM (Individual cartoon horses)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const bossSprites = {};
        let bossSpriteLoadCount = 0;
        
        bossSprites[1] = new Image();
        bossSprites[1].onload = () => { bossSpriteLoadCount++; };
        bossSprites[1].src = 'data:image/jpeg;base64,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';
        
        bossSprites[2] = new Image();
        bossSprites[2].onload = () => { bossSpriteLoadCount++; };
        bossSprites[2].src = 'data:image/jpeg;base64,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';
        
        bossSprites[3] = new Image();
        bossSprites[3].onload = () => { bossSpriteLoadCount++; };
        bossSprites[3].src = 'data:image/jpeg;base64,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';
        
        bossSprites[4] = new Image();
        bossSprites[4].onload = () => { bossSpriteLoadCount++; };
        bossSprites[4].src = 'data:image/jpeg;base64,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';
        
        // Boss hitbox sizes based on new images
        // Boss 1: 196x185, Boss 2: 195x161, Boss 3: 141x206, Boss 4: 208x182
        const BOSS_SIZES = {
            1: { w: 98, h: 92 },    // Standing horse (half of original)
            2: { w: 97, h: 80 },    // Galloping horse  
            3: { w: 70, h: 103 },   // Baby horse (taller than wide)
            4: { w: 130, h: 114 }   // Basketball beast (bigger boss)
        };

        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // STARFIELD BACKGROUND
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const stars = [];
        for (let i = 0; i < 100; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2 + 0.5,
                speed: Math.random() * 0.7 + 0.2,
                brightness: Math.random() * 0.5 + 0.3
            });
        }
        
        function updateStars() {
            stars.forEach(star => {
                star.y += star.speed;
                if (star.y > canvas.height) {
                    star.y = 0;
                    star.x = Math.random() * canvas.width;
                }
            });
        }
        
        function drawStars() {
            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${star.brightness})`;
                ctx.fillRect(star.x, star.y, star.size, star.size);
            });
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // WEAPON SYSTEM
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const WEAPONS = {
            BEAM: { name: 'BEAM', color: '#00ffff', fireRate: 200 },
            LASER: { name: 'LASER', color: '#ff00ff', fireRate: 65 },
            SPREAD: { name: 'SPREAD', color: '#ffff00', fireRate: 260 },
            HOMING: { name: 'HOMING', color: '#00ff00', fireRate: 400 }
        };
        
        let currentWeapon = 'BEAM';
        // Each weapon has its own level!
        let weaponLevels = {
            BEAM: 1,
            LASER: 1,
            SPREAD: 1,
            HOMING: 1
        };
        let specialAttacks = 3;
        let shields = 0; // Max 3 shields
        
        // Helper to get current weapon's level
        function getWeaponLevel() {
            return weaponLevels[currentWeapon];
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // PLAYER
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const player = {
            x: 200,
            y: 470,
            width: 30,
            height: 30,
            speed: 4
        };
        
        // Invulnerability and visual feedback
        let playerInvulnerable = false;
        let invulnerableTimer = 0;
        let screenShake = 0;
        let screenShakeIntensity = 0;
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // AUDIO SYSTEM
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        let audioCtx = null;
        let musicPlaying = false;
        let bgMusic = null;
        let soundEnabled = true;
        let musicEnabled = true;
        
        // Initialize audio context on first user interaction
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }
        
        // Background music
        function startMusic() {
            if (!musicEnabled || musicPlaying) return;
            bgMusic = new Audio('https://raw.githubusercontent.com/enjurogerjung-prog/therabbittest/7ea5e9b9703f10fc76005474bc22c220186f4514/le-cirque-de-jazz-compressed.mp3');
            bgMusic.loop = true;
            bgMusic.volume = 0.4;
            bgMusic.play().then(() => {
                musicPlaying = true;
            }).catch(e => console.log('Music autoplay blocked'));
        }
        
        function stopMusic() {
            if (bgMusic) {
                bgMusic.pause();
                bgMusic.currentTime = 0;
                musicPlaying = false;
            }
        }
        
        // Procedural sound effects using Web Audio API
        function playSound(type) {
            if (!soundEnabled || !audioCtx) return;
            
            const now = audioCtx.currentTime;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            switch(type) {
                case 'shoot':
                    // Quick laser pew
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(880, now);
                    osc.frequency.exponentialRampToValueAtTime(220, now + 0.1);
                    gain.gain.setValueAtTime(0.15, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                    osc.start(now);
                    osc.stop(now + 0.1);
                    break;
                    
                case 'hit':
                    // Enemy hit pop
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(300, now);
                    osc.frequency.exponentialRampToValueAtTime(100, now + 0.08);
                    gain.gain.setValueAtTime(0.2, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
                    osc.start(now);
                    osc.stop(now + 0.08);
                    break;
                    
                case 'playerHit':
                    // Damage sound - harsh
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(200, now);
                    osc.frequency.exponentialRampToValueAtTime(50, now + 0.3);
                    gain.gain.setValueAtTime(0.3, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                    osc.start(now);
                    osc.stop(now + 0.3);
                    break;
                    
                case 'powerup':
                    // Happy ascending chime
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(440, now);
                    osc.frequency.setValueAtTime(550, now + 0.1);
                    osc.frequency.setValueAtTime(660, now + 0.2);
                    osc.frequency.setValueAtTime(880, now + 0.3);
                    gain.gain.setValueAtTime(0.2, now);
                    gain.gain.setValueAtTime(0.2, now + 0.3);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                    osc.start(now);
                    osc.stop(now + 0.5);
                    break;
                    
                case 'explosion':
                    // Boss death boom - use noise-like sound
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(150, now);
                    osc.frequency.exponentialRampToValueAtTime(30, now + 0.5);
                    gain.gain.setValueAtTime(0.4, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                    osc.start(now);
                    osc.stop(now + 0.5);
                    break;
                    
                case 'levelup':
                    // Level up fanfare
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(523, now);
                    osc.frequency.setValueAtTime(659, now + 0.1);
                    osc.frequency.setValueAtTime(784, now + 0.2);
                    osc.frequency.setValueAtTime(1047, now + 0.3);
                    gain.gain.setValueAtTime(0.15, now);
                    gain.gain.setValueAtTime(0.15, now + 0.35);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                    osc.start(now);
                    osc.stop(now + 0.5);
                    break;
                    
                case 'shield':
                    // Shield get - bwoop
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(220, now);
                    osc.frequency.exponentialRampToValueAtTime(880, now + 0.15);
                    gain.gain.setValueAtTime(0.2, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
                    osc.start(now);
                    osc.stop(now + 0.2);
                    break;
                    
                case 'laser':
                    // Continuous laser hum
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(120, now);
                    gain.gain.setValueAtTime(0.1, now);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
                    osc.start(now);
                    osc.stop(now + 0.05);
                    break;
            }
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // BULLETS & EFFECTS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        let playerBullets = [];
        let enemyBullets = [];
        let powerUps = [];
        let particles = [];
        let laserActive = false;
        let laserWidth = 0;
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // ENEMIES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        let enemies = [];
        let boss = null;
        const PAWN = 'pawn';
        const KNIGHT = 'knight';
        const BUBBLE_SHOOTER = 'bubble';
        const BOUNCER = 'bouncer'; // Ball that bounces around, high HP
        const CHARGER = 'charger'; // Charges at player periodically
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INPUT
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const keys = { left: false, right: false, special: false };
        let specialReady = true;
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // POWER-UP TYPES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const POWERUP_TYPES = ['BEAM', 'LASER', 'SPREAD', 'HOMING', 'LEVELUP', 'SPECIAL', 'SHIELD', 'HEART'];
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INITIALIZE WAVE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Wave structure - 20 waves with more variety:
        // 1-4: Regular waves (easy, introduce enemies)
        // 5: Mini-boss
        // 6-7: Regular waves (medium)
        // 8: Main Boss 1 - Standing Stallion
        // 9-10: Regular waves (medium-hard)
        // 11: Mini-boss
        // 12: Main Boss 2 - Galloping Fury
        // 13-14: Regular waves (hard, bouncers appear)
        // 15: Double Mini-boss
        // 16: Main Boss 3 - Baby Terror
        // 17-18: Regular waves (very hard, chargers appear)
        // 19: Double Mini-boss
        // 20: Main Boss 4 - Basketball Beast (FINAL)
        
        const TOTAL_WAVES = 20;
        const MAIN_BOSS_WAVES = [8, 12, 16, 20]; // Main bosses
        const MINI_BOSS_WAVES = [5, 11, 15, 19]; // Mini-boss waves
        const DOUBLE_MINI_WAVES = [15, 19]; // Waves with 2 mini-bosses
        
        function getDifficultyScale(waveNum) {
            // Scales from 0.5 (wave 1) to 1.0 (wave 20)
            return 0.5 + (waveNum / TOTAL_WAVES) * 0.5;
        }
        
        function initWave(waveNum) {
            waveTransitioning = false; // Clear transition flag
            enemies = [];
            enemyBullets = [];
            bossActive = false;
            boss = null;
            
            const isMainBoss = MAIN_BOSS_WAVES.includes(waveNum);
            const isMiniBoss = MINI_BOSS_WAVES.includes(waveNum);
            const difficulty = getDifficultyScale(waveNum);
            
            if (isMainBoss) {
                // Main boss waves
                const bossIndex = MAIN_BOSS_WAVES.indexOf(waveNum);
                mainBossLevel = bossIndex + 1;
                initMainBoss(mainBossLevel);
            } else if (isMiniBoss) {
                // Mini-boss wave (possibly with 2 mini-bosses)
                const doubleMiniBoss = DOUBLE_MINI_WAVES.includes(waveNum);
                initMiniBossWave(doubleMiniBoss);
            } else {
                // Regular enemy wave
                initRegularWave(waveNum, difficulty);
            }
        }
        
        function initRegularWave(waveNum, difficulty) {
            // Scale enemy count and types based on wave
            const baseRows = 2;
            const extraRows = Math.floor(waveNum / 4);
            const rows = Math.min(baseRows + extraRows, 5);
            const cols = 7;
            
            // More knights in later waves
            const knightChance = Math.min(0.15 + waveNum * 0.03, 0.45);
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const isKnight = row === 0 || Math.random() < knightChance;
                    const type = isKnight ? KNIGHT : PAWN;
                    // Drop rate scales down: 25% at wave 1, down to ~12.5% by wave 20
                    const dropRate = 0.25 * (1 - (waveNum - 1) / 40);
                    const hasPowerUp = Math.random() < dropRate;
                    enemies.push({
                        x: 40 + col * 48,
                        y: 30 + row * 32,
                        width: type === KNIGHT ? 22 : 16,
                        height: type === KNIGHT ? 22 : 20,
                        type: type,
                        health: type === KNIGHT ? 4 : 2,
                        points: type === KNIGHT ? 20 : 10,
                        hasPowerUp: hasPowerUp,
                        moveDir: 1
                    });
                }
            }
            
            // Add bubble shooters after wave 3
            if (waveNum >= 3) {
                const bubbleCount = Math.min(Math.floor(waveNum / 3), 3);
                for (let i = 0; i < bubbleCount; i++) {
                    enemies.push({
                        x: 80 + i * 120,
                        y: 18,
                        width: 24,
                        height: 24,
                        type: BUBBLE_SHOOTER,
                        health: 5,
                        points: 30,
                        hasPowerUp: true,
                        moveDir: 1
                    });
                }
            }
            
            // Add BOUNCERS after wave 9 - bouncing balls with high HP
            if (waveNum >= 9) {
                const bouncerCount = Math.min(Math.floor((waveNum - 8) / 3) + 1, 3);
                for (let i = 0; i < bouncerCount; i++) {
                    enemies.push({
                        x: 100 + i * 100,
                        y: 80 + i * 30,
                        width: 28,
                        height: 28,
                        type: BOUNCER,
                        health: 15, // High HP!
                        points: 100,
                        hasPowerUp: true,
                        moveDir: 1,
                        // Bouncer-specific movement
                        dx: (1.5 + Math.random()) * (Math.random() > 0.5 ? 1 : -1),
                        dy: (1.5 + Math.random()) * (Math.random() > 0.5 ? 1 : -1)
                    });
                }
            }
            
            // Add CHARGERS after wave 13 - charge at player periodically
            if (waveNum >= 13) {
                const chargerCount = Math.min(Math.floor((waveNum - 12) / 3) + 1, 2);
                for (let i = 0; i < chargerCount; i++) {
                    enemies.push({
                        x: 80 + i * 200,
                        y: 50,
                        width: 30,
                        height: 30,
                        type: CHARGER,
                        health: 12,
                        points: 80,
                        hasPowerUp: true,
                        moveDir: 1,
                        // Charger-specific
                        chargeTimer: 0,
                        isCharging: false,
                        chargeTargetX: 0,
                        originalY: 50
                    });
                }
            }
            
            // Announce new enemy types when they first appear
            if (waveNum === 9) {
                setTimeout(() => showNotification('‚ö° BOUNCERS INCOMING! ‚ö°', '#00ffff'), 500);
            }
            if (waveNum === 13) {
                setTimeout(() => showNotification('üî• CHARGERS INCOMING! üî•', '#ff4444'), 500);
            }
        }
        
        function initMiniBossWave(doubleBoss) {
            bossActive = true;
            
            // For double mini-boss waves, we'll use the enemies array for the second one
            boss = {
                x: doubleBoss ? 130 : 200,
                y: 55,
                width: 70,
                height: 60,
                health: 160,  // DOUBLED
                maxHealth: 160,
                speed: 0.6 * gameSpeed,
                direction: 1,
                points: 1000,
                attackTimer: 0,
                shootsBubbles: true,
                type: 'miniboss'
            };
            
            // Second mini-boss as a special enemy if double
            if (doubleBoss) {
                enemies.push({
                    x: 270,
                    y: 55,
                    width: 70,
                    height: 60,
                    type: 'miniboss2',
                    health: 160,  // DOUBLED
                    maxHealth: 160,
                    points: 1000,
                    hasPowerUp: true,
                    moveDir: 1,
                    direction: -1,
                    attackTimer: 0
                });
            }
            
            // Fewer minions
            const minionCount = doubleBoss ? 2 : 3;
            for (let i = 0; i < minionCount; i++) {
                enemies.push({
                    x: 80 + i * 120,
                    y: 140,
                    width: 16,
                    height: 20,
                    type: PAWN,
                    health: 2,
                    points: 10,
                    hasPowerUp: i === 1,
                    moveDir: 1
                });
            }
        }
        
        function initMainBoss(bossNum) {
            bossActive = true;
            
            // Each main boss is harder (but balanced for fun) - DOUBLED HP
            const bossHP = [240, 320, 400, 560][bossNum - 1];
            const bossSpeed = [0.6, 0.7, 0.8, 0.9][bossNum - 1] * gameSpeed;
            const bossPoints = [2000, 3000, 4000, 5000][bossNum - 1];
            
            boss = {
                x: 200,
                y: 70,
                width: 100,
                height: 80,
                health: bossHP,
                maxHealth: bossHP,
                speed: bossSpeed,
                direction: 1,
                points: bossPoints,
                attackTimer: 0,
                shootsBubbles: true,
                type: 'mainboss',
                bossNum: bossNum,
                animTimer: 0,
                legPhase: 0
            };
            
            // Minions (3-6 based on boss)
            const minionCount = 2 + bossNum;
            // Drop rate scales down with wave
            const minionDropRate = 0.4 * (1 - (wave - 1) / 40);
            for (let i = 0; i < minionCount; i++) {
                enemies.push({
                    x: 50 + i * 70,
                    y: 160,
                    width: 16,
                    height: 20,
                    type: Math.random() < 0.3 ? KNIGHT : PAWN,
                    health: Math.random() < 0.3 ? 4 : 2,
                    points: Math.random() < 0.3 ? 20 : 10,
                    hasPowerUp: Math.random() < minionDropRate,
                    moveDir: 1
                });
            }
            
            // Bubble shooters (max 2)
            const bubbleCount = Math.min(bossNum, 2);
            for (let i = 0; i < bubbleCount; i++) {
                enemies.push({
                    x: 120 + i * 160,
                    y: 130,
                    width: 24,
                    height: 24,
                    type: BUBBLE_SHOOTER,
                    health: 5,
                    points: 30,
                    hasPowerUp: true,
                    moveDir: 1
                });
            }
        }
        
        function getBossDefeatMessage(defeatedWave) {
            // Mini-boss waves: 5, 11, 15, 19 (15 & 19 are double)
            // Main boss waves: 8, 12, 16, 20
            if (defeatedWave === 5) return 'MINI-BOSS DEFEATED!';
            if (defeatedWave === 8) return 'BOSS 1/4 DEFEATED!';
            if (defeatedWave === 11) return 'MINI-BOSS DEFEATED!';
            if (defeatedWave === 12) return 'BOSS 2/4 DEFEATED!';
            if (defeatedWave === 15) return 'DOUBLE MINI-BOSS CLEARED!';
            if (defeatedWave === 16) return 'BOSS 3/4 DEFEATED!';
            if (defeatedWave === 19) return 'DOUBLE MINI-BOSS CLEARED!';
            if (defeatedWave === 20) return 'FINAL BOSS DEFEATED!';
            return 'WAVE CLEAR!';
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // WEAPON FIRING
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function fireWeapon() {
            const weapon = WEAPONS[currentWeapon];
            
            // Play shoot sound (except laser which has its own)
            if (currentWeapon !== 'LASER') playSound('shoot');
            
            switch(currentWeapon) {
                case 'BEAM':
                    fireBeam();
                    break;
                case 'LASER':
                    fireLaser();
                    break;
                case 'SPREAD':
                    fireSpread();
                    break;
                case 'HOMING':
                    fireHoming();
                    break;
            }
        }
        
        function fireBeam() {
            // BOUNCING BEAM - bounces off enemies!
            // Level 1: 1 beam, Level 2-3: 2 beams, Level 4-5: 3 beams, Level 6-7: 5 beams
            const level = getWeaponLevel();
            let positions;
            if (level <= 1) positions = [0];
            else if (level <= 3) positions = [-10, 10];
            else if (level <= 5) positions = [-15, 0, 15];
            else positions = [-20, -10, 0, 10, 20];
            
            // NERFED: Always 1 damage - bouncing is the mechanic, not raw DPS
            const damage = 1;
            // Bounces scale with level: 1,1,2,2,3,3,4
            const maxBounces = Math.floor((level + 1) / 2);
            
            positions.forEach(offset => {
                playerBullets.push({
                    x: player.x + offset,
                    y: player.y - 20,
                    speed: 8 + level * 0.4,
                    dx: 0,
                    dy: -1,
                    type: 'beam',
                    damage: damage,
                    color: '#00ffff',
                    bounces: maxBounces,
                    lastHit: null  // Track last hit to avoid repeat bounces
                });
            });
        }
        
        function fireLaser() {
            // Continuous laser beam - width and damage scale with level
            const level = getWeaponLevel();
            laserActive = true;
            laserWidth = level * 3 + 4;
        }
        
        function fireSpread() {
            // More bullets and wider spread at higher levels
            const level = getWeaponLevel();
            let angles;
            // NERFED: Reduced bullet count and spread angle
            if (level <= 1) angles = [-0.08, 0, 0.08];
            else if (level <= 2) angles = [-0.12, 0, 0.12];
            else if (level <= 3) angles = [-0.18, 0, 0.18];
            else if (level <= 4) angles = [-0.22, -0.07, 0.07, 0.22];
            else if (level <= 5) angles = [-0.28, -0.1, 0.1, 0.28];
            else if (level <= 6) angles = [-0.32, -0.16, 0, 0.16, 0.32];
            else angles = [-0.38, -0.19, 0, 0.19, 0.38];
            
            const damage = 1;  // HARD NERFED: Always 1 damage - spread is for coverage not damage
            
            angles.forEach(angle => {
                playerBullets.push({
                    x: player.x,
                    y: player.y - 20,
                    speed: 6 + level * 0.2,
                    dx: Math.sin(angle) * (2 + level * 0.2),  // NERFED: Reduced spread distance
                    type: 'spread',
                    damage: damage,
                    color: '#ffff00'
                });
            });
        }
        
        function fireHoming() {
            // Homing missiles - starts with 2, scales up
            const level = getWeaponLevel();
            const count = Math.min(2 + Math.floor(level / 2), 5); // 2,2,3,3,4,4,5 missiles
            // Moderate damage: 2, 3, 3, 4, 4, 5, 5
            const damage = 2 + Math.floor(level / 2);
            
            for (let i = 0; i < count; i++) {
                playerBullets.push({
                    x: player.x + (i - (count-1)/2) * 15,
                    y: player.y - 20,
                    speed: 4 + level * 0.3,
                    type: 'homing',
                    damage: damage,
                    color: '#00ff00',
                    target: null,
                    turnSpeed: 0.25 + level * 0.03 // MUCH better tracking
                });
            }
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // SPECIAL ATTACK
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function useSpecialAttack() {
            if (specialAttacks <= 0 || !specialReady) return;
            
            specialAttacks--;
            specialReady = false;
            document.getElementById('specialCount').textContent = '√ó' + specialAttacks;
            if (specialAttacks <= 0) {
                document.getElementById('specialBtn').disabled = true;
            }
            
            // Screen flash
            particles.push({
                type: 'flash',
                alpha: 1,
                duration: 20
            });
            
            // Damage all enemies - kill up to 3
            let killCount = 0;
            for (let i = enemies.length - 1; i >= 0 && killCount < 3; i--) {
                const enemy = enemies[i];
                spawnParticles(enemy.x, enemy.y, '#ff0');
                score += enemy.points;
                if (enemy.hasPowerUp) spawnPowerUp(enemy.x, enemy.y);
                enemies.splice(i, 1);
                killCount++;
            }
            
            // Damage boss
            if (boss) {
                boss.health -= 10;
                spawnParticles(boss.x, boss.y, '#ff0');
                if (boss.health <= 0) {
                    score += boss.points;
                    
                    // BIG SCREEN SHAKE for boss death!
                    const isMainBoss = boss.type === 'mainboss';
                    triggerScreenShake(isMainBoss ? 20 : 15, isMainBoss ? 30 : 20);
                    particles.push({ type: 'flash', alpha: 0.8, duration: 12 });
                    playSound('explosion');
                    
                    // Check if this was a main boss - increase game speed
                    if (boss.type === 'mainboss') {
                        gameSpeed += 0.1;
                        showNotification('SPEED UP! ' + Math.round(gameSpeed * 100) + '%', '#ff6600');
                    }
                    
                    boss = null;
                    bossActive = false;
                    
                    // Progress to next wave
                    wave++;
                    if (wave > TOTAL_WAVES) {
                        showVictory();
                    } else {
                        if ([...MINI_BOSS_WAVES, ...MAIN_BOSS_WAVES].includes(wave - 1)) {
                            showNotification(getBossDefeatMessage(wave - 1), '#00ff00');
                        }
                        updateUI();
                        waveTransitioning = true;
                        setTimeout(() => initWave(wave), 1500);
                    }
                }
            }
            
            setTimeout(() => specialReady = true, 1000);
            updateUI();
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // POWER-UPS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function spawnPowerUp(x, y) {
            // Weighted distribution - LASER is rarer, LEVELUP is common, SHIELD added
            const weights = {
                'BEAM': 10,
                'LASER': 4,      // Very rare
                'SPREAD': 10,
                'HOMING': 10,
                'LEVELUP': 28,   // Most common - players need upgrades!
                'SPECIAL': 10,
                'SHIELD': 16,    // Fairly common - helps survival
                'HEART': 12     // Life recovery
            };
            
            const totalWeight = Object.values(weights).reduce((a, b) => a + b, 0);
            let random = Math.random() * totalWeight;
            let type = 'LEVELUP';
            
            for (const [powerType, weight] of Object.entries(weights)) {
                random -= weight;
                if (random <= 0) {
                    type = powerType;
                    break;
                }
            }
            powerUps.push({
                x: x,
                y: y,
                type: type,
                speed: 1.1,
                size: 28
            });
        }
        
        function collectPowerUp(powerUp) {
            switch(powerUp.type) {
                case 'BEAM':
                case 'LASER':
                case 'SPREAD':
                case 'HOMING':
                    // Level up that weapon (even if not equipped!)
                    if (weaponLevels[powerUp.type] < 7) {
                        weaponLevels[powerUp.type]++;
                        showNotification(powerUp.type + ' LV.' + weaponLevels[powerUp.type] + '!', getPowerUpColor(powerUp.type));
                        playSound('levelup');
                    } else {
                        showNotification(powerUp.type + ' MAX!', getPowerUpColor(powerUp.type));
                        playSound('powerup');
                    }
                    break;
                case 'LEVELUP':
                    // Level up current weapon
                    if (weaponLevels[currentWeapon] < 7) {
                        weaponLevels[currentWeapon]++;
                        showNotification(currentWeapon + ' LV.' + weaponLevels[currentWeapon] + '!', '#ffffff');
                        playSound('levelup');
                    }
                    break;
                case 'SPECIAL':
                    specialAttacks = Math.min(specialAttacks + 1, 5);
                    document.getElementById('specialCount').textContent = '√ó' + specialAttacks;
                    document.getElementById('specialBtn').disabled = false;
                    showNotification('+1 BOMB!', '#ffd700');
                    playSound('powerup');
                    break;
                case 'SHIELD':
                    if (shields < 3) {
                        shields++;
                        showNotification('+SHIELD! (' + shields + '/3)', '#00aaff');
                    } else {
                        // Convert to points if maxed
                        score += 100;
                        showNotification('+100 PTS!', '#00aaff');
                    }
                    playSound('shield');
                    break;
                case 'HEART':
                    lives++;
                    showNotification('+1 LIFE!', '#ff6b9d');
                    playSound('powerup');
                    break;
            }
            spawnParticles(powerUp.x, powerUp.y, getPowerUpColor(powerUp.type));
            updateUI();
        }
        
        // Switch to next weapon
        function switchWeapon(direction = 1) {
            const weaponOrder = ['BEAM', 'LASER', 'SPREAD', 'HOMING'];
            let idx = weaponOrder.indexOf(currentWeapon);
            idx = (idx + direction + 4) % 4;
            currentWeapon = weaponOrder[idx];
            showNotification(currentWeapon + ' LV.' + weaponLevels[currentWeapon], WEAPONS[currentWeapon].color);
            updateUI();
            updateWeaponButton();
        }
        
        function updateWeaponButton() {
            // Update side button labels to show prev/next weapons
            const weaponOrder = ['BEAM', 'LASER', 'SPREAD', 'HOMING'];
            let idx = weaponOrder.indexOf(currentWeapon);
            const prevWeapon = weaponOrder[(idx - 1 + 4) % 4];
            const nextWeapon = weaponOrder[(idx + 1) % 4];
            
            const leftLabel = document.getElementById('weaponLabelLeft');
            const rightLabel = document.getElementById('weaponLabelRight');
            if (leftLabel) leftLabel.textContent = prevWeapon;
            if (rightLabel) rightLabel.textContent = nextWeapon;
        }
        
        // Notification system
        let notifications = [];
        
        function showNotification(text, color) {
            notifications.push({
                text: text,
                color: color,
                y: player.y - 50,
                alpha: 1,
                life: 60
            });
        }
        
        function updateNotifications() {
            notifications = notifications.filter(n => {
                n.y -= 1;
                n.life--;
                n.alpha = n.life / 60;
                return n.life > 0;
            });
        }
        
        function drawNotifications() {
            notifications.forEach(n => {
                ctx.save();
                ctx.globalAlpha = n.alpha;
                ctx.fillStyle = n.color;
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.font = 'bold 16px Courier New';
                ctx.textAlign = 'center';
                ctx.strokeText(n.text, player.x, n.y);
                ctx.fillText(n.text, player.x, n.y);
                ctx.restore();
            });
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // PARTICLES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function spawnParticles(x, y, color) {
            for (let i = 0; i < 8; i++) {
                particles.push({
                    x: x,
                    y: y,
                    dx: (Math.random() - 0.5) * 6,
                    dy: (Math.random() - 0.5) * 6,
                    life: 20,
                    color: color,
                    type: 'particle'
                });
            }
        }
        
        // Hit sparkles - small satisfying sparks when enemy takes damage
        function spawnHitSparkles(x, y, color) {
            const sparkCount = 4 + Math.floor(Math.random() * 3);
            for (let i = 0; i < sparkCount; i++) {
                const angle = (Math.PI * 2 / sparkCount) * i + Math.random() * 0.5;
                const speed = 2 + Math.random() * 3;
                particles.push({
                    x: x + (Math.random() - 0.5) * 10,
                    y: y + (Math.random() - 0.5) * 10,
                    dx: Math.cos(angle) * speed,
                    dy: Math.sin(angle) * speed,
                    life: 12 + Math.floor(Math.random() * 8),
                    color: color,
                    type: 'sparkle',
                    size: 1 + Math.random() * 2
                });
            }
        }
        
        // Boss damage explosion - bigger, more dramatic
        function spawnBossExplosion(x, y) {
            // Core flash
            particles.push({
                x: x,
                y: y,
                type: 'bossFlash',
                life: 8,
                size: 30
            });
            
            // Explosion ring
            particles.push({
                x: x,
                y: y,
                type: 'explosionRing',
                life: 15,
                size: 10
            });
            
            // Fire particles
            for (let i = 0; i < 12; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = 3 + Math.random() * 5;
                particles.push({
                    x: x,
                    y: y,
                    dx: Math.cos(angle) * speed,
                    dy: Math.sin(angle) * speed,
                    life: 20 + Math.floor(Math.random() * 15),
                    color: Math.random() > 0.5 ? '#ff6600' : '#ffaa00',
                    type: 'particle',
                    size: 2 + Math.random() * 3
                });
            }
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // DRAWING FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function drawPlayer() {
            // Blink when invulnerable (skip drawing every other frame)
            if (playerInvulnerable && Math.floor(invulnerableTimer / 4) % 2 === 0) {
                return; // Skip drawing this frame = blink effect
            }
            
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Flash white/red tint during invulnerability
            if (playerInvulnerable) {
                ctx.globalAlpha = 0.8;
            }
            
            const t = Date.now() / 100;
            const flicker = Math.sin(t * 3) * 2;
            
            // Engine thrusters (cyan flames)
            ctx.shadowColor = '#00ffff';
            ctx.shadowBlur = 15;
            
            // Left thruster flame
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(-8, 12);
            ctx.lineTo(-10, 22 + flicker);
            ctx.lineTo(-6, 12);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(-8, 12);
            ctx.lineTo(-9, 17 + flicker * 0.5);
            ctx.lineTo(-7, 12);
            ctx.closePath();
            ctx.fill();
            
            // Right thruster flame
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(8, 12);
            ctx.lineTo(10, 22 + flicker);
            ctx.lineTo(6, 12);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(8, 12);
            ctx.lineTo(9, 17 + flicker * 0.5);
            ctx.lineTo(7, 12);
            ctx.closePath();
            ctx.fill();
            
            ctx.shadowBlur = 0;
            
            // Main body (white mecha rabbit)
            ctx.fillStyle = '#e8e8f0';
            ctx.strokeStyle = '#888';
            ctx.lineWidth = 1;
            
            // Body hull
            ctx.beginPath();
            ctx.moveTo(0, -12); // Nose
            ctx.lineTo(10, 0);
            ctx.lineTo(12, 10);
            ctx.lineTo(6, 14);
            ctx.lineTo(-6, 14);
            ctx.lineTo(-12, 10);
            ctx.lineTo(-10, 0);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Side armor plates (darker)
            ctx.fillStyle = '#c0c0c8';
            ctx.beginPath();
            ctx.moveTo(-10, 0);
            ctx.lineTo(-14, 5);
            ctx.lineTo(-12, 12);
            ctx.lineTo(-10, 10);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(10, 0);
            ctx.lineTo(14, 5);
            ctx.lineTo(12, 12);
            ctx.lineTo(10, 10);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Bunny ears (white with pink inner)
            ctx.fillStyle = '#f0f0f5';
            ctx.beginPath();
            ctx.moveTo(-5, -10);
            ctx.quadraticCurveTo(-8, -25, -4, -28);
            ctx.quadraticCurveTo(-1, -25, -3, -10);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(5, -10);
            ctx.quadraticCurveTo(8, -25, 4, -28);
            ctx.quadraticCurveTo(1, -25, 3, -10);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Inner ears (pink)
            ctx.fillStyle = '#ffaaaa';
            ctx.beginPath();
            ctx.moveTo(-4, -12);
            ctx.quadraticCurveTo(-6, -22, -4, -24);
            ctx.quadraticCurveTo(-2, -22, -3, -12);
            ctx.closePath();
            ctx.fill();
            
            ctx.beginPath();
            ctx.moveTo(4, -12);
            ctx.quadraticCurveTo(6, -22, 4, -24);
            ctx.quadraticCurveTo(2, -22, 3, -12);
            ctx.closePath();
            ctx.fill();
            
            // Cyan visor (glowing)
            ctx.shadowColor = '#00ffff';
            ctx.shadowBlur = 10;
            ctx.fillStyle = '#00ddff';
            ctx.beginPath();
            ctx.ellipse(0, -4, 6, 4, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Visor shine
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.ellipse(-2, -5, 2, 1.5, -0.3, 0, Math.PI * 2);
            ctx.fill();
            
            // Thruster housings
            ctx.shadowBlur = 0;
            ctx.fillStyle = '#666';
            ctx.fillRect(-10, 10, 4, 5);
            ctx.fillRect(6, 10, 4, 5);
            
            ctx.restore();
        }
        
        function drawPawn(x, y) {
            ctx.save();
            ctx.translate(x, y);
            
            const t = Date.now() / 100;
            const flicker = Math.sin(t * 4) * 2;
            
            // Thruster flames (small, bottom)
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(-4, 10);
            ctx.lineTo(-5, 16 + flicker);
            ctx.lineTo(-3, 10);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(4, 10);
            ctx.lineTo(5, 16 + flicker);
            ctx.lineTo(3, 10);
            ctx.closePath();
            ctx.fill();
            
            // Inner flame (yellow)
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(-4, 10);
            ctx.lineTo(-4.5, 13 + flicker * 0.5);
            ctx.lineTo(-3.5, 10);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(4, 10);
            ctx.lineTo(4.5, 13 + flicker * 0.5);
            ctx.lineTo(3.5, 10);
            ctx.closePath();
            ctx.fill();
            
            // Body (silver dome shape)
            const gradient = ctx.createLinearGradient(-8, -10, 8, 10);
            gradient.addColorStop(0, '#d0d0d8');
            gradient.addColorStop(0.3, '#f0f0f5');
            gradient.addColorStop(0.7, '#a0a0a8');
            gradient.addColorStop(1, '#707078');
            
            ctx.fillStyle = gradient;
            ctx.strokeStyle = '#505058';
            ctx.lineWidth = 1;
            
            // Base/skirt
            ctx.beginPath();
            ctx.moveTo(-8, 8);
            ctx.lineTo(-6, 12);
            ctx.lineTo(6, 12);
            ctx.lineTo(8, 8);
            ctx.lineTo(6, 4);
            ctx.lineTo(-6, 4);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Main dome body
            ctx.beginPath();
            ctx.moveTo(-7, 5);
            ctx.quadraticCurveTo(-8, 0, -6, -5);
            ctx.quadraticCurveTo(0, -12, 6, -5);
            ctx.quadraticCurveTo(8, 0, 7, 5);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Top cap
            ctx.fillStyle = '#808088';
            ctx.beginPath();
            ctx.arc(0, -8, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Red glowing eyes
            ctx.shadowColor = '#ff0000';
            ctx.shadowBlur = 8;
            ctx.fillStyle = '#ff3300';
            ctx.beginPath();
            ctx.ellipse(-3, -2, 2, 1.5, -0.2, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(3, -2, 2, 1.5, 0.2, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye cores (bright)
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(-3, -2, 0.8, 0, Math.PI * 2);
            ctx.arc(3, -2, 0.8, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }
        
        function drawKnight(x, y) {
            ctx.save();
            ctx.translate(x, y);
            
            const t = Date.now() / 100;
            const flicker = Math.sin(t * 3) * 2;
            
            // Thruster flames (tank style, center bottom)
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(-3, 12);
            ctx.lineTo(-5, 20 + flicker);
            ctx.lineTo(5, 20 + flicker);
            ctx.lineTo(3, 12);
            ctx.closePath();
            ctx.fill();
            
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(-2, 12);
            ctx.lineTo(-3, 16 + flicker * 0.5);
            ctx.lineTo(3, 16 + flicker * 0.5);
            ctx.lineTo(2, 12);
            ctx.closePath();
            ctx.fill();
            
            // Body (dark gray castle/rook style)
            const gradient = ctx.createLinearGradient(-10, -12, 10, 12);
            gradient.addColorStop(0, '#505060');
            gradient.addColorStop(0.3, '#606070');
            gradient.addColorStop(0.7, '#404050');
            gradient.addColorStop(1, '#303040');
            
            ctx.fillStyle = gradient;
            ctx.strokeStyle = '#202030';
            ctx.lineWidth = 1;
            
            // Tank treads/base
            ctx.fillStyle = '#303038';
            ctx.fillRect(-12, 8, 6, 6);
            ctx.fillRect(6, 8, 6, 6);
            
            // Tread details
            ctx.strokeStyle = '#404048';
            for (let i = 0; i < 3; i++) {
                ctx.beginPath();
                ctx.moveTo(-11, 9 + i * 2);
                ctx.lineTo(-7, 9 + i * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(7, 9 + i * 2);
                ctx.lineTo(11, 9 + i * 2);
                ctx.stroke();
            }
            
            // Main body (boxy rook shape)
            ctx.fillStyle = gradient;
            ctx.strokeStyle = '#202030';
            ctx.beginPath();
            ctx.rect(-10, -4, 20, 14);
            ctx.fill();
            ctx.stroke();
            
            // Castle battlements on top
            ctx.fillStyle = '#505060';
            ctx.fillRect(-10, -10, 5, 6);
            ctx.fillRect(-2, -10, 5, 6);
            ctx.fillRect(5, -10, 5, 6);
            
            ctx.strokeStyle = '#202030';
            ctx.strokeRect(-10, -10, 5, 6);
            ctx.strokeRect(-2, -10, 5, 6);
            ctx.strokeRect(5, -10, 5, 6);
            
            // Side lights (yellow)
            ctx.fillStyle = '#ffcc00';
            ctx.shadowColor = '#ffcc00';
            ctx.shadowBlur = 5;
            ctx.fillRect(-9, 4, 3, 2);
            ctx.fillRect(6, 4, 3, 2);
            
            // Red glowing eyes (angry slits)
            ctx.shadowColor = '#ff0000';
            ctx.shadowBlur = 10;
            ctx.fillStyle = '#ff3300';
            ctx.beginPath();
            ctx.moveTo(-6, -2);
            ctx.lineTo(-2, 0);
            ctx.lineTo(-6, 2);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(6, -2);
            ctx.lineTo(2, 0);
            ctx.lineTo(6, 2);
            ctx.closePath();
            ctx.fill();
            
            // Eye cores
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(-4, 0, 1, 0, Math.PI * 2);
            ctx.arc(4, 0, 1, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }
        
        function drawBubbleShooter(x, y) {
            ctx.save();
            ctx.translate(x, y);
            
            const t = Date.now() / 100;
            const flicker = Math.sin(t * 3.5) * 2;
            
            // Thruster flame (single center)
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(-3, 12);
            ctx.lineTo(0, 22 + flicker);
            ctx.lineTo(3, 12);
            ctx.closePath();
            ctx.fill();
            
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(-2, 12);
            ctx.lineTo(0, 17 + flicker * 0.5);
            ctx.lineTo(2, 12);
            ctx.closePath();
            ctx.fill();
            
            // Body (bishop style - pointed top, silver)
            const gradient = ctx.createLinearGradient(-8, -15, 8, 15);
            gradient.addColorStop(0, '#c0c0c8');
            gradient.addColorStop(0.3, '#e0e0e8');
            gradient.addColorStop(0.7, '#909098');
            gradient.addColorStop(1, '#606068');
            
            ctx.fillStyle = gradient;
            ctx.strokeStyle = '#404048';
            ctx.lineWidth = 1;
            
            // Base/skirt
            ctx.beginPath();
            ctx.moveTo(-8, 8);
            ctx.lineTo(-6, 14);
            ctx.lineTo(6, 14);
            ctx.lineTo(8, 8);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Main body (tapered)
            ctx.beginPath();
            ctx.moveTo(-8, 8);
            ctx.lineTo(-6, -4);
            ctx.lineTo(6, -4);
            ctx.lineTo(8, 8);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Bishop hat/helmet (pointed)
            ctx.beginPath();
            ctx.moveTo(-6, -4);
            ctx.lineTo(-4, -12);
            ctx.lineTo(0, -18);
            ctx.lineTo(4, -12);
            ctx.lineTo(6, -4);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Top orb
            ctx.fillStyle = '#707078';
            ctx.beginPath();
            ctx.arc(0, -18, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Chest core (glowing orange like in concept)
            ctx.shadowColor = '#ff6600';
            ctx.shadowBlur = 10;
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.arc(0, 4, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(0, 4, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Red glowing eyes
            ctx.shadowColor = '#ff0000';
            ctx.shadowBlur = 8;
            ctx.fillStyle = '#ff3300';
            ctx.beginPath();
            ctx.ellipse(-3, -6, 2, 1.5, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(3, -6, 2, 1.5, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye cores
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(-3, -6, 0.8, 0, Math.PI * 2);
            ctx.arc(3, -6, 0.8, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }
        
        // BOUNCER - Bouncing ball enemy with high HP
        function drawBouncer(x, y, enemy) {
            ctx.save();
            ctx.translate(x, y);
            
            const t = Date.now() / 100;
            const squish = 1 + Math.sin(t) * 0.1; // Slight squish animation
            
            // Glow effect
            ctx.shadowColor = '#00ffff';
            ctx.shadowBlur = 15;
            
            // Main ball body - electric blue
            const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 14);
            gradient.addColorStop(0, '#88ffff');
            gradient.addColorStop(0.5, '#00ccff');
            gradient.addColorStop(1, '#0066aa');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.ellipse(0, 0, 14 * squish, 14 / squish, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Electric arcs
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 1;
            ctx.shadowBlur = 5;
            for (let i = 0; i < 3; i++) {
                const angle = (t + i * 2.1) % (Math.PI * 2);
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(Math.cos(angle) * 12, Math.sin(angle) * 12);
                ctx.stroke();
            }
            
            // Face - determined expression
            ctx.shadowBlur = 0;
            ctx.fillStyle = '#003366';
            // Eyes (determined slant)
            ctx.beginPath();
            ctx.ellipse(-5, -2, 3, 4, -0.3, 0, Math.PI * 2);
            ctx.ellipse(5, -2, 3, 4, 0.3, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye shine
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(-6, -4, 1.5, 0, Math.PI * 2);
            ctx.arc(4, -4, 1.5, 0, Math.PI * 2);
            ctx.fill();
            
            // Determined mouth
            ctx.strokeStyle = '#003366';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(-4, 5);
            ctx.lineTo(4, 5);
            ctx.stroke();
            
            ctx.restore();
        }
        
        // CHARGER - Enemy that charges at player
        function drawCharger(x, y, enemy) {
            ctx.save();
            ctx.translate(x, y);
            
            const isCharging = enemy && enemy.isCharging;
            const t = Date.now() / 100;
            
            // Glow when charging
            if (isCharging) {
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 20 + Math.sin(t * 5) * 10;
            } else {
                ctx.shadowColor = '#ff6600';
                ctx.shadowBlur = 8;
            }
            
            // Body - angular/aggressive shape (like a ram)
            ctx.fillStyle = isCharging ? '#ff3333' : '#cc4444';
            ctx.beginPath();
            ctx.moveTo(-15, 0);
            ctx.lineTo(-10, -12);
            ctx.lineTo(10, -10);
            ctx.lineTo(15, 0);
            ctx.lineTo(10, 10);
            ctx.lineTo(-10, 12);
            ctx.closePath();
            ctx.fill();
            
            ctx.strokeStyle = '#880000';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Horns
            ctx.fillStyle = '#ffcc00';
            ctx.beginPath();
            ctx.moveTo(-8, -10);
            ctx.lineTo(-18, -18);
            ctx.lineTo(-12, -8);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(-8, 10);
            ctx.lineTo(-18, 18);
            ctx.lineTo(-12, 8);
            ctx.closePath();
            ctx.fill();
            
            // Angry eyes
            ctx.shadowBlur = 0;
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.ellipse(2, -3, 4, 3, 0, 0, Math.PI * 2);
            ctx.ellipse(2, 3, 4, 3, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Pupils - looking forward when charging
            ctx.fillStyle = isCharging ? '#ff0000' : '#000';
            ctx.beginPath();
            ctx.arc(4, -3, 2, 0, Math.PI * 2);
            ctx.arc(4, 3, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Charge indicator (! above head when about to charge)
            if (enemy && enemy.chargeTimer > 60 && !isCharging) {
                ctx.fillStyle = '#ff0';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('!', 0, -22);
            }
            
            // Speed lines when charging
            if (isCharging) {
                ctx.strokeStyle = 'rgba(255, 100, 100, 0.5)';
                ctx.lineWidth = 2;
                for (let i = 0; i < 3; i++) {
                    const ly = -8 + i * 8;
                    ctx.beginPath();
                    ctx.moveTo(-20, ly);
                    ctx.lineTo(-35 - Math.random() * 10, ly);
                    ctx.stroke();
                }
            }
            
            ctx.restore();
        }
        
        function drawShields() {
            if (shields <= 0) return;
            
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Draw shield rings
            const time = Date.now() / 500;
            
            for (let i = 0; i < shields; i++) {
                const offset = (time + i * 2.1) % (Math.PI * 2);
                const alpha = 0.4 + 0.2 * Math.sin(time * 2 + i);
                
                ctx.strokeStyle = `rgba(0, 170, 255, ${alpha})`;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(0, 0, 18 + i * 4, offset, offset + Math.PI * 1.3);
                ctx.stroke();
                
                // Shield sparkle
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                const sparkleX = Math.cos(offset) * (18 + i * 4);
                const sparkleY = Math.sin(offset) * (18 + i * 4);
                ctx.beginPath();
                ctx.arc(sparkleX, sparkleY, 2, 0, Math.PI * 2);
                ctx.fill();
            }
            
            ctx.restore();
        }
        
        function drawBoss() {
            if (!boss) return;
            
            ctx.save();
            ctx.translate(boss.x, boss.y);
            
            const healthPercent = boss.health / boss.maxHealth;
            boss.animTimer = (boss.animTimer || 0) + 1;
            
            // Damage glow for all bosses
            if (healthPercent < 0.5) {
                ctx.shadowColor = '#f00';
                ctx.shadowBlur = 15 + Math.sin(Date.now() / 100) * 8;
            }
            
            // Draw based on boss type
            if (boss.type === 'mainboss') {
                drawMainBoss(boss.bossNum, healthPercent, boss.animTimer);
            } else {
                drawMiniBoss(healthPercent);
            }
            
            // Health bar
            ctx.shadowBlur = 0;
            const barWidth = boss.type === 'mainboss' ? 100 : 80;
            ctx.fillStyle = '#333';
            ctx.fillRect(-barWidth/2, 45, barWidth, 8);
            ctx.fillStyle = healthPercent > 0.3 ? '#f00' : '#ff0';
            ctx.fillRect(-barWidth/2, 45, barWidth * healthPercent, 8);
            ctx.strokeStyle = '#666';
            ctx.strokeRect(-barWidth/2, 45, barWidth, 8);
            
            // Boss name for main bosses
            if (boss.type === 'mainboss') {
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 10px Courier New';
                ctx.textAlign = 'center';
                ctx.fillText(MAIN_BOSS_NAMES[boss.bossNum - 1], 0, 62);
            }
            
            ctx.restore();
        }
        
        function drawMiniBoss(entityOrHealthPercent) {
            // Can be called with a health percent (for main boss) or enemy object (for miniboss2)
            let healthPercent;
            
            if (typeof entityOrHealthPercent === 'number') {
                healthPercent = entityOrHealthPercent;
            } else if (entityOrHealthPercent && entityOrHealthPercent.health !== undefined) {
                const enemy = entityOrHealthPercent;
                healthPercent = enemy.health / (enemy.maxHealth || 80);
                // For enemy mini-bosses, we draw at their position
                ctx.save();
                ctx.translate(enemy.x, enemy.y);
            }
            
            const t = Date.now() / 100;
            const damaged = healthPercent < 0.3;
            
            // Leg thruster flames (4 legs)
            const flicker = Math.sin(t * 4) * 3;
            ctx.fillStyle = '#ff6600';
            // Back legs
            ctx.beginPath();
            ctx.moveTo(-25, 25);
            ctx.lineTo(-27, 38 + flicker);
            ctx.lineTo(-23, 25);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(20, 25);
            ctx.lineTo(22, 38 + flicker);
            ctx.lineTo(18, 25);
            ctx.closePath();
            ctx.fill();
            // Front legs
            ctx.beginPath();
            ctx.moveTo(-10, 28);
            ctx.lineTo(-12, 40 + flicker * 0.8);
            ctx.lineTo(-8, 28);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(5, 28);
            ctx.lineTo(7, 40 + flicker * 0.8);
            ctx.lineTo(3, 28);
            ctx.closePath();
            ctx.fill();
            
            // Inner flames (yellow)
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.moveTo(-25, 25);
            ctx.lineTo(-26, 32 + flicker * 0.5);
            ctx.lineTo(-24, 25);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(20, 25);
            ctx.lineTo(21, 32 + flicker * 0.5);
            ctx.lineTo(19, 25);
            ctx.closePath();
            ctx.fill();
            
            // Cape (flowing red, behind body)
            ctx.fillStyle = damaged ? '#aa3333' : '#cc2222';
            ctx.beginPath();
            ctx.moveTo(15, -15);
            ctx.quadraticCurveTo(35 + Math.sin(t) * 5, -5, 40 + Math.sin(t * 1.2) * 8, 15);
            ctx.quadraticCurveTo(35, 25 + Math.sin(t * 0.8) * 3, 25, 20);
            ctx.lineTo(20, 0);
            ctx.closePath();
            ctx.fill();
            
            // Armored legs (dark gray metal)
            const metalGradient = ctx.createLinearGradient(-30, 0, 30, 0);
            metalGradient.addColorStop(0, '#404050');
            metalGradient.addColorStop(0.3, '#606070');
            metalGradient.addColorStop(0.7, '#505060');
            metalGradient.addColorStop(1, '#303040');
            
            ctx.fillStyle = metalGradient;
            ctx.strokeStyle = '#202030';
            ctx.lineWidth = 1;
            
            // Back legs
            ctx.fillRect(-28, 10, 8, 18);
            ctx.strokeRect(-28, 10, 8, 18);
            ctx.fillRect(17, 10, 8, 18);
            ctx.strokeRect(17, 10, 8, 18);
            
            // Front legs
            ctx.fillRect(-13, 12, 7, 18);
            ctx.strokeRect(-13, 12, 7, 18);
            ctx.fillRect(2, 12, 7, 18);
            ctx.strokeRect(2, 12, 7, 18);
            
            // Armored body
            ctx.fillStyle = damaged ? '#503040' : '#404050';
            ctx.beginPath();
            ctx.moveTo(-25, 5);
            ctx.lineTo(-20, -10);
            ctx.lineTo(15, -15);
            ctx.lineTo(22, 0);
            ctx.lineTo(20, 15);
            ctx.lineTo(-22, 15);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Armor plates detail
            ctx.strokeStyle = '#606070';
            ctx.beginPath();
            ctx.moveTo(-15, -5);
            ctx.lineTo(10, -8);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(-18, 5);
            ctx.lineTo(15, 3);
            ctx.stroke();
            
            // Chest core (glowing orange)
            ctx.shadowColor = '#ff6600';
            ctx.shadowBlur = 15;
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.arc(-5, 2, 6, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(-5, 2, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
            
            // Neck armor
            ctx.fillStyle = metalGradient;
            ctx.beginPath();
            ctx.moveTo(-20, -10);
            ctx.lineTo(-30, -25);
            ctx.lineTo(-22, -28);
            ctx.lineTo(-15, -15);
            ctx.closePath();
            ctx.fill();
            ctx.strokeStyle = '#202030';
            ctx.stroke();
            
            // Armored head
            ctx.beginPath();
            ctx.moveTo(-30, -25);
            ctx.lineTo(-45, -20);
            ctx.lineTo(-48, -28);
            ctx.lineTo(-38, -35);
            ctx.lineTo(-25, -32);
            ctx.lineTo(-22, -28);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Horn (silver/metallic)
            ctx.fillStyle = '#a0a0a8';
            ctx.beginPath();
            ctx.moveTo(-48, -28);
            ctx.lineTo(-58, -32);
            ctx.lineTo(-48, -24);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Red glowing eye
            ctx.shadowColor = '#ff0000';
            ctx.shadowBlur = 12;
            ctx.fillStyle = '#ff3300';
            ctx.beginPath();
            ctx.ellipse(-38, -27, 4, 3, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#ffaa00';
            ctx.beginPath();
            ctx.arc(-38, -27, 1.5, 0, Math.PI * 2);
            ctx.fill();
            
            // Health bar for miniboss2
            if (typeof entityOrHealthPercent !== 'number') {
                ctx.shadowBlur = 0;
                const barWidth = 70;
                const barHeight = 6;
                ctx.fillStyle = '#333';
                ctx.fillRect(-barWidth/2, -50, barWidth, barHeight);
                ctx.fillStyle = healthPercent > 0.3 ? '#ff0' : '#f00';
                ctx.fillRect(-barWidth/2, -50, barWidth * healthPercent, barHeight);
                ctx.restore();
            }
        }
        
        function drawMainBoss(bossNum, healthPercent, animTimer) {
            switch(bossNum) {
                case 1: drawBoss1_StandingHorse(healthPercent, animTimer); break;
                case 2: drawBoss2_GallopingHorse(healthPercent, animTimer); break;
                case 3: drawBoss3_BabyHorse(healthPercent, animTimer); break;
                case 4: drawBoss4_BasketballHorse(healthPercent, animTimer); break;
            }
        }
        
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // SPRITE-BASED BOSS DRAWING FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        // Boss 1: Standing cute horse (top-left image)
        function drawBoss1_StandingHorse(hp, t) {
            const damaged = hp < 0.3;
            const wiggle = Math.sin(t / 15) * 3;
            const bounce = Math.sin(t / 10) * 2;
            const size = BOSS_SIZES[1];
            const bossIndex = 1;
            
            // Draw damage flash
            if (damaged && Math.sin(t / 2) > 0) {
                ctx.globalAlpha = 0.7;
            }
            
            // Apply wiggle animation
            ctx.save();
            ctx.rotate(wiggle * 0.02);
            ctx.translate(0, bounce);
            
            // Draw the sprite
            const drawX = -size.w/2 + wiggle;
            const drawY = -size.h/2 + bounce;
            if (bossSpriteLoadCount >= 4) {
                ctx.drawImage(bossSprites[bossIndex], drawX, drawY, size.w, size.h);
            } else {
                // Fallback if image not loaded
                ctx.fillStyle = '#d4a574';
                ctx.fillRect(-size.w/2, -size.h/2, size.w, size.h);
            }
            
            ctx.restore();
            ctx.globalAlpha = 1;
            
            // Add glow effect when damaged
            if (damaged) {
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 15 + Math.sin(t / 3) * 5;
                ctx.strokeStyle = '#ff0000';
                ctx.lineWidth = 2;
                ctx.strokeRect(-size.w/2, -size.h/2, size.w, size.h);
                ctx.shadowBlur = 0;
            }
        }
        
        // Boss 2: Galloping/Running horse (top-right image)
        function drawBoss2_GallopingHorse(hp, t) {
            const damaged = hp < 0.3;
            const runBob = Math.sin(t / 5) * 4;
            const tilt = Math.sin(t / 8) * 0.05;
            const size = BOSS_SIZES[2];
            const bossIndex = 2;
            
            if (damaged && Math.sin(t / 2) > 0) {
                ctx.globalAlpha = 0.7;
            }
            
            ctx.save();
            ctx.rotate(tilt);
            ctx.translate(0, runBob);
            
            if (bossSpriteLoadCount >= 4) {
                ctx.drawImage(bossSprites[bossIndex], -size.w/2, -size.h/2, size.w, size.h);
            } else {
                ctx.fillStyle = '#c4956a';
                ctx.fillRect(-size.w/2, -size.h/2, size.w, size.h);
            }
            
            ctx.restore();
            ctx.globalAlpha = 1;
            
            if (damaged) {
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 15 + Math.sin(t / 3) * 5;
                ctx.strokeStyle = '#ff0000';
                ctx.lineWidth = 2;
                ctx.strokeRect(-size.w/2, -size.h/2, size.w, size.h);
                ctx.shadowBlur = 0;
            }
        }
        
        // Boss 3: Baby horse sitting (bottom-left image)
        function drawBoss3_BabyHorse(hp, t) {
            const damaged = hp < 0.3;
            const wiggle = Math.sin(t / 12) * 4;
            const headBob = Math.sin(t / 8) * 2;
            const size = BOSS_SIZES[3];
            const bossIndex = 3;
            
            if (damaged && Math.sin(t / 2) > 0) {
                ctx.globalAlpha = 0.7;
            }
            
            ctx.save();
            ctx.rotate(wiggle * 0.03);
            ctx.translate(0, headBob);
            
            if (bossSpriteLoadCount >= 4) {
                ctx.drawImage(bossSprites[bossIndex], -size.w/2, -size.h/2, size.w, size.h);
            } else {
                ctx.fillStyle = '#8B6914';
                ctx.fillRect(-size.w/2, -size.h/2, size.w, size.h);
            }
            
            ctx.restore();
            ctx.globalAlpha = 1;
            
            if (damaged) {
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 15 + Math.sin(t / 3) * 5;
                ctx.strokeStyle = '#ff0000';
                ctx.lineWidth = 2;
                ctx.strokeRect(-size.w/2, -size.h/2, size.w, size.h);
                ctx.shadowBlur = 0;
            }
        }
        
        // Boss 4: Basketball horse - BIG but can still move! (bottom-right image)
        function drawBoss4_BasketballHorse(hp, t) {
            const damaged = hp < 0.3;
            const bounce = Math.abs(Math.sin(t / 6)) * 5;
            const tilt = Math.sin(t / 10) * 0.04;
            const pulse = Math.sin(t / 4) * 3;
            const size = BOSS_SIZES[4];
            const bossIndex = 4;
            
            if (damaged && Math.sin(t / 2) > 0) {
                ctx.globalAlpha = 0.7;
            }
            
            ctx.save();
            ctx.rotate(tilt);
            ctx.translate(0, bounce);
            ctx.scale(1 + pulse * 0.01, 1 + pulse * 0.01);
            
            if (bossSpriteLoadCount >= 4) {
                ctx.drawImage(bossSprites[bossIndex], -size.w/2, -size.h/2, size.w, size.h);
            } else {
                ctx.fillStyle = '#5a3a1a';
                ctx.fillRect(-size.w/2, -size.h/2, size.w, size.h);
            }
            
            ctx.restore();
            ctx.globalAlpha = 1;
            
            // Boss 4 has extra intimidation glow
            ctx.shadowColor = damaged ? '#ff0000' : '#ff6600';
            ctx.shadowBlur = 10 + pulse;
            ctx.strokeStyle = damaged ? '#ff0000' : '#ff8800';
            ctx.lineWidth = 3;
            ctx.strokeRect(-size.w/2 - 2, -size.h/2 - 2, size.w + 4, size.h + 4);
            ctx.shadowBlur = 0;
        }
        
        function drawBullets() {
            // Player bullets
            playerBullets.forEach(b => {
                ctx.fillStyle = b.color;
                ctx.shadowColor = b.color;
                ctx.shadowBlur = 8;
                
                if (b.type === 'homing') {
                    // Missile shape
                    ctx.save();
                    ctx.translate(b.x, b.y);
                    ctx.fillRect(-2, -6, 4, 12);
                    ctx.beginPath();
                    ctx.moveTo(0, -10);
                    ctx.lineTo(-3, -6);
                    ctx.lineTo(3, -6);
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                } else {
                    ctx.beginPath();
                    ctx.ellipse(b.x, b.y, 3, 6, 0, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
            
            // AMAZING LASER BEAM - multi-layered glow effect
            if (laserActive && currentWeapon === 'LASER') {
                const level = getWeaponLevel();
                const t = Date.now() / 50; // Animation timer
                const baseWidth = laserWidth;
                const laserY = player.y - 20;
                
                // Layer 1: Outer glow (widest, most transparent)
                ctx.save();
                const outerGlow = ctx.createLinearGradient(player.x - baseWidth * 3, 0, player.x + baseWidth * 3, 0);
                outerGlow.addColorStop(0, 'rgba(255, 0, 255, 0)');
                outerGlow.addColorStop(0.3, 'rgba(180, 0, 255, 0.15)');
                outerGlow.addColorStop(0.5, 'rgba(255, 100, 255, 0.3)');
                outerGlow.addColorStop(0.7, 'rgba(180, 0, 255, 0.15)');
                outerGlow.addColorStop(1, 'rgba(255, 0, 255, 0)');
                ctx.fillStyle = outerGlow;
                ctx.fillRect(player.x - baseWidth * 3, 0, baseWidth * 6, laserY);
                
                // Layer 2: Mid glow with flicker
                const flicker = 0.7 + Math.sin(t * 3) * 0.3;
                const midGlow = ctx.createLinearGradient(player.x - baseWidth * 1.5, 0, player.x + baseWidth * 1.5, 0);
                midGlow.addColorStop(0, 'rgba(255, 0, 255, 0)');
                midGlow.addColorStop(0.2, `rgba(255, 50, 255, ${0.4 * flicker})`);
                midGlow.addColorStop(0.5, `rgba(255, 150, 255, ${0.7 * flicker})`);
                midGlow.addColorStop(0.8, `rgba(255, 50, 255, ${0.4 * flicker})`);
                midGlow.addColorStop(1, 'rgba(255, 0, 255, 0)');
                ctx.fillStyle = midGlow;
                ctx.fillRect(player.x - baseWidth * 1.5, 0, baseWidth * 3, laserY);
                
                // Layer 3: Inner beam with energy pulses
                const innerGlow = ctx.createLinearGradient(player.x - baseWidth, 0, player.x + baseWidth, 0);
                innerGlow.addColorStop(0, 'rgba(255, 0, 255, 0)');
                innerGlow.addColorStop(0.3, 'rgba(255, 100, 255, 0.9)');
                innerGlow.addColorStop(0.5, 'rgba(255, 255, 255, 1)');
                innerGlow.addColorStop(0.7, 'rgba(255, 100, 255, 0.9)');
                innerGlow.addColorStop(1, 'rgba(255, 0, 255, 0)');
                ctx.fillStyle = innerGlow;
                ctx.fillRect(player.x - baseWidth, 0, baseWidth * 2, laserY);
                
                // Layer 4: Hot core (white center)
                const coreWidth = Math.max(2, baseWidth * 0.3);
                ctx.fillStyle = '#ffffff';
                ctx.shadowColor = '#ff00ff';
                ctx.shadowBlur = 15;
                ctx.fillRect(player.x - coreWidth/2, 0, coreWidth, laserY);
                
                // Layer 5: Energy pulses traveling up the beam
                ctx.shadowBlur = 20;
                for (let i = 0; i < 3; i++) {
                    const pulseY = (laserY - ((t * 15 + i * laserY/3) % laserY));
                    const pulseAlpha = 0.8 - (pulseY / laserY) * 0.5;
                    const pulseWidth = baseWidth * (0.5 + Math.sin(t + i) * 0.3);
                    
                    ctx.fillStyle = `rgba(255, 200, 255, ${pulseAlpha})`;
                    ctx.beginPath();
                    ctx.ellipse(player.x, pulseY, pulseWidth, 4, 0, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Layer 6: Sparkles along the beam at higher levels
                if (level >= 3) {
                    ctx.shadowBlur = 8;
                    for (let i = 0; i < level * 2; i++) {
                        const sparkY = Math.random() * laserY;
                        const sparkX = player.x + (Math.random() - 0.5) * baseWidth;
                        const sparkSize = 1 + Math.random() * 2;
                        ctx.fillStyle = `rgba(255, 255, 255, ${0.5 + Math.random() * 0.5})`;
                        ctx.beginPath();
                        ctx.arc(sparkX, sparkY, sparkSize, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Impact point at top of screen
                ctx.shadowColor = '#ff88ff';
                ctx.shadowBlur = 30;
                ctx.fillStyle = 'rgba(255, 200, 255, 0.8)';
                ctx.beginPath();
                ctx.ellipse(player.x, 5, baseWidth * 1.5 + Math.sin(t * 2) * 3, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.restore();
            }
            
            ctx.shadowBlur = 0;
            
            // Enemy bullets
            enemyBullets.forEach(b => {
                if (b.isBubble) {
                    // Big bubble bullet
                    const size = b.size || 10;
                    ctx.fillStyle = 'rgba(255, 100, 50, 0.7)';
                    ctx.strokeStyle = '#ff6600';
                    ctx.lineWidth = 2;
                    ctx.shadowColor = '#ff6600';
                    ctx.shadowBlur = 10;
                    ctx.beginPath();
                    ctx.arc(b.x, b.y, size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.stroke();
                    
                    // Bubble shine
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                    ctx.beginPath();
                    ctx.arc(b.x - size/3, b.y - size/3, size/4, 0, Math.PI * 2);
                    ctx.fill();
                } else {
                    // Normal bullet
                    ctx.fillStyle = '#ff4444';
                    ctx.shadowColor = '#ff4444';
                    ctx.shadowBlur = 6;
                    ctx.beginPath();
                    ctx.ellipse(b.x, b.y, 3, 5, 0, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
            
            ctx.shadowBlur = 0;
        }
        
        function drawPowerUps() {
            powerUps.forEach(p => {
                ctx.save();
                ctx.translate(p.x, p.y);
                
                const color = getPowerUpColor(p.type);
                const size = 28; // Bigger size
                
                // Pulsing glow effect
                const pulse = Math.sin(Date.now() / 150) * 5;
                ctx.shadowColor = color;
                ctx.shadowBlur = 20 + pulse;
                
                // Rounded box background
                ctx.fillStyle = 'rgba(0, 0, 0, 0.85)';
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                
                // Draw rounded rect
                const r = 6;
                ctx.beginPath();
                ctx.moveTo(-size/2 + r, -size/2);
                ctx.lineTo(size/2 - r, -size/2);
                ctx.quadraticCurveTo(size/2, -size/2, size/2, -size/2 + r);
                ctx.lineTo(size/2, size/2 - r);
                ctx.quadraticCurveTo(size/2, size/2, size/2 - r, size/2);
                ctx.lineTo(-size/2 + r, size/2);
                ctx.quadraticCurveTo(-size/2, size/2, -size/2, size/2 - r);
                ctx.lineTo(-size/2, -size/2 + r);
                ctx.quadraticCurveTo(-size/2, -size/2, -size/2 + r, -size/2);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                
                // Icon - much bigger and bolder
                ctx.fillStyle = color;
                ctx.font = 'bold 16px Courier New';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(getPowerUpIcon(p.type), 0, -2);
                
                // Weapon name label below (smaller)
                ctx.shadowBlur = 0;
                ctx.font = '8px Courier New';
                ctx.fillStyle = color;
                ctx.fillText(getPowerUpName(p.type), 0, 10);
                
                ctx.restore();
            });
        }
        
        function getPowerUpColor(type) {
            switch(type) {
                case 'BEAM': return '#00ffff';
                case 'LASER': return '#ff00ff';
                case 'SPREAD': return '#ffff00';
                case 'HOMING': return '#00ff00';
                case 'LEVELUP': return '#ffffff';
                case 'SPECIAL': return '#ffd700';
                case 'SHIELD': return '#00aaff';
                case 'HEART': return '#ff6b9d';
                default: return '#fff';
            }
        }
        
        function getPowerUpIcon(type) {
            switch(type) {
                case 'BEAM': return '‚â°';
                case 'LASER': return '‚ÜØ';
                case 'SPREAD': return '‚ÅÇ';
                case 'HOMING': return '‚óé';
                case 'LEVELUP': return '‚¨Ü';
                case 'SPECIAL': return '‚òÖ';
                case 'SHIELD': return '‚óá';
                case 'HEART': return '‚ô•';
                default: return '?';
            }
        }
        
        function getPowerUpName(type) {
            switch(type) {
                case 'BEAM': return 'BEAM';
                case 'LASER': return 'LASER';
                case 'SPREAD': return 'SPREAD';
                case 'HOMING': return 'HOME';
                case 'LEVELUP': return 'LV UP';
                case 'SPECIAL': return 'BOMB';
                case 'SHIELD': return 'SHIELD';
                case 'HEART': return 'LIFE';
                default: return '';
            }
        }
        
        function drawParticles() {
            particles.forEach(p => {
                if (p.type === 'flash') {
                    ctx.fillStyle = `rgba(255, 255, 255, ${p.alpha})`;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                } else if (p.type === 'hitFlash') {
                    // RED flash when player gets hit
                    ctx.fillStyle = `rgba(255, 0, 0, ${p.alpha})`;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                } else if (p.type === 'sparkle') {
                    // Bright sparkle with glow
                    const alpha = p.life / 20;
                    ctx.save();
                    ctx.shadowColor = p.color;
                    ctx.shadowBlur = 8;
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = alpha;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size || 2, 0, Math.PI * 2);
                    ctx.fill();
                    // Bright center
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, (p.size || 2) * 0.5, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                    ctx.globalAlpha = 1;
                } else if (p.type === 'bossFlash') {
                    // Boss damage flash - bright orange/yellow burst
                    const alpha = p.life / 8;
                    const size = p.size * (1 + (8 - p.life) * 0.3);
                    ctx.save();
                    ctx.shadowColor = '#ff6600';
                    ctx.shadowBlur = 30;
                    ctx.globalAlpha = alpha;
                    const gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, size);
                    gradient.addColorStop(0, '#ffffff');
                    gradient.addColorStop(0.3, '#ffff00');
                    gradient.addColorStop(0.6, '#ff6600');
                    gradient.addColorStop(1, 'rgba(255, 100, 0, 0)');
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                    ctx.globalAlpha = 1;
                } else if (p.type === 'explosionRing') {
                    // Expanding ring
                    const alpha = p.life / 15;
                    const size = p.size + (15 - p.life) * 4;
                    ctx.save();
                    ctx.globalAlpha = alpha;
                    ctx.strokeStyle = '#ff8800';
                    ctx.lineWidth = 3;
                    ctx.shadowColor = '#ff6600';
                    ctx.shadowBlur = 10;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, size, 0, Math.PI * 2);
                    ctx.stroke();
                    ctx.restore();
                    ctx.globalAlpha = 1;
                } else {
                    // Regular particle
                    const size = p.size || 4;
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life / 20;
                    ctx.fillRect(p.x - size/2, p.y - size/2, size, size);
                    ctx.globalAlpha = 1;
                }
            });
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // UPDATE FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function update(deltaTime) {
            if (!gameStarted || gameOver || victory) return;
            
            updateStars();
            updateNotifications();
            
            // Player movement
            if (keys.left && player.x > 25) {
                player.x -= player.speed;
            }
            if (keys.right && player.x < canvas.width - 25) {
                player.x += player.speed;
            }
            
            // Auto-fire
            autoFireTimer += deltaTime;
            const fireRate = WEAPONS[currentWeapon].fireRate;
            if (autoFireTimer >= fireRate) {
                autoFireTimer = 0;
                if (currentWeapon !== 'LASER') {
                    fireWeapon();
                }
            }
            
            // Laser is continuous
            if (currentWeapon === 'LASER') {
                const level = getWeaponLevel();
                laserActive = true;
                laserWidth = level * 3 + 4;
                
                // Laser damage scales with level: 0.02, 0.03, 0.05, 0.07, 0.1, 0.15, 0.2
                const laserDamage = [0.02, 0.03, 0.05, 0.07, 0.1, 0.15, 0.2][level - 1] || 0.02;
                const bossDamage = laserDamage * 0.5;
                
                // Check laser collision
                for (let i = enemies.length - 1; i >= 0; i--) {
                    const enemy = enemies[i];
                    if (Math.abs(enemy.x - player.x) < laserWidth + enemy.width/2) {
                        enemy.health -= laserDamage;
                        // Occasional sparkle while laser hits
                        if (Math.random() < 0.1) {
                            spawnHitSparkles(enemy.x + (Math.random()-0.5)*10, enemy.y, '#ff00ff');
                        }
                        if (enemy.health <= 0) {
                            score += enemy.points;
                            spawnParticles(enemy.x, enemy.y, '#f0f');
                            if (enemy.hasPowerUp) spawnPowerUp(enemy.x, enemy.y);
                            enemies.splice(i, 1);
                            playSound('hit');
                            updateUI();
                        }
                    }
                }
                
                // Laser hum sound
                if (Math.random() < 0.1) playSound('laser');
                
                if (boss && Math.abs(boss.x - player.x) < laserWidth + boss.width/2) {
                    boss.health -= bossDamage;
                    // Boss sparkles and occasional explosion
                    if (Math.random() < 0.08) {
                        spawnHitSparkles(boss.x + (Math.random()-0.5)*30, boss.y + (Math.random()-0.5)*20, '#ff00ff');
                    }
                    if (Math.random() < 0.02) {
                        spawnBossExplosion(boss.x + (Math.random()-0.5)*40, boss.y + (Math.random()-0.5)*30);
                    }
                    if (boss.health <= 0) {
                        score += boss.points;
                        
                        // BIG SCREEN SHAKE for boss death!
                        const isMainBoss = boss.type === 'mainboss';
                        triggerScreenShake(isMainBoss ? 20 : 15, isMainBoss ? 30 : 20);
                        particles.push({ type: 'flash', alpha: 0.8, duration: 12 });
                        playSound('explosion');
                        
                        // Big death explosions
                        for (let i = 0; i < 5; i++) {
                            spawnBossExplosion(
                                boss.x + (Math.random() - 0.5) * 60,
                                boss.y + (Math.random() - 0.5) * 40
                            );
                        }
                        spawnParticles(boss.x, boss.y, '#ff0');
                        
                        if (boss.type === 'mainboss') {
                            gameSpeed += 0.1;
                            showNotification('SPEED UP! ' + Math.round(gameSpeed * 100) + '%', '#ff6600');
                        }
                        
                        boss = null;
                        bossActive = false;
                        
                        wave++;
                        if (wave > TOTAL_WAVES) {
                            showVictory();
                        } else {
                            const allBossWaves = [...MINI_BOSS_WAVES, ...MAIN_BOSS_WAVES];
                            if (allBossWaves.includes(wave - 1)) {
                                showNotification(getBossDefeatMessage(wave - 1), '#00ff00');
                            }
                            updateUI();
                            waveTransitioning = true;
                            setTimeout(() => initWave(wave), 1500);
                        }
                    }
                    updateUI();
                }
            } else {
                laserActive = false;
            }
            
            // Special attack
            if (keys.special) {
                useSpecialAttack();
                keys.special = false;
            }
            
            // Update player bullets
            playerBullets = playerBullets.filter(b => {
                // Movement - beams use dx/dy for bouncing
                if (b.type === 'beam' && b.dy !== undefined) {
                    b.x += (b.dx || 0) * b.speed;
                    b.y += b.dy * b.speed;
                } else {
                    b.y -= b.speed;
                    if (b.dx) b.x += b.dx;
                }
                
                // Improved homing logic - prioritizes closest target, tracks better
                if (b.type === 'homing' && (enemies.length > 0 || boss)) {
                    // Find best target - prioritize boss if close, otherwise closest enemy
                    let target = null;
                    let bestScore = Infinity;
                    
                    // Check boss
                    if (boss) {
                        const dist = Math.hypot(boss.x - b.x, boss.y - b.y);
                        bestScore = dist * 0.7; // Boss gets priority bonus
                        target = boss;
                    }
                    
                    // Check enemies (including second mini-boss)
                    enemies.forEach(e => {
                        const dist = Math.hypot(e.x - b.x, e.y - b.y);
                        // Prioritize targets that are ahead of the missile
                        const ahead = e.y < b.y ? 0.8 : 1.2;
                        if (dist * ahead < bestScore) {
                            bestScore = dist * ahead;
                            target = e;
                        }
                    });
                    
                    if (target) {
                        const turnSpeed = b.turnSpeed || 0.15;
                        const angle = Math.atan2(target.y - b.y, target.x - b.x);
                        // Smooth tracking with adjustable turn speed
                        b.x += Math.cos(angle) * b.speed * turnSpeed * 2;
                        b.y += Math.sin(angle) * b.speed * turnSpeed * 2;
                    }
                }
                
                // Keep bullet if on screen (beams can go any direction now)
                return b.y > -10 && b.y < canvas.height + 10 && b.x > -10 && b.x < canvas.width + 10;
            });
            
            // Update enemy bullets
            enemyBullets = enemyBullets.filter(b => {
                b.y += b.speed;
                if (b.dx) b.x += b.dx;
                return b.y < canvas.height + 10;
            });
            
            // Update power-ups
            powerUps = powerUps.filter(p => {
                p.y += p.speed;
                
                // Collect
                if (Math.abs(p.x - player.x) < 25 && Math.abs(p.y - player.y) < 25) {
                    collectPowerUp(p);
                    return false;
                }
                
                return p.y < canvas.height + 20;
            });
            
            // Update particles
            particles = particles.filter(p => {
                if (p.type === 'flash' || p.type === 'hitFlash') {
                    p.alpha -= 0.08;
                    p.duration--;
                    return p.duration > 0;
                } else if (p.type === 'bossFlash' || p.type === 'explosionRing') {
                    // Static position particles - just decrease life
                    p.life--;
                    return p.life > 0;
                } else {
                    // Moving particles
                    p.x += (p.dx || 0);
                    p.y += (p.dy || 0);
                    p.life--;
                    return p.life > 0;
                }
            });
            
            // Update screen shake
            if (screenShake > 0) {
                screenShake--;
            }
            
            // Update invulnerability
            if (playerInvulnerable) {
                invulnerableTimer--;
                if (invulnerableTimer <= 0) {
                    playerInvulnerable = false;
                }
            }
            
            // Enemy movement
            let moveDown = false;
            let direction = 1;
            
            enemies.forEach(enemy => {
                if (enemy.x <= 25 || enemy.x >= canvas.width - 25) {
                    moveDown = true;
                    direction = enemy.x <= 25 ? 1 : -1;
                }
            });
            
            enemies.forEach(enemy => {
                // Special handling for miniboss2 (second mini-boss)
                if (enemy.type === 'miniboss2') {
                    // Move horizontally like the main boss
                    enemy.x += (enemy.direction || 1) * 0.5 * gameSpeed;
                    if (enemy.x <= 80 || enemy.x >= canvas.width - 80) {
                        enemy.direction = (enemy.direction || 1) * -1;
                    }
                    
                    // Shooting for second mini-boss
                    enemy.attackTimer = (enemy.attackTimer || 0) + 1;
                    if (enemy.attackTimer > 80 && Math.random() < 0.02) {
                        enemy.attackTimer = 0;
                        enemyBullets.push({
                            x: enemy.x,
                            y: enemy.y + 30,
                            speed: 1.5,
                            dx: (Math.random() - 0.5) * 0.5
                        });
                    }
                } else if (enemy.type === BOUNCER) {
                    // BOUNCER: Bounces around the play area like a ball
                    enemy.x += enemy.dx * gameSpeed;
                    enemy.y += enemy.dy * gameSpeed;
                    
                    // Bounce off walls
                    if (enemy.x <= 20 || enemy.x >= canvas.width - 20) {
                        enemy.dx *= -1;
                        enemy.x = Math.max(20, Math.min(canvas.width - 20, enemy.x));
                        spawnHitSparkles(enemy.x, enemy.y, '#00ffff');
                    }
                    // Bounce off top and stay in upper portion
                    if (enemy.y <= 20) {
                        enemy.dy = Math.abs(enemy.dy);
                        enemy.y = 20;
                    }
                    if (enemy.y >= canvas.height * 0.6) {
                        enemy.dy = -Math.abs(enemy.dy);
                        enemy.y = canvas.height * 0.6;
                    }
                    
                    // Occasionally shoot
                    if (Math.random() < 0.008 * gameSpeed) {
                        enemyBullets.push({
                            x: enemy.x,
                            y: enemy.y + 15,
                            speed: 1.5,
                            dx: (Math.random() - 0.5) * 0.8
                        });
                    }
                } else if (enemy.type === CHARGER) {
                    // CHARGER: Waits, then charges at player's position
                    enemy.chargeTimer = (enemy.chargeTimer || 0) + 1;
                    
                    if (!enemy.isCharging) {
                        // Hovering movement
                        enemy.x += Math.sin(Date.now() / 500 + enemy.x) * 0.5 * gameSpeed;
                        enemy.y = enemy.originalY + Math.sin(Date.now() / 300) * 5;
                        
                        // Start charging after timer
                        if (enemy.chargeTimer > 100) {
                            enemy.isCharging = true;
                            enemy.chargeTargetX = player.x;
                            enemy.chargeTargetY = player.y - 30;
                            enemy.chargeTimer = 0;
                            // Show warning
                            spawnHitSparkles(enemy.x, enemy.y, '#ff0000');
                        }
                    } else {
                        // Charging! Move toward target
                        const dx = enemy.chargeTargetX - enemy.x;
                        const dy = enemy.chargeTargetY - enemy.y;
                        const dist = Math.sqrt(dx * dx + dy * dy);
                        
                        if (dist > 5) {
                            const speed = 5 * gameSpeed;
                            enemy.x += (dx / dist) * speed;
                            enemy.y += (dy / dist) * speed;
                        } else {
                            // Reached target, return to original position
                            enemy.isCharging = false;
                            enemy.chargeTimer = -50; // Brief cooldown
                        }
                        
                        // Stop charging if goes off screen
                        if (enemy.y > canvas.height * 0.7) {
                            enemy.isCharging = false;
                            enemy.y = enemy.originalY;
                            enemy.chargeTimer = -30;
                        }
                    }
                } else {
                    // Regular enemy movement
                    if (moveDown) {
                        enemy.y += 6 * gameSpeed;
                        enemy.moveDir = direction;
                    }
                    enemy.x += (enemy.moveDir || 1) * (0.22 + wave * 0.03) * gameSpeed;
                }
            });
            
            // Boss movement
            if (boss) {
                boss.x += boss.speed * boss.direction * gameSpeed;
                if (boss.x <= 60 || boss.x >= canvas.width - 60) {
                    boss.direction *= -1;
                }
                
                // Speed up slightly when damaged (less aggressive)
                const baseSpeed = boss.type === 'mainboss' ? 
                    [0.6, 0.7, 0.8, 0.9][boss.bossNum - 1] : 0.6;
                if (boss.health < boss.maxHealth * 0.5) boss.speed = baseSpeed * 1.2;
                if (boss.health < boss.maxHealth * 0.25) boss.speed = baseSpeed * 1.4;
            }
            
            // Difficulty scaling: 50% at wave 1, 100% at wave 12
            const difficultyScale = getDifficultyScale(wave);
            
            // Enemy shooting - rate scales from 50% to 100% based on wave
            const baseShootRate = 0.012 + wave * 0.001;
            if (enemies.length > 0 && Math.random() < baseShootRate * difficultyScale * gameSpeed) {
                const shooter = enemies[Math.floor(Math.random() * enemies.length)];
                
                if (shooter.type === BUBBLE_SHOOTER) {
                    // Bubble shooter fires big slow bubble
                    enemyBullets.push({
                        x: shooter.x,
                        y: shooter.y + 15,
                        speed: 0.8 * gameSpeed,
                        isBubble: true,
                        size: 12
                    });
                } else {
                    // Normal enemy bullet - speed also scales with difficulty
                    enemyBullets.push({
                        x: shooter.x,
                        y: shooter.y + 15,
                        speed: (1.2 + wave * 0.08) * difficultyScale * gameSpeed
                    });
                }
            }
            
            // Boss shooting - rate scales with difficulty
            if (boss && Math.random() < 0.012 * difficultyScale * gameSpeed) {
                // Normal spread shot
                for (let i = -1; i <= 1; i++) {
                    enemyBullets.push({
                        x: boss.x + i * 25,
                        y: boss.y + 35,
                        speed: 1.6,
                        dx: i * 0.5
                    });
                }
            }
            
            // Boss bubble attack (less frequent)
            if (boss && Math.random() < 0.005) {
                enemyBullets.push({
                    x: boss.x,
                    y: boss.y + 40,
                    speed: 1.2,
                    isBubble: true,
                    size: 16
                });
            }
            
            // Collision: Player bullets ‚Üí Enemies
            for (let bi = playerBullets.length - 1; bi >= 0; bi--) {
                const bullet = playerBullets[bi];
                
                for (let ei = enemies.length - 1; ei >= 0; ei--) {
                    const enemy = enemies[ei];
                    if (Math.abs(bullet.x - enemy.x) < enemy.width &&
                        Math.abs(bullet.y - enemy.y) < enemy.height) {
                        
                        // Skip if this beam just hit this enemy
                        if (bullet.type === 'beam' && bullet.lastHit === enemy) continue;
                        
                        enemy.health -= bullet.damage;
                        
                        // Hit sparkle effect on every hit!
                        spawnHitSparkles(bullet.x, bullet.y, bullet.color);
                        
                        // BEAM BOUNCING - find next target and redirect
                        if (bullet.type === 'beam' && bullet.bounces > 0) {
                            bullet.bounces--;
                            bullet.lastHit = enemy;
                            
                            // Find nearest OTHER enemy or boss to bounce to
                            let nextTarget = null;
                            let nearestDist = 300; // Max bounce range
                            
                            enemies.forEach((e, idx) => {
                                if (idx !== ei) { // Don't target same enemy
                                    const dist = Math.hypot(e.x - bullet.x, e.y - bullet.y);
                                    if (dist < nearestDist) {
                                        nearestDist = dist;
                                        nextTarget = e;
                                    }
                                }
                            });
                            
                            // Also check boss as bounce target
                            if (boss) {
                                const dist = Math.hypot(boss.x - bullet.x, boss.y - bullet.y);
                                if (dist < nearestDist) {
                                    nearestDist = dist;
                                    nextTarget = boss;
                                }
                            }
                            
                            if (nextTarget) {
                                // Redirect beam toward next target
                                const angle = Math.atan2(nextTarget.y - bullet.y, nextTarget.x - bullet.x);
                                bullet.dx = Math.cos(angle);
                                bullet.dy = Math.sin(angle);
                                // Spawn bounce effect
                                for (let p = 0; p < 5; p++) {
                                    particles.push({
                                        x: bullet.x,
                                        y: bullet.y,
                                        dx: (Math.random() - 0.5) * 3,
                                        dy: (Math.random() - 0.5) * 3,
                                        life: 10,
                                        color: '#00ffff'
                                    });
                                }
                            } else {
                                // No target to bounce to - continue upward
                                bullet.dx = 0;
                                bullet.dy = -1;
                            }
                        } else {
                            // Non-beam or no bounces left - destroy bullet
                            playerBullets.splice(bi, 1);
                        }
                        
                        if (enemy.health <= 0) {
                            score += enemy.points;
                            spawnParticles(enemy.x, enemy.y, bullet.color);
                            if (enemy.hasPowerUp) spawnPowerUp(enemy.x, enemy.y);
                            enemies.splice(ei, 1);
                            playSound('hit');
                            updateUI();
                        }
                        break;
                    }
                }
                
                // Boss collision
                if (boss && bi < playerBullets.length) {
                    const b = playerBullets[bi];
                    if (b && Math.abs(b.x - boss.x) < boss.width/2 &&
                        Math.abs(b.y - boss.y) < boss.height/2) {
                        
                        // Skip if this beam just hit boss
                        if (b.type === 'beam' && b.lastHit === boss) continue;
                        
                        boss.health -= b.damage;
                        
                        // Boss damage effects - sparkles + occasional explosion
                        spawnHitSparkles(b.x, b.y, b.color);
                        if (Math.random() < 0.3) {
                            spawnBossExplosion(b.x, b.y);
                        }
                        
                        // BEAM BOUNCING off boss
                        if (b.type === 'beam' && b.bounces > 0) {
                            b.bounces--;
                            b.lastHit = boss;
                            
                            // Find nearest enemy to bounce to
                            let nextTarget = null;
                            let nearestDist = 300;
                            
                            enemies.forEach(e => {
                                const dist = Math.hypot(e.x - b.x, e.y - b.y);
                                if (dist < nearestDist) {
                                    nearestDist = dist;
                                    nextTarget = e;
                                }
                            });
                            
                            if (nextTarget) {
                                const angle = Math.atan2(nextTarget.y - b.y, nextTarget.x - b.x);
                                b.dx = Math.cos(angle);
                                b.dy = Math.sin(angle);
                                for (let p = 0; p < 5; p++) {
                                    particles.push({
                                        x: b.x, y: b.y,
                                        dx: (Math.random() - 0.5) * 3,
                                        dy: (Math.random() - 0.5) * 3,
                                        life: 10,
                                        color: '#00ffff'
                                    });
                                }
                            } else {
                                b.dx = 0;
                                b.dy = -1;
                            }
                        } else {
                            playerBullets.splice(bi, 1);
                        }
                        
                        if (boss.health <= 0) {
                            score += boss.points;
                            
                            // BIG SCREEN SHAKE for boss death!
                            const isMainBoss = boss.type === 'mainboss';
                            triggerScreenShake(isMainBoss ? 20 : 15, isMainBoss ? 30 : 20);
                            playSound('explosion');
                            
                            // White flash
                            particles.push({
                                type: 'flash',
                                alpha: 0.8,
                                duration: 12
                            });
                            
                            // Big death explosion
                            for (let i = 0; i < 5; i++) {
                                setTimeout(() => {
                                    if (!boss) return;
                                    spawnBossExplosion(
                                        boss.x + (Math.random() - 0.5) * 60,
                                        boss.y + (Math.random() - 0.5) * 40
                                    );
                                }, i * 100);
                            }
                            spawnParticles(boss.x, boss.y, '#ff0');
                            
                            // Check if this was a main boss - increase game speed
                            if (boss.type === 'mainboss') {
                                gameSpeed += 0.1; // 10% faster
                                showNotification('SPEED UP! ' + Math.round(gameSpeed * 100) + '%', '#ff6600');
                            }
                            
                            boss = null;
                            bossActive = false;
                            
                            // Progress to next wave
                            wave++;
                            if (wave > TOTAL_WAVES) {
                                showVictory();
                            } else {
                                // Show boss defeat message
                                if ([...MINI_BOSS_WAVES, ...MAIN_BOSS_WAVES].includes(wave - 1)) {
                                    showNotification(getBossDefeatMessage(wave - 1), '#00ff00');
                                }
                                updateUI();
                                waveTransitioning = true;
                                setTimeout(() => initWave(wave), 1500);
                            }
                        }
                        updateUI();
                    }
                }
            }
            
            // Collision: Player bullets ‚Üí Enemy bubbles (shoot through!)
            for (let bi = playerBullets.length - 1; bi >= 0; bi--) {
                const bullet = playerBullets[bi];
                for (let ei = enemyBullets.length - 1; ei >= 0; ei--) {
                    const enemyBullet = enemyBullets[ei];
                    if (enemyBullet.isBubble) {
                        const size = enemyBullet.size || 10;
                        if (Math.abs(bullet.x - enemyBullet.x) < size + 5 &&
                            Math.abs(bullet.y - enemyBullet.y) < size + 5) {
                            // Pop the bubble!
                            spawnHitSparkles(enemyBullet.x, enemyBullet.y, '#ff6600');
                            spawnParticles(enemyBullet.x, enemyBullet.y, '#ff8800');
                            enemyBullets.splice(ei, 1);
                            score += 5; // Small score bonus
                            // Bullet passes through! Don't remove it
                            break;
                        }
                    }
                }
            }
            
            // Collision: Enemy bullets ‚Üí Player
            for (let bi = enemyBullets.length - 1; bi >= 0; bi--) {
                const bullet = enemyBullets[bi];
                const hitSize = bullet.isBubble ? (bullet.size || 10) + 6 : 10; // Even smaller hitbox
                
                if (Math.abs(bullet.x - player.x) < hitSize &&
                    Math.abs(bullet.y - player.y) < hitSize) {
                    enemyBullets.splice(bi, 1);
                    loseLife();
                }
            }
            
            // Check if enemies reached bottom
            enemies.forEach(enemy => {
                if (enemy.y > canvas.height - 60) {
                    loseLife();
                    enemy.y = 60;
                }
            });
            
            // Wave complete (only if not already transitioning)
            if (enemies.length === 0 && !bossActive && !waveTransitioning) {
                wave++;
                if (wave > TOTAL_WAVES) {
                    // Beat all 4 main bosses!
                    showVictory();
                } else {
                    updateUI();
                    initWave(wave);
                }
            }
        }
        
        function draw() {
            // Clear
            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Apply screen shake
            ctx.save();
            if (screenShake > 0) {
                const shakeX = (Math.random() - 0.5) * screenShakeIntensity;
                const shakeY = (Math.random() - 0.5) * screenShakeIntensity;
                ctx.translate(shakeX, shakeY);
            }
            
            // Stars
            drawStars();
            
            if (!gameStarted) {
                ctx.restore();
                return;
            }
            
            // Enemies
            enemies.forEach(enemy => {
                if (enemy.type === PAWN) drawPawn(enemy.x, enemy.y);
                else if (enemy.type === BUBBLE_SHOOTER) drawBubbleShooter(enemy.x, enemy.y);
                else if (enemy.type === BOUNCER) drawBouncer(enemy.x, enemy.y, enemy);
                else if (enemy.type === CHARGER) drawCharger(enemy.x, enemy.y, enemy);
                else if (enemy.type === 'miniboss2') {
                    // Draw second mini-boss like the main mini-boss
                    drawMiniBoss(enemy);
                }
                else drawKnight(enemy.x, enemy.y);
                
                // Power-up indicator
                if (enemy.hasPowerUp) {
                    ctx.fillStyle = '#ffd700';
                    ctx.beginPath();
                    ctx.arc(enemy.x, enemy.y - enemy.height, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Health bar for high-HP enemies (Bouncers, Chargers)
                if ((enemy.type === BOUNCER || enemy.type === CHARGER) && enemy.health > 0) {
                    const maxHp = enemy.type === BOUNCER ? 15 : 12;
                    const barWidth = 24;
                    ctx.fillStyle = '#333';
                    ctx.fillRect(enemy.x - barWidth/2, enemy.y - 20, barWidth, 4);
                    ctx.fillStyle = enemy.health > maxHp * 0.3 ? '#0f0' : '#f00';
                    ctx.fillRect(enemy.x - barWidth/2, enemy.y - 20, barWidth * (enemy.health / maxHp), 4);
                }
            });
            
            // Boss
            if (boss) drawBoss();
            
            // Player
            drawPlayer();
            
            // Shields around player
            drawShields();
            
            // Bullets
            drawBullets();
            
            // Power-ups
            drawPowerUps();
            
            // Particles
            drawParticles();
            
            // Notifications
            drawNotifications();
            
            // Boss wave indicator
            if (MINI_BOSS_WAVES.includes(wave) && bossActive) {
                const isDouble = DOUBLE_MINI_WAVES.includes(wave);
                ctx.fillStyle = '#e8707e';
                ctx.font = '12px "Space Mono", monospace';
                ctx.textAlign = 'center';
                ctx.fillText(isDouble ? '‚öî TWIN HORSE KINGS ‚öî' : '‚öî THE HORSE KING ‚öî', canvas.width / 2, 25);
            } else if (MAIN_BOSS_WAVES.includes(wave) && bossActive) {
                const bossIndex = MAIN_BOSS_WAVES.indexOf(wave);
                const bossNames = ['STANDING STALLION', 'GALLOPING FURY', 'BABY TERROR', 'BASKETBALL BEAST'];
                ctx.fillStyle = '#ffaa00';
                ctx.font = '12px "Space Mono", monospace';
                ctx.textAlign = 'center';
                ctx.fillText('‚öî ' + bossNames[bossIndex] + ' ‚öî', canvas.width / 2, 25);
            }
            
            // Restore from screen shake
            ctx.restore();
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GAME LOOP
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function gameLoop(timestamp) {
            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;
            
            update(deltaTime || 16);
            draw();
            requestAnimationFrame(gameLoop);
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // SCREEN SHAKE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function triggerScreenShake(intensity, duration) {
            screenShake = duration;
            screenShakeIntensity = intensity;
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GAME FLOW
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function loseLife() {
            // Skip if invulnerable
            if (playerInvulnerable) return;
            
            // Use shield first if available
            if (shields > 0) {
                shields--;
                showNotification('SHIELD LOST!', '#00aaff');
                spawnParticles(player.x, player.y, '#00aaff');
                triggerScreenShake(5, 10); // Small shake for shield hit
                playSound('playerHit');
                updateUI();
                return;
            }
            
            lives--;
            updateUI();
            spawnParticles(player.x, player.y, '#e8707e');
            
            // VISUAL FEEDBACK - screen flash and shake
            triggerScreenShake(12, 20); // Big shake on hit
            playSound('playerHit');
            particles.push({
                type: 'hitFlash',
                alpha: 0.6,
                duration: 8
            });
            
            // Start invulnerability (1 second = 60 frames)
            playerInvulnerable = true;
            invulnerableTimer = 60;
            
            if (lives <= 0) {
                stopMusic();
                showGameOver();
            } else {
                showNotification('OUCH! ' + lives + ' LEFT', '#ff4444');
            }
        }
        
        function updateUI() {
            document.getElementById('score').textContent = score;
            
            // Show wave or boss number based on new structure
            // Mini-boss waves: 5, 11, 15, 19 (15 & 19 are double)
            // Main boss waves: 8, 12, 16, 20
            if (wave === 5 || wave === 11) {
                document.getElementById('wave').textContent = 'MINI';
            } else if (wave === 15 || wave === 19) {
                document.getElementById('wave').textContent = '2xMINI';
            } else if (wave === 8) {
                document.getElementById('wave').textContent = 'BOSS 1';
            } else if (wave === 12) {
                document.getElementById('wave').textContent = 'BOSS 2';
            } else if (wave === 16) {
                document.getElementById('wave').textContent = 'BOSS 3';
            } else if (wave === 20) {
                document.getElementById('wave').textContent = 'FINAL';
            } else {
                document.getElementById('wave').textContent = wave + '/' + TOTAL_WAVES;
            }
            
            // Show hearts for lives (max display 10)
            const maxDisplay = 10;
            const livesDisplay = document.getElementById('livesDisplay');
            let heartsHTML = '';
            for (let i = 0; i < Math.min(lives, maxDisplay); i++) {
                heartsHTML += '‚ô•';
            }
            if (lives > maxDisplay) {
                heartsHTML += '+' + (lives - maxDisplay);
            }
            livesDisplay.innerHTML = heartsHTML;
            
            document.getElementById('weaponDisplay').textContent = currentWeapon + ' LV.' + getWeaponLevel();
        }
        
        function showGameOver() {
            gameOver = true;
            stopMusic();
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }
        
        function showVictory() {
            victory = true;
            stopMusic();
            document.getElementById('victoryScore').textContent = score;
            document.getElementById('victoryScreen').classList.remove('hidden');
        }
        
        function restartGame() {
            gameStarted = true;
            gameOver = false;
            victory = false;
            waveTransitioning = false;
            score = 0;
            lives = 5;
            wave = 1;
            gameSpeed = 1.0; // Reset game speed
            mainBossLevel = 0;
            currentWeapon = 'BEAM';
            weaponLevels = { BEAM: 1, LASER: 1, SPREAD: 1, HOMING: 1 };
            specialAttacks = 3;
            shields = 0;
            player.x = 200;
            playerBullets = [];
            enemyBullets = [];
            powerUps = [];
            particles = [];
            notifications = [];
            playerInvulnerable = false;
            invulnerableTimer = 0;
            
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('victoryScreen').classList.add('hidden');
            document.getElementById('specialCount').textContent = '√ó3';
            document.getElementById('specialBtn').disabled = false;
            
            startMusic();
            updateUI();
            updateWeaponButton();
            initWave(1);
        }
        
        function startGame() {
            if (gameStarted) return;
            document.getElementById('startScreen').classList.add('hidden');
            gameStarted = true;
            lives = 5;  // Start with 5 lives
            initAudio();
            startMusic();
            initWave(1);
            updateUI();
            updateWeaponButton();
        }
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INPUT HANDLERS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        // Keyboard
        document.addEventListener('keydown', (e) => {
            if (e.code === 'ArrowLeft' || e.code === 'KeyA') keys.left = true;
            if (e.code === 'ArrowRight' || e.code === 'KeyD') keys.right = true;
            if (e.code === 'Space') {
                e.preventDefault();
                if (!gameStarted) startGame();
                else keys.special = true;
            }
            // Weapon switching with 1-4 keys
            if (e.code === 'Digit1') { currentWeapon = 'BEAM'; updateUI(); showNotification('BEAM LV.' + weaponLevels.BEAM, '#00ffff'); }
            if (e.code === 'Digit2') { currentWeapon = 'LASER'; updateUI(); showNotification('LASER LV.' + weaponLevels.LASER, '#ff00ff'); }
            if (e.code === 'Digit3') { currentWeapon = 'SPREAD'; updateUI(); showNotification('SPREAD LV.' + weaponLevels.SPREAD, '#ffff00'); }
            if (e.code === 'Digit4') { currentWeapon = 'HOMING'; updateUI(); showNotification('HOMING LV.' + weaponLevels.HOMING, '#00ff00'); }
            // Q/E to cycle weapons
            if (e.code === 'KeyQ') switchWeapon(-1);
            if (e.code === 'KeyE') switchWeapon(1);
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.code === 'ArrowLeft' || e.code === 'KeyA') keys.left = false;
            if (e.code === 'ArrowRight' || e.code === 'KeyD') keys.right = false;
        });
        
        // Start screen tap
        document.getElementById('startScreen').addEventListener('click', startGame);
        document.getElementById('startScreen').addEventListener('touchstart', (e) => {
            e.preventDefault();
            startGame();
        });
        
        // Mobile buttons
        const leftBtn = document.getElementById('leftBtn');
        const rightBtn = document.getElementById('rightBtn');
        const specialBtn = document.getElementById('specialBtn');
        
        // Left button
        leftBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.left = true; leftBtn.classList.add('active'); });
        leftBtn.addEventListener('touchend', () => { keys.left = false; leftBtn.classList.remove('active'); });
        leftBtn.addEventListener('touchcancel', () => { keys.left = false; leftBtn.classList.remove('active'); });
        leftBtn.addEventListener('mousedown', () => { keys.left = true; });
        leftBtn.addEventListener('mouseup', () => { keys.left = false; });
        leftBtn.addEventListener('mouseleave', () => { keys.left = false; });
        
        // Right button
        rightBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.right = true; rightBtn.classList.add('active'); });
        rightBtn.addEventListener('touchend', () => { keys.right = false; rightBtn.classList.remove('active'); });
        rightBtn.addEventListener('touchcancel', () => { keys.right = false; rightBtn.classList.remove('active'); });
        rightBtn.addEventListener('mousedown', () => { keys.right = true; });
        rightBtn.addEventListener('mouseup', () => { keys.right = false; });
        rightBtn.addEventListener('mouseleave', () => { keys.right = false; });
        
        // Special button
        specialBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.special = true; });
        specialBtn.addEventListener('click', () => { keys.special = true; });
        
        // Side weapon switch buttons
        const weaponBtnLeft = document.getElementById('weaponBtnLeft');
        const weaponBtnRight = document.getElementById('weaponBtnRight');
        
        weaponBtnLeft.addEventListener('touchstart', (e) => { e.preventDefault(); switchWeapon(-1); });
        weaponBtnLeft.addEventListener('click', () => { switchWeapon(-1); });
        
        weaponBtnRight.addEventListener('touchstart', (e) => { e.preventDefault(); switchWeapon(1); });
        weaponBtnRight.addEventListener('click', () => { switchWeapon(1); });
        
        // Prevent scrolling
        document.body.addEventListener('touchmove', (e) => e.preventDefault(), { passive: false });
        
        // Start game loop
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>
